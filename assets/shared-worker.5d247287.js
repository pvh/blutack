(async()=>{var _n=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},mo={exports:{}};(function(t){var e=Object.prototype.hasOwnProperty,n="~";function r(){}Object.create&&(r.prototype=Object.create(null),new r().__proto__||(n=!1));function i(u,c,f){this.fn=u,this.context=c,this.once=f||!1}function o(u,c,f,l,_){if(typeof f!="function")throw new TypeError("The listener must be a function");var m=new i(f,l||u,_),E=n?n+c:c;return u._events[E]?u._events[E].fn?u._events[E]=[u._events[E],m]:u._events[E].push(m):(u._events[E]=m,u._eventsCount++),u}function a(u,c){--u._eventsCount===0?u._events=new r:delete u._events[c]}function s(){this._events=new r,this._eventsCount=0}s.prototype.eventNames=function(){var c=[],f,l;if(this._eventsCount===0)return c;for(l in f=this._events)e.call(f,l)&&c.push(n?l.slice(1):l);return Object.getOwnPropertySymbols?c.concat(Object.getOwnPropertySymbols(f)):c},s.prototype.listeners=function(c){var f=n?n+c:c,l=this._events[f];if(!l)return[];if(l.fn)return[l.fn];for(var _=0,m=l.length,E=new Array(m);_<m;_++)E[_]=l[_].fn;return E},s.prototype.listenerCount=function(c){var f=n?n+c:c,l=this._events[f];return l?l.fn?1:l.length:0},s.prototype.emit=function(c,f,l,_,m,E){var O=n?n+c:c;if(!this._events[O])return!1;var C=this._events[O],N=arguments.length,P,j;if(C.fn){switch(C.once&&this.removeListener(c,C.fn,void 0,!0),N){case 1:return C.fn.call(C.context),!0;case 2:return C.fn.call(C.context,f),!0;case 3:return C.fn.call(C.context,f,l),!0;case 4:return C.fn.call(C.context,f,l,_),!0;case 5:return C.fn.call(C.context,f,l,_,m),!0;case 6:return C.fn.call(C.context,f,l,_,m,E),!0}for(j=1,P=new Array(N-1);j<N;j++)P[j-1]=arguments[j];C.fn.apply(C.context,P)}else{var ee=C.length,D;for(j=0;j<ee;j++)switch(C[j].once&&this.removeListener(c,C[j].fn,void 0,!0),N){case 1:C[j].fn.call(C[j].context);break;case 2:C[j].fn.call(C[j].context,f);break;case 3:C[j].fn.call(C[j].context,f,l);break;case 4:C[j].fn.call(C[j].context,f,l,_);break;default:if(!P)for(D=1,P=new Array(N-1);D<N;D++)P[D-1]=arguments[D];C[j].fn.apply(C[j].context,P)}}return!0},s.prototype.on=function(c,f,l){return o(this,c,f,l,!1)},s.prototype.once=function(c,f,l){return o(this,c,f,l,!0)},s.prototype.removeListener=function(c,f,l,_){var m=n?n+c:c;if(!this._events[m])return this;if(!f)return a(this,m),this;var E=this._events[m];if(E.fn)E.fn===f&&(!_||E.once)&&(!l||E.context===l)&&a(this,m);else{for(var O=0,C=[],N=E.length;O<N;O++)(E[O].fn!==f||_&&!E[O].once||l&&E[O].context!==l)&&C.push(E[O]);C.length?this._events[m]=C.length===1?C[0]:C:a(this,m)}return this},s.prototype.removeAllListeners=function(c){var f;return c?(f=n?n+c:c,this._events[f]&&a(this,f)):(this._events=new r,this._eventsCount=0),this},s.prototype.off=s.prototype.removeListener,s.prototype.addListener=s.prototype.on,s.prefixed=n,s.EventEmitter=s,t.exports=s})(mo);var gt=mo.exports,gn,su=new Uint8Array(16);function cu(){if(!gn&&(gn=typeof crypto<"u"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||typeof msCrypto<"u"&&typeof msCrypto.getRandomValues=="function"&&msCrypto.getRandomValues.bind(msCrypto),!gn))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return gn(su)}var uu=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i;function fu(t){return typeof t=="string"&&uu.test(t)}var je=[];for(var lr=0;lr<256;++lr)je.push((lr+256).toString(16).substr(1));function lu(t){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,n=(je[t[e+0]]+je[t[e+1]]+je[t[e+2]]+je[t[e+3]]+"-"+je[t[e+4]]+je[t[e+5]]+"-"+je[t[e+6]]+je[t[e+7]]+"-"+je[t[e+8]]+je[t[e+9]]+"-"+je[t[e+10]]+je[t[e+11]]+je[t[e+12]]+je[t[e+13]]+je[t[e+14]]+je[t[e+15]]).toLowerCase();if(!fu(n))throw TypeError("Stringified UUID is invalid");return n}function du(t,e,n){t=t||{};var r=t.random||(t.rng||cu)();if(r[6]=r[6]&15|64,r[8]=r[8]&63|128,e){n=n||0;for(var i=0;i<16;++i)e[n+i]=r[i];return e}return lu(r)}let pn;const hu=new Uint8Array(16);function _u(){if(!pn&&(pn=typeof crypto<"u"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto),!pn))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return pn(hu)}const De=[];for(let t=0;t<256;++t)De.push((t+256).toString(16).slice(1));function gu(t,e=0){return(De[t[e+0]]+De[t[e+1]]+De[t[e+2]]+De[t[e+3]]+"-"+De[t[e+4]]+De[t[e+5]]+"-"+De[t[e+6]]+De[t[e+7]]+"-"+De[t[e+8]]+De[t[e+9]]+"-"+De[t[e+10]]+De[t[e+11]]+De[t[e+12]]+De[t[e+13]]+De[t[e+14]]+De[t[e+15]]).toLowerCase()}const pu=typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto);var Ui={randomUUID:pu};function yu(t,e,n){if(Ui.randomUUID&&!e&&!t)return Ui.randomUUID();t=t||{};const r=t.random||(t.rng||_u)();if(r[6]=r[6]&15|64,r[8]=r[8]&63|128,e){n=n||0;for(let i=0;i<16;++i)e[n+i]=r[i];return e}return gu(r)}function wo(){return yu().replace(/-/g,"")}let Vr=wo;const Wr=()=>Vr();Wr.setFactory=t=>{Vr=t};Wr.reset=()=>{Vr=wo};const _t=Symbol.for("_am_meta"),Pt=Symbol.for("_am_trace"),it=Symbol.for("_am_objectId"),Yn=Symbol.for("_am_isProxy"),So=Symbol.for("_am_uint"),xo=Symbol.for("_am_int"),Eo=Symbol.for("_am_f64"),Ao=Symbol.for("_am_counter"),vu=Symbol.for("_am_text");class Ge{constructor(e){if(typeof e=="string")this.elems=[...e];else if(Array.isArray(e))this.elems=e;else if(e===void 0)this.elems=[];else throw new TypeError(`Unsupported initial value for Text: ${e}`);Reflect.defineProperty(this,vu,{value:!0})}get length(){return this.elems.length}get(e){return this.elems[e]}[Symbol.iterator](){const e=this.elems;let n=-1;return{next(){return n+=1,n<e.length?{done:!1,value:e[n]}:{done:!0}}}}toString(){if(!this.str){this.str="";for(const e of this.elems)typeof e=="string"?this.str+=e:this.str+="ï¿¼"}return this.str}toSpans(){if(!this.spans){this.spans=[];let e="";for(const n of this.elems)typeof n=="string"?e+=n:(e.length>0&&(this.spans.push(e),e=""),this.spans.push(n));e.length>0&&this.spans.push(e)}return this.spans}toJSON(){return this.toString()}set(e,n){if(this[_t])throw new RangeError("object cannot be modified outside of a change block");this.elems[e]=n}insertAt(e,...n){if(this[_t])throw new RangeError("object cannot be modified outside of a change block");this.elems.splice(e,0,...n)}deleteAt(e,n=1){if(this[_t])throw new RangeError("object cannot be modified outside of a change block");this.elems.splice(e,n)}map(e){this.elems.map(e)}lastIndexOf(e,n){this.elems.lastIndexOf(e,n)}concat(e){return new Ge(this.elems.concat(e.elems))}every(e){return this.elems.every(e)}filter(e){return new Ge(this.elems.filter(e))}find(e){return this.elems.find(e)}findIndex(e){return this.elems.findIndex(e)}forEach(e){this.elems.forEach(e)}includes(e){return this.elems.includes(e)}indexOf(e){return this.elems.indexOf(e)}join(e){return this.elems.join(e)}reduce(e){this.elems.reduce(e)}reduceRight(e){this.elems.reduceRight(e)}slice(e,n){new Ge(this.elems.slice(e,n))}some(e){return this.elems.some(e)}toLocaleString(){this.toString()}}class mt{constructor(e){this.value=e||0,Reflect.defineProperty(this,Ao,{value:!0})}valueOf(){return this.value}toString(){return this.valueOf().toString()}toJSON(){return this.value}}class bu extends mt{constructor(e,n,r,i,o){super(e),this.context=n,this.path=r,this.objectId=i,this.key=o}increment(e){return e=typeof e=="number"?e:1,this.context.increment(this.objectId,this.key,e),this.value+=e,this.value}decrement(e){return this.increment(typeof e=="number"?-e:-1)}}function mu(t,e,n,r,i){return new bu(t,e,n,r,i)}class qn{constructor(e){this.val=e}}function nt(t){if(typeof t=="string"&&/^[0-9]+$/.test(t)&&(t=parseInt(t,10)),typeof t!="number")return t;if(t<0||isNaN(t)||t===1/0||t===-1/0)throw new RangeError("A list index must be positive, but you passed "+t);return t}function Ve(t,e){const{context:n,objectId:r,path:i,readonly:o,heads:a,textV2:s}=t,u=n.getWithType(r,e,a);if(u===null)return;const c=u[0],f=u[1];switch(c){case void 0:return;case"map":return Lt(n,f,s,[...i,e],o,a);case"list":return sn(n,f,s,[...i,e],o,a);case"text":return s?n.text(f,a):Zt(n,f,[...i,e],o,a);case"str":return f;case"uint":return f;case"int":return f;case"f64":return f;case"boolean":return f;case"null":return null;case"bytes":return f;case"timestamp":return f;case"counter":return o?new mt(f):mu(f,n,i,r,e);default:throw RangeError(`datatype ${c} unimplemented`)}}function $n(t,e){switch(typeof t){case"object":if(t==null)return[null,"null"];if(t[So])return[t.value,"uint"];if(t[xo])return[t.value,"int"];if(t[Eo])return[t.value,"f64"];if(t[Ao])return[t.value,"counter"];if(t instanceof Date)return[t.getTime(),"timestamp"];if(t instanceof qn)return[t.val,"str"];if(t instanceof Ge)return[t,"text"];if(t instanceof Uint8Array)return[t,"bytes"];if(t instanceof Array)return[t,"list"];if(Object.getPrototypeOf(t)===Object.getPrototypeOf({}))return[t,"map"];throw t[it]?new RangeError("Cannot create a reference to an existing document object"):new RangeError(`Cannot assign unknown object: ${t}`);case"boolean":return[t,"boolean"];case"number":return Number.isInteger(t)?[t,"int"]:[t,"f64"];case"string":return e?[t,"text"]:[t,"str"];default:throw new RangeError(`Unsupported type of value: ${typeof t}`)}}const wu={get(t,e){const{context:n,objectId:r,cache:i}=t;return e===Symbol.toStringTag?t[Symbol.toStringTag]:e===it?r:e===Yn?!0:e===Pt?t.trace:e===_t?{handle:n}:(i[e]||(i[e]=Ve(t,e)),i[e])},set(t,e,n){const{context:r,objectId:i,path:o,readonly:a,frozen:s,textV2:u}=t;if(t.cache={},n&&n[it])throw new RangeError("Cannot create a reference to an existing document object");if(e===Pt)return t.trace=n,!0;const[c,f]=$n(n,u);if(s)throw new RangeError("Attempting to use an outdated Automerge document");if(a)throw new RangeError(`Object property "${e}" cannot be modified`);switch(f){case"list":{const l=r.putObject(i,e,[]),_=sn(r,l,u,[...o,e],a);for(let m=0;m<c.length;m++)_[m]=c[m];break}case"text":{if(u)Bn(c),r.putObject(i,e,c);else{Hr(c);const l=r.putObject(i,e,""),_=Zt(r,l,[...o,e],a);for(let m=0;m<c.length;m++)_[m]=c.get(m)}break}case"map":{const l=r.putObject(i,e,{}),_=Lt(r,l,u,[...o,e],a);for(const m in c)_[m]=c[m];break}default:r.put(i,e,c,f)}return!0},deleteProperty(t,e){const{context:n,objectId:r,readonly:i}=t;if(t.cache={},i)throw new RangeError(`Object property "${e}" cannot be modified`);return n.delete(r,e),!0},has(t,e){return this.get(t,e)!==void 0},getOwnPropertyDescriptor(t,e){const n=this.get(t,e);if(typeof n<"u")return{configurable:!0,enumerable:!0,value:n}},ownKeys(t){const{context:e,objectId:n,heads:r}=t,i=e.keys(n,r);return[...new Set(i)]}},Co={get(t,e){const{context:n,objectId:r,heads:i}=t;return e=nt(e),e===Symbol.hasInstance?o=>Array.isArray(o):e===Symbol.toStringTag?t[Symbol.toStringTag]:e===it?r:e===Yn?!0:e===Pt?t.trace:e===_t?{handle:n}:e==="length"?n.length(r,i):typeof e=="number"?Ve(t,e):Oo(t)[e]},set(t,e,n){const{context:r,objectId:i,path:o,readonly:a,frozen:s,textV2:u}=t;if(e=nt(e),n&&n[it])throw new RangeError("Cannot create a reference to an existing document object");if(e===Pt)return t.trace=n,!0;if(typeof e=="string")throw new RangeError("list index must be a number");const[c,f]=$n(n,u);if(s)throw new RangeError("Attempting to use an outdated Automerge document");if(a)throw new RangeError(`Object property "${e}" cannot be modified`);switch(f){case"list":{let l;e>=r.length(i)?l=r.insertObject(i,e,[]):l=r.putObject(i,e,[]),sn(r,l,u,[...o,e],a).splice(0,0,...c);break}case"text":{if(u)Bn(c),e>=r.length(i)?r.insertObject(i,e,c):r.putObject(i,e,c);else{let l;Hr(c),e>=r.length(i)?l=r.insertObject(i,e,""):l=r.putObject(i,e,""),Zt(r,l,[...o,e],a).splice(0,0,...c)}break}case"map":{let l;e>=r.length(i)?l=r.insertObject(i,e,{}):l=r.putObject(i,e,{});const _=Lt(r,l,u,[...o,e],a);for(const m in c)_[m]=c[m];break}default:e>=r.length(i)?r.insert(i,e,c,f):r.put(i,e,c,f)}return!0},deleteProperty(t,e){const{context:n,objectId:r}=t;e=nt(e);const i=n.get(r,e);if(i!=null&&i[0]=="counter")throw new TypeError("Unsupported operation: deleting a counter from a list");return n.delete(r,e),!0},has(t,e){const{context:n,objectId:r,heads:i}=t;return e=nt(e),typeof e=="number"?e<n.length(r,i):e==="length"},getOwnPropertyDescriptor(t,e){const{context:n,objectId:r,heads:i}=t;return e==="length"?{writable:!0,value:n.length(r,i)}:e===it?{configurable:!1,enumerable:!1,value:r}:(e=nt(e),{configurable:!0,enumerable:!0,value:Ve(t,e)})},getPrototypeOf(t){return Object.getPrototypeOf(t)},ownKeys(){const t=[];return t.push("length"),t}},Su=Object.assign({},Co,{get(t,e){const{context:n,objectId:r,heads:i}=t;return e=nt(e),e===Symbol.hasInstance?o=>Array.isArray(o):e===Symbol.toStringTag?t[Symbol.toStringTag]:e===it?r:e===Yn?!0:e===Pt?t.trace:e===_t?{handle:n}:e==="length"?n.length(r,i):typeof e=="number"?Ve(t,e):Eu(t)[e]||Oo(t)[e]},getPrototypeOf(){return Object.getPrototypeOf(new Ge)}});function Lt(t,e,n,r,i,o){const a={context:t,objectId:e,path:r||[],readonly:!!i,frozen:!1,heads:o,cache:{},textV2:n},s={};return Object.assign(s,a),new Proxy(s,wu)}function sn(t,e,n,r,i,o){const a={context:t,objectId:e,path:r||[],readonly:!!i,frozen:!1,heads:o,cache:{},textV2:n},s=[];return Object.assign(s,a),new Proxy(s,Co)}function Zt(t,e,n,r,i){const o={context:t,objectId:e,path:n||[],readonly:!!r,frozen:!1,heads:i,cache:{},textV2:!1},a={};return Object.assign(a,o),new Proxy(a,Su)}function xu(t,e,n){return Lt(t,"_root",e,[],!!n)}function Oo(t){const{context:e,objectId:n,path:r,readonly:i,frozen:o,heads:a,textV2:s}=t;return{deleteAt(c,f){return typeof f=="number"?e.splice(n,c,f):e.delete(n,c),this},fill(c,f,l){const[_,m]=$n(c,s),E=e.length(n);f=nt(f||0),l=nt(l||E);for(let O=f;O<Math.min(l,E);O++)if(m==="list"||m==="map")e.putObject(n,O,_);else if(m==="text")if(s)Bn(_),e.putObject(n,O,_);else{Hr(_);const C=e.putObject(n,O,""),N=Zt(e,C,[...r,O],i);for(let P=0;P<_.length;P++)N[P]=_.get(P)}else e.put(n,O,_,m);return this},indexOf(c,f=0){const l=e.length(n);for(let _=f;_<l;_++){const m=e.getWithType(n,_,a);if(m&&(m[1]===c[it]||m[1]===c))return _}return-1},insertAt(c,...f){return this.splice(c,0,...f),this},pop(){const c=e.length(n);if(c==0)return;const f=Ve(t,c-1);return e.delete(n,c-1),f},push(...c){const f=e.length(n);return this.splice(f,0,...c),e.length(n)},shift(){if(e.length(n)==0)return;const c=Ve(t,0);return e.delete(n,0),c},splice(c,f,...l){c=nt(c),f=nt(f);for(const E of l)if(E&&E[it])throw new RangeError("Cannot create a reference to an existing document object");if(o)throw new RangeError("Attempting to use an outdated Automerge document");if(i)throw new RangeError("Sequence object cannot be modified outside of a change block");const _=[];for(let E=0;E<f;E++){const O=Ve(t,c);O!==void 0&&_.push(O),e.delete(n,c)}const m=l.map(E=>$n(E,s));for(const[E,O]of m){switch(O){case"list":{const C=e.insertObject(n,c,[]);sn(e,C,s,[...r,c],i).splice(0,0,...E);break}case"text":{if(s)Bn(E),e.insertObject(n,c,E);else{const C=e.insertObject(n,c,"");Zt(e,C,[...r,c],i).splice(0,0,...E)}break}case"map":{const C=e.insertObject(n,c,{}),N=Lt(e,C,s,[...r,c],i);for(const P in E)N[P]=E[P];break}default:e.insert(n,c,E,O)}c+=1}return _},unshift(...c){return this.splice(0,0,...c),e.length(n)},entries(){return{next:()=>{const l=Ve(t,0);return l===void 0?{value:void 0,done:!0}:{value:[0,l],done:!1}}}},keys(){let c=0;const f=e.length(n,a);return{next:()=>{let _;return c<f&&(_=c,c++),{value:_,done:!0}}}},values(){return{next:()=>{const l=Ve(t,0);return l===void 0?{value:void 0,done:!0}:{value:l,done:!1}}}},toArray(){const c=[];let f;do f=Ve(t,c.length),f!==void 0&&c.push(f);while(f!==void 0);return c},map(c){return this.toArray().map(c)},toString(){return this.toArray().toString()},toLocaleString(){return this.toArray().toLocaleString()},forEach(c){return this.toArray().forEach(c)},concat(c){return this.toArray().concat(c)},every(c){return this.toArray().every(c)},filter(c){return this.toArray().filter(c)},find(c){let f=0;for(const l of this){if(c(l,f))return l;f+=1}},findIndex(c){let f=0;for(const l of this){if(c(l,f))return f;f+=1}return-1},includes(c){return this.find(f=>f===c)!==void 0},join(c){return this.toArray().join(c)},reduce(c,f){return this.toArray().reduce(c,f)},reduceRight(c,f){return this.toArray().reduceRight(c,f)},lastIndexOf(c,f=1/0){return this.toArray().lastIndexOf(c,f)},slice(c,f){return this.toArray().slice(c,f)},some(c){let f=0;for(const l of this){if(c(l,f))return!0;f+=1}return!1},[Symbol.iterator]:function*(){let c=0,f=Ve(t,c);for(;f!==void 0;)yield f,c+=1,f=Ve(t,c)}}}function Eu(t){const{context:e,objectId:n,heads:r}=t;return{set(o,a){return this[o]=a},get(o){return this[o]},toString(){return e.text(n,r).replace(/ï¿¼/g,"")},toSpans(){const o=[];let a="";const s=e.length(n);for(let u=0;u<s;u++){const c=this[u];typeof c=="string"?a+=c:(a.length>0&&(o.push(a),a=""),o.push(c))}return a.length>0&&o.push(a),o},toJSON(){return this.toString()},indexOf(o,a=0){return e.text(n).indexOf(o,a)}}}function Hr(t){if(!(t instanceof Ge))throw new Error("value was not a Text instance")}function Bn(t){if(typeof t!="string")throw new Error("value was not a string")}class ko{constructor(e){if(!(Number.isInteger(e)&&e<=Number.MAX_SAFE_INTEGER&&e>=Number.MIN_SAFE_INTEGER))throw new RangeError(`Value ${e} cannot be a uint`);this.value=e,Reflect.defineProperty(this,xo,{value:!0}),Object.freeze(this)}}class Ro{constructor(e){if(!(Number.isInteger(e)&&e<=Number.MAX_SAFE_INTEGER&&e>=0))throw new RangeError(`Value ${e} cannot be a uint`);this.value=e,Reflect.defineProperty(this,So,{value:!0}),Object.freeze(this)}}class Io{constructor(e){if(typeof e!="number")throw new RangeError(`Value ${e} cannot be a float64`);this.value=e||0,Reflect.defineProperty(this,Eo,{value:!0}),Object.freeze(this)}}function Au(t){for(const e in t)Me[e]=t[e]}const Me={create(t){throw new RangeError("Automerge.use() not called")},load(t,e){throw new RangeError("Automerge.use() not called (load)")},encodeChange(t){throw new RangeError("Automerge.use() not called (encodeChange)")},decodeChange(t){throw new RangeError("Automerge.use() not called (decodeChange)")},initSyncState(){throw new RangeError("Automerge.use() not called (initSyncState)")},encodeSyncMessage(t){throw new RangeError("Automerge.use() not called (encodeSyncMessage)")},decodeSyncMessage(t){throw new RangeError("Automerge.use() not called (decodeSyncMessage)")},encodeSyncState(t){throw new RangeError("Automerge.use() not called (encodeSyncState)")},decodeSyncState(t){throw new RangeError("Automerge.use() not called (decodeSyncState)")},exportSyncState(t){throw new RangeError("Automerge.use() not called (exportSyncState)")},importSyncState(t){throw new RangeError("Automerge.use() not called (importSyncState)")}};function ge(t,e=!0){if(typeof t!="object")throw new RangeError("must be the document root");const n=Reflect.get(t,_t);if(n===void 0||n==null||e&&at(t)!=="_root")throw new RangeError("must be the document root");return n}function Kr(t){return Reflect.get(t,Pt)}function at(t){return typeof t!="object"||t===null?null:Reflect.get(t,it)}function st(t){return!!Reflect.get(t,Yn)}function Cu(t,e,n){return To(t,e,n,!0,(r,i)=>new Ge(r.text(i)))}function Ou(t,e,n){return To(t,e,n,!0,(r,i)=>r.text(i))}function To(t,e,n,r,i){const o=t.getAll(e,n);if(o.length<=1)return;const a={};for(const s of o)switch(s[0]){case"map":a[s[1]]=Lt(t,s[1],r,[n],!0);break;case"list":a[s[1]]=sn(t,s[1],r,[n],!0);break;case"text":a[s[1]]=i(t,s[1]);break;case"str":case"uint":case"int":case"f64":case"boolean":case"bytes":case"null":a[s[2]]=s[1];break;case"counter":a[s[2]]=new mt(s[1]);break;case"timestamp":a[s[2]]=new Date(s[1]);break;default:throw RangeError(`datatype ${s[0]} unimplemented`)}return a}var ku="/blutack/assets/automerge_wasm_bg.e930223d.wasm",Ru=async(t={},e)=>{let n;if(e.startsWith("data:")){const r=e.replace(/^data:.*?base64,/,"");let i;if(typeof Buffer=="function"&&typeof Buffer.from=="function")i=Buffer.from(r,"base64");else if(typeof atob=="function"){const o=atob(r);i=new Uint8Array(o.length);for(let a=0;a<o.length;a++)i[a]=o.charCodeAt(a)}else throw new Error("Cannot decode base64-encoded data URL");n=await WebAssembly.instantiate(i,t)}else{const r=await fetch(e),i=r.headers.get("Content-Type")||"";if("instantiateStreaming"in WebAssembly&&i.startsWith("application/wasm"))n=await WebAssembly.instantiateStreaming(r,t);else{const o=await r.arrayBuffer();n=await WebAssembly.instantiate(o,t)}}return n.instance.exports};let y;function jo(t){y=t}const ot=new Array(128).fill(void 0);ot.push(void 0,null,!0,!1);function V(t){return ot[t]}let Qt=ot.length;function Iu(t){t<132||(ot[t]=Qt,Qt=t)}function B(t){const e=V(t);return Iu(t),e}const Tu=typeof TextDecoder>"u"?(0,module.require)("util").TextDecoder:TextDecoder;let Do=new Tu("utf-8",{ignoreBOM:!0,fatal:!0});Do.decode();let yn=null;function Rn(){return(yn===null||yn.byteLength===0)&&(yn=new Uint8Array(y.memory.buffer)),yn}function qe(t,e){return t=t>>>0,Do.decode(Rn().subarray(t,t+e))}function k(t){Qt===ot.length&&ot.push(ot.length+1);const e=Qt;return Qt=ot[e],ot[e]=t,e}let He=0;const ju=typeof TextEncoder>"u"?(0,module.require)("util").TextEncoder:TextEncoder;let In=new ju("utf-8");const Du=typeof In.encodeInto=="function"?function(t,e){return In.encodeInto(t,e)}:function(t,e){const n=In.encode(t);return e.set(n),{read:t.length,written:n.length}};function rt(t,e,n){if(n===void 0){const s=In.encode(t),u=e(s.length)>>>0;return Rn().subarray(u,u+s.length).set(s),He=s.length,u}let r=t.length,i=e(r)>>>0;const o=Rn();let a=0;for(;a<r;a++){const s=t.charCodeAt(a);if(s>127)break;o[i+a]=s}if(a!==r){a!==0&&(t=t.slice(a)),i=n(i,r,r=a+t.length*3)>>>0;const s=Rn().subarray(i+a,i+r),u=Du(t,s);a+=u.written}return He=a,i}function Ae(t){return t==null}let vn=null;function A(){return(vn===null||vn.byteLength===0)&&(vn=new Int32Array(y.memory.buffer)),vn}let bn=null;function Er(){return(bn===null||bn.byteLength===0)&&(bn=new Float64Array(y.memory.buffer)),bn}function Ar(t){const e=typeof t;if(e=="number"||e=="boolean"||t==null)return`${t}`;if(e=="string")return`"${t}"`;if(e=="symbol"){const i=t.description;return i==null?"Symbol":`Symbol(${i})`}if(e=="function"){const i=t.name;return typeof i=="string"&&i.length>0?`Function(${i})`:"Function"}if(Array.isArray(t)){const i=t.length;let o="[";i>0&&(o+=Ar(t[0]));for(let a=1;a<i;a++)o+=", "+Ar(t[a]);return o+="]",o}const n=/\[object ([^\]]+)\]/.exec(toString.call(t));let r;if(n.length>1)r=n[1];else return toString.call(t);if(r=="Object")try{return"Object("+JSON.stringify(t)+")"}catch{return"Object"}return t instanceof Error?`${t.name}: ${t.message}
${t.stack}`:r}function Tt(t,e){if(!(t instanceof e))throw new Error(`expected instance of ${e.name}`);return t.ptr}function Pu(t){try{const i=y.__wbindgen_add_to_stack_pointer(-16);y.create(i,k(t));var e=A()[i/4+0],n=A()[i/4+1],r=A()[i/4+2];if(r)throw B(n);return tt.__wrap(e)}finally{y.__wbindgen_add_to_stack_pointer(16)}}function Mu(t,e){try{const o=y.__wbindgen_add_to_stack_pointer(-16);y.load(o,k(t),k(e));var n=A()[o/4+0],r=A()[o/4+1],i=A()[o/4+2];if(i)throw B(r);return tt.__wrap(n)}finally{y.__wbindgen_add_to_stack_pointer(16)}}function Nu(t){try{const i=y.__wbindgen_add_to_stack_pointer(-16);y.encodeChange(i,k(t));var e=A()[i/4+0],n=A()[i/4+1],r=A()[i/4+2];if(r)throw B(n);return B(e)}finally{y.__wbindgen_add_to_stack_pointer(16)}}function Lu(t){try{const i=y.__wbindgen_add_to_stack_pointer(-16);y.decodeChange(i,k(t));var e=A()[i/4+0],n=A()[i/4+1],r=A()[i/4+2];if(r)throw B(n);return B(e)}finally{y.__wbindgen_add_to_stack_pointer(16)}}function Fu(){const t=y.initSyncState();return Qe.__wrap(t)}function Uu(t){try{const i=y.__wbindgen_add_to_stack_pointer(-16);y.importSyncState(i,k(t));var e=A()[i/4+0],n=A()[i/4+1],r=A()[i/4+2];if(r)throw B(n);return Qe.__wrap(e)}finally{y.__wbindgen_add_to_stack_pointer(16)}}function $u(t){Tt(t,Qe);const e=y.exportSyncState(t.__wbg_ptr);return B(e)}function Bu(t){try{const i=y.__wbindgen_add_to_stack_pointer(-16);y.encodeSyncMessage(i,k(t));var e=A()[i/4+0],n=A()[i/4+1],r=A()[i/4+2];if(r)throw B(n);return B(e)}finally{y.__wbindgen_add_to_stack_pointer(16)}}function zu(t){try{const i=y.__wbindgen_add_to_stack_pointer(-16);y.decodeSyncMessage(i,k(t));var e=A()[i/4+0],n=A()[i/4+1],r=A()[i/4+2];if(r)throw B(n);return B(e)}finally{y.__wbindgen_add_to_stack_pointer(16)}}function Vu(t){Tt(t,Qe);const e=y.encodeSyncState(t.__wbg_ptr);return B(e)}function Wu(t){try{const i=y.__wbindgen_add_to_stack_pointer(-16);y.decodeSyncState(i,k(t));var e=A()[i/4+0],n=A()[i/4+1],r=A()[i/4+2];if(r)throw B(n);return Qe.__wrap(e)}finally{y.__wbindgen_add_to_stack_pointer(16)}}function Le(t,e){try{return t.apply(this,e)}catch(n){y.__wbindgen_exn_store(k(n))}}const Hu=Object.freeze({Array:0,0:"Array",String:1,1:"String"}),$i=new FinalizationRegistry(t=>y.__wbg_automerge_free(t>>>0));class tt{static __wrap(e){e=e>>>0;const n=Object.create(tt.prototype);return n.__wbg_ptr=e,$i.register(n,n.__wbg_ptr,n),n}__destroy_into_raw(){const e=this.__wbg_ptr;return this.__wbg_ptr=0,$i.unregister(this),e}free(){const e=this.__destroy_into_raw();y.__wbg_automerge_free(e)}static new(e,n){try{const u=y.__wbindgen_add_to_stack_pointer(-16);var r=Ae(e)?0:rt(e,y.__wbindgen_malloc,y.__wbindgen_realloc),i=He;y.automerge_new(u,r,i,n);var o=A()[u/4+0],a=A()[u/4+1],s=A()[u/4+2];if(s)throw B(a);return tt.__wrap(o)}finally{y.__wbindgen_add_to_stack_pointer(16)}}clone(e){try{const s=y.__wbindgen_add_to_stack_pointer(-16);var n=Ae(e)?0:rt(e,y.__wbindgen_malloc,y.__wbindgen_realloc),r=He;y.automerge_clone(s,this.__wbg_ptr,n,r);var i=A()[s/4+0],o=A()[s/4+1],a=A()[s/4+2];if(a)throw B(o);return tt.__wrap(i)}finally{y.__wbindgen_add_to_stack_pointer(16)}}fork(e,n){try{const u=y.__wbindgen_add_to_stack_pointer(-16);var r=Ae(e)?0:rt(e,y.__wbindgen_malloc,y.__wbindgen_realloc),i=He;y.automerge_fork(u,this.__wbg_ptr,r,i,k(n));var o=A()[u/4+0],a=A()[u/4+1],s=A()[u/4+2];if(s)throw B(a);return tt.__wrap(o)}finally{y.__wbindgen_add_to_stack_pointer(16)}}pendingOps(){const e=y.automerge_pendingOps(this.__wbg_ptr);return B(e)}commit(e,n){var r=Ae(e)?0:rt(e,y.__wbindgen_malloc,y.__wbindgen_realloc),i=He;const o=y.automerge_commit(this.__wbg_ptr,r,i,!Ae(n),Ae(n)?0:n);return B(o)}merge(e){try{const o=y.__wbindgen_add_to_stack_pointer(-16);Tt(e,tt),y.automerge_merge(o,this.__wbg_ptr,e.__wbg_ptr);var n=A()[o/4+0],r=A()[o/4+1],i=A()[o/4+2];if(i)throw B(r);return B(n)}finally{y.__wbindgen_add_to_stack_pointer(16)}}rollback(){return y.automerge_rollback(this.__wbg_ptr)}keys(e,n){try{const a=y.__wbindgen_add_to_stack_pointer(-16);y.automerge_keys(a,this.__wbg_ptr,k(e),Ae(n)?0:k(n));var r=A()[a/4+0],i=A()[a/4+1],o=A()[a/4+2];if(o)throw B(i);return B(r)}finally{y.__wbindgen_add_to_stack_pointer(16)}}text(e,n){let r,i;try{const l=y.__wbindgen_add_to_stack_pointer(-16);y.automerge_text(l,this.__wbg_ptr,k(e),Ae(n)?0:k(n));var o=A()[l/4+0],a=A()[l/4+1],s=A()[l/4+2],u=A()[l/4+3],c=o,f=a;if(u)throw c=0,f=0,B(s);return r=c,i=f,qe(c,f)}finally{y.__wbindgen_add_to_stack_pointer(16),y.__wbindgen_free(r,i)}}splice(e,n,r,i){try{const s=y.__wbindgen_add_to_stack_pointer(-16);y.automerge_splice(s,this.__wbg_ptr,k(e),n,r,k(i));var o=A()[s/4+0],a=A()[s/4+1];if(a)throw B(o)}finally{y.__wbindgen_add_to_stack_pointer(16)}}push(e,n,r){try{const a=y.__wbindgen_add_to_stack_pointer(-16);y.automerge_push(a,this.__wbg_ptr,k(e),k(n),k(r));var i=A()[a/4+0],o=A()[a/4+1];if(o)throw B(i)}finally{y.__wbindgen_add_to_stack_pointer(16)}}pushObject(e,n){try{const s=y.__wbindgen_add_to_stack_pointer(-16);y.automerge_pushObject(s,this.__wbg_ptr,k(e),k(n));var r=A()[s/4+0],i=A()[s/4+1],o=A()[s/4+2],a=A()[s/4+3];if(a)throw B(o);let u;return r!==0&&(u=qe(r,i).slice(),y.__wbindgen_free(r,i*1)),u}finally{y.__wbindgen_add_to_stack_pointer(16)}}insert(e,n,r,i){try{const s=y.__wbindgen_add_to_stack_pointer(-16);y.automerge_insert(s,this.__wbg_ptr,k(e),n,k(r),k(i));var o=A()[s/4+0],a=A()[s/4+1];if(a)throw B(o)}finally{y.__wbindgen_add_to_stack_pointer(16)}}insertObject(e,n,r){try{const u=y.__wbindgen_add_to_stack_pointer(-16);y.automerge_insertObject(u,this.__wbg_ptr,k(e),n,k(r));var i=A()[u/4+0],o=A()[u/4+1],a=A()[u/4+2],s=A()[u/4+3];if(s)throw B(a);let c;return i!==0&&(c=qe(i,o).slice(),y.__wbindgen_free(i,o*1)),c}finally{y.__wbindgen_add_to_stack_pointer(16)}}put(e,n,r,i){try{const s=y.__wbindgen_add_to_stack_pointer(-16);y.automerge_put(s,this.__wbg_ptr,k(e),k(n),k(r),k(i));var o=A()[s/4+0],a=A()[s/4+1];if(a)throw B(o)}finally{y.__wbindgen_add_to_stack_pointer(16)}}putObject(e,n,r){try{const s=y.__wbindgen_add_to_stack_pointer(-16);y.automerge_putObject(s,this.__wbg_ptr,k(e),k(n),k(r));var i=A()[s/4+0],o=A()[s/4+1],a=A()[s/4+2];if(a)throw B(o);return B(i)}finally{y.__wbindgen_add_to_stack_pointer(16)}}increment(e,n,r){try{const a=y.__wbindgen_add_to_stack_pointer(-16);y.automerge_increment(a,this.__wbg_ptr,k(e),k(n),k(r));var i=A()[a/4+0],o=A()[a/4+1];if(o)throw B(i)}finally{y.__wbindgen_add_to_stack_pointer(16)}}get(e,n,r){try{const s=y.__wbindgen_add_to_stack_pointer(-16);y.automerge_get(s,this.__wbg_ptr,k(e),k(n),Ae(r)?0:k(r));var i=A()[s/4+0],o=A()[s/4+1],a=A()[s/4+2];if(a)throw B(o);return B(i)}finally{y.__wbindgen_add_to_stack_pointer(16)}}getWithType(e,n,r){try{const s=y.__wbindgen_add_to_stack_pointer(-16);y.automerge_getWithType(s,this.__wbg_ptr,k(e),k(n),Ae(r)?0:k(r));var i=A()[s/4+0],o=A()[s/4+1],a=A()[s/4+2];if(a)throw B(o);return B(i)}finally{y.__wbindgen_add_to_stack_pointer(16)}}getAll(e,n,r){try{const s=y.__wbindgen_add_to_stack_pointer(-16);y.automerge_getAll(s,this.__wbg_ptr,k(e),k(n),Ae(r)?0:k(r));var i=A()[s/4+0],o=A()[s/4+1],a=A()[s/4+2];if(a)throw B(o);return B(i)}finally{y.__wbindgen_add_to_stack_pointer(16)}}enableFreeze(e){try{const o=y.__wbindgen_add_to_stack_pointer(-16);y.automerge_enableFreeze(o,this.__wbg_ptr,k(e));var n=A()[o/4+0],r=A()[o/4+1],i=A()[o/4+2];if(i)throw B(r);return B(n)}finally{y.__wbindgen_add_to_stack_pointer(16)}}registerDatatype(e,n){try{const o=y.__wbindgen_add_to_stack_pointer(-16);y.automerge_registerDatatype(o,this.__wbg_ptr,k(e),k(n));var r=A()[o/4+0],i=A()[o/4+1];if(i)throw B(r)}finally{y.__wbindgen_add_to_stack_pointer(16)}}applyPatches(e,n){try{const a=y.__wbindgen_add_to_stack_pointer(-16);y.automerge_applyPatches(a,this.__wbg_ptr,k(e),k(n));var r=A()[a/4+0],i=A()[a/4+1],o=A()[a/4+2];if(o)throw B(i);return B(r)}finally{y.__wbindgen_add_to_stack_pointer(16)}}applyAndReturnPatches(e,n){try{const a=y.__wbindgen_add_to_stack_pointer(-16);y.automerge_applyAndReturnPatches(a,this.__wbg_ptr,k(e),k(n));var r=A()[a/4+0],i=A()[a/4+1],o=A()[a/4+2];if(o)throw B(i);return B(r)}finally{y.__wbindgen_add_to_stack_pointer(16)}}popPatches(){try{const i=y.__wbindgen_add_to_stack_pointer(-16);y.automerge_popPatches(i,this.__wbg_ptr);var e=A()[i/4+0],n=A()[i/4+1],r=A()[i/4+2];if(r)throw B(n);return B(e)}finally{y.__wbindgen_add_to_stack_pointer(16)}}truncatePatches(){y.automerge_truncatePatches(this.__wbg_ptr)}resetPatches(){y.automerge_resetPatches(this.__wbg_ptr)}diff(e,n){try{const a=y.__wbindgen_add_to_stack_pointer(-16);y.automerge_diff(a,this.__wbg_ptr,k(e),k(n));var r=A()[a/4+0],i=A()[a/4+1],o=A()[a/4+2];if(o)throw B(i);return B(r)}finally{y.__wbindgen_add_to_stack_pointer(16)}}length(e,n){try{const a=y.__wbindgen_add_to_stack_pointer(-16);y.automerge_length(a,this.__wbg_ptr,k(e),Ae(n)?0:k(n));var r=Er()[a/8+0],i=A()[a/4+2],o=A()[a/4+3];if(o)throw B(i);return r}finally{y.__wbindgen_add_to_stack_pointer(16)}}delete(e,n){try{const o=y.__wbindgen_add_to_stack_pointer(-16);y.automerge_delete(o,this.__wbg_ptr,k(e),k(n));var r=A()[o/4+0],i=A()[o/4+1];if(i)throw B(r)}finally{y.__wbindgen_add_to_stack_pointer(16)}}save(){const e=y.automerge_save(this.__wbg_ptr);return B(e)}saveIncremental(){const e=y.automerge_saveIncremental(this.__wbg_ptr);return B(e)}saveNoCompress(){const e=y.automerge_saveNoCompress(this.__wbg_ptr);return B(e)}saveAndVerify(){try{const i=y.__wbindgen_add_to_stack_pointer(-16);y.automerge_saveAndVerify(i,this.__wbg_ptr);var e=A()[i/4+0],n=A()[i/4+1],r=A()[i/4+2];if(r)throw B(n);return B(e)}finally{y.__wbindgen_add_to_stack_pointer(16)}}loadIncremental(e){try{const o=y.__wbindgen_add_to_stack_pointer(-16);y.automerge_loadIncremental(o,this.__wbg_ptr,k(e));var n=Er()[o/8+0],r=A()[o/4+2],i=A()[o/4+3];if(i)throw B(r);return n}finally{y.__wbindgen_add_to_stack_pointer(16)}}applyChanges(e){try{const i=y.__wbindgen_add_to_stack_pointer(-16);y.automerge_applyChanges(i,this.__wbg_ptr,k(e));var n=A()[i/4+0],r=A()[i/4+1];if(r)throw B(n)}finally{y.__wbindgen_add_to_stack_pointer(16)}}getChanges(e){try{const o=y.__wbindgen_add_to_stack_pointer(-16);y.automerge_getChanges(o,this.__wbg_ptr,k(e));var n=A()[o/4+0],r=A()[o/4+1],i=A()[o/4+2];if(i)throw B(r);return B(n)}finally{y.__wbindgen_add_to_stack_pointer(16)}}getChangeByHash(e){try{const o=y.__wbindgen_add_to_stack_pointer(-16);y.automerge_getChangeByHash(o,this.__wbg_ptr,k(e));var n=A()[o/4+0],r=A()[o/4+1],i=A()[o/4+2];if(i)throw B(r);return B(n)}finally{y.__wbindgen_add_to_stack_pointer(16)}}getChangesAdded(e){Tt(e,tt);const n=y.automerge_getChangesAdded(this.__wbg_ptr,e.__wbg_ptr);return B(n)}getHeads(){const e=y.automerge_getHeads(this.__wbg_ptr);return B(e)}getActorId(){let e,n;try{const o=y.__wbindgen_add_to_stack_pointer(-16);y.automerge_getActorId(o,this.__wbg_ptr);var r=A()[o/4+0],i=A()[o/4+1];return e=r,n=i,qe(r,i)}finally{y.__wbindgen_add_to_stack_pointer(16),y.__wbindgen_free(e,n)}}getLastLocalChange(){const e=y.automerge_getLastLocalChange(this.__wbg_ptr);return B(e)}dump(){y.automerge_dump(this.__wbg_ptr)}getMissingDeps(e){try{const o=y.__wbindgen_add_to_stack_pointer(-16);y.automerge_getMissingDeps(o,this.__wbg_ptr,Ae(e)?0:k(e));var n=A()[o/4+0],r=A()[o/4+1],i=A()[o/4+2];if(i)throw B(r);return B(n)}finally{y.__wbindgen_add_to_stack_pointer(16)}}receiveSyncMessage(e,n){try{const o=y.__wbindgen_add_to_stack_pointer(-16);Tt(e,Qe),y.automerge_receiveSyncMessage(o,this.__wbg_ptr,e.__wbg_ptr,k(n));var r=A()[o/4+0],i=A()[o/4+1];if(i)throw B(r)}finally{y.__wbindgen_add_to_stack_pointer(16)}}generateSyncMessage(e){Tt(e,Qe);const n=y.automerge_generateSyncMessage(this.__wbg_ptr,e.__wbg_ptr);return B(n)}toJS(e){try{const o=y.__wbindgen_add_to_stack_pointer(-16);y.automerge_toJS(o,this.__wbg_ptr,k(e));var n=A()[o/4+0],r=A()[o/4+1],i=A()[o/4+2];if(i)throw B(r);return B(n)}finally{y.__wbindgen_add_to_stack_pointer(16)}}materialize(e,n,r){try{const s=y.__wbindgen_add_to_stack_pointer(-16);y.automerge_materialize(s,this.__wbg_ptr,k(e),Ae(n)?0:k(n),k(r));var i=A()[s/4+0],o=A()[s/4+1],a=A()[s/4+2];if(a)throw B(o);return B(i)}finally{y.__wbindgen_add_to_stack_pointer(16)}}emptyChange(e,n){var r=Ae(e)?0:rt(e,y.__wbindgen_malloc,y.__wbindgen_realloc),i=He;const o=y.automerge_emptyChange(this.__wbg_ptr,r,i,!Ae(n),Ae(n)?0:n);return B(o)}mark(e,n,r,i,o){try{const u=y.__wbindgen_add_to_stack_pointer(-16);y.automerge_mark(u,this.__wbg_ptr,k(e),k(n),k(r),k(i),k(o));var a=A()[u/4+0],s=A()[u/4+1];if(s)throw B(a)}finally{y.__wbindgen_add_to_stack_pointer(16)}}unmark(e,n,r){try{const a=y.__wbindgen_add_to_stack_pointer(-16);y.automerge_unmark(a,this.__wbg_ptr,k(e),k(n),k(r));var i=A()[a/4+0],o=A()[a/4+1];if(o)throw B(i)}finally{y.__wbindgen_add_to_stack_pointer(16)}}marks(e,n){try{const a=y.__wbindgen_add_to_stack_pointer(-16);y.automerge_marks(a,this.__wbg_ptr,k(e),Ae(n)?0:k(n));var r=A()[a/4+0],i=A()[a/4+1],o=A()[a/4+2];if(o)throw B(i);return B(r)}finally{y.__wbindgen_add_to_stack_pointer(16)}}}const Bi=new FinalizationRegistry(t=>y.__wbg_syncstate_free(t>>>0));class Qe{static __wrap(e){e=e>>>0;const n=Object.create(Qe.prototype);return n.__wbg_ptr=e,Bi.register(n,n.__wbg_ptr,n),n}__destroy_into_raw(){const e=this.__wbg_ptr;return this.__wbg_ptr=0,Bi.unregister(this),e}free(){const e=this.__destroy_into_raw();y.__wbg_syncstate_free(e)}get sharedHeads(){const e=y.syncstate_sharedHeads(this.__wbg_ptr);return B(e)}get lastSentHeads(){const e=y.syncstate_lastSentHeads(this.__wbg_ptr);return B(e)}set lastSentHeads(e){try{const i=y.__wbindgen_add_to_stack_pointer(-16);y.syncstate_set_lastSentHeads(i,this.__wbg_ptr,k(e));var n=A()[i/4+0],r=A()[i/4+1];if(r)throw B(n)}finally{y.__wbindgen_add_to_stack_pointer(16)}}set sentHashes(e){try{const i=y.__wbindgen_add_to_stack_pointer(-16);y.syncstate_set_sentHashes(i,this.__wbg_ptr,k(e));var n=A()[i/4+0],r=A()[i/4+1];if(r)throw B(n)}finally{y.__wbindgen_add_to_stack_pointer(16)}}clone(){const e=y.syncstate_clone(this.__wbg_ptr);return Qe.__wrap(e)}}function Po(t){B(t)}function Mo(t,e){const n=qe(t,e);return k(n)}function No(t){return V(t)===null}function Lo(t,e){const n=new Error(qe(t,e));return k(n)}function Fo(t,e){const n=V(e),r=typeof n=="string"?n:void 0;var i=Ae(r)?0:rt(r,y.__wbindgen_malloc,y.__wbindgen_realloc),o=He;A()[t/4+1]=o,A()[t/4+0]=i}function Uo(t){const e=V(t);return k(e)}function $o(t,e){const n=V(e),r=typeof n=="number"?n:void 0;Er()[t/8+1]=Ae(r)?0:r,A()[t/4+0]=!Ae(r)}function Bo(t){return V(t)===void 0}function zo(t){const e=V(t);return typeof e=="boolean"?e?1:0:2}function Vo(t){return k(t)}function Wo(t){return typeof V(t)=="function"}function Ho(t){return typeof V(t)=="string"}function Ko(t,e){const n=V(e),r=JSON.stringify(n===void 0?null:n),i=rt(r,y.__wbindgen_malloc,y.__wbindgen_realloc),o=He;A()[t/4+1]=o,A()[t/4+0]=i}function Jo(){const t=new Error;return k(t)}function Yo(t,e){const n=V(e).stack,r=rt(n,y.__wbindgen_malloc,y.__wbindgen_realloc),i=He;A()[t/4+1]=i,A()[t/4+0]=r}function qo(t,e){let n,r;try{n=t,r=e,console.error(qe(t,e))}finally{y.__wbindgen_free(n,r)}}function Go(t){const e=V(t);return typeof e=="object"&&e!==null}function Qo(t,e){return V(t)==V(e)}function Xo(t,e){const n=String(V(e)),r=rt(n,y.__wbindgen_malloc,y.__wbindgen_realloc),i=He;A()[t/4+1]=i,A()[t/4+0]=r}function Zo(t){return k(t)}function ea(t){const e=BigInt.asUintN(64,t);return k(e)}function ta(t,e,n){V(t)[B(e)]=B(n)}function na(){return Le(function(t,e){V(t).getRandomValues(V(e))},arguments)}function ra(){return Le(function(t,e){V(t).randomFillSync(B(e))},arguments)}function ia(t){const e=V(t).crypto;return k(e)}function oa(t){const e=V(t).process;return k(e)}function aa(t){const e=V(t).versions;return k(e)}function sa(t){const e=V(t).node;return k(e)}function ca(t){const e=V(t).msCrypto;return k(e)}function ua(){return Le(function(){const t=module.require;return k(t)},arguments)}function fa(t){console.log(V(t))}function la(t,e){console.log(V(t),V(e))}function da(t,e){const n=V(t)[e>>>0];return k(n)}function ha(t){return V(t).length}function _a(){const t=new Array;return k(t)}function ga(t,e){const n=new Function(qe(t,e));return k(n)}function pa(t){const e=V(t).next;return k(e)}function ya(){return Le(function(t){const e=V(t).next();return k(e)},arguments)}function va(t){return V(t).done}function ba(t){const e=V(t).value;return k(e)}function ma(){return k(Symbol.iterator)}function wa(){return Le(function(t,e){const n=Reflect.get(V(t),V(e));return k(n)},arguments)}function Sa(){return Le(function(t,e){const n=V(t).call(V(e));return k(n)},arguments)}function xa(){const t=new Object;return k(t)}function Ea(t){return V(t).length}function Aa(t,e,n){V(t)[e>>>0]=B(n)}function Ca(t){const e=Array.from(V(t));return k(e)}function Oa(t){return Array.isArray(V(t))}function ka(t,e){return V(t).push(V(e))}function Ra(t,e){return V(t).unshift(V(e))}function Ia(t){let e;try{e=V(t) instanceof ArrayBuffer}catch{e=!1}return e}function Ta(t,e){const n=new Error(qe(t,e));return k(n)}function ja(){return Le(function(t,e,n){const r=V(t).call(V(e),V(n));return k(r)},arguments)}function Da(t){let e;try{e=V(t) instanceof Date}catch{e=!1}return e}function Pa(t){return V(t).getTime()}function Ma(t){const e=new Date(V(t));return k(e)}function Na(t){let e;try{e=V(t) instanceof Object}catch{e=!1}return e}function La(t,e){const n=Object.assign(V(t),V(e));return k(n)}function Fa(t,e,n){const r=Object.defineProperty(V(t),V(e),V(n));return k(r)}function Ua(t){const e=Object.entries(V(t));return k(e)}function $a(t){const e=Object.freeze(V(t));return k(e)}function Ba(t){const e=Object.keys(V(t));return k(e)}function za(t){const e=Object.values(V(t));return k(e)}function Va(){return Le(function(t,e,n){const r=Reflect.apply(V(t),V(e),V(n));return k(r)},arguments)}function Wa(){return Le(function(t,e){return Reflect.deleteProperty(V(t),V(e))},arguments)}function Ha(){return Le(function(t){const e=Reflect.ownKeys(V(t));return k(e)},arguments)}function Ka(){return Le(function(t,e,n){return Reflect.set(V(t),V(e),V(n))},arguments)}function Ja(t){const e=V(t).buffer;return k(e)}function Ya(t,e){const n=V(t).concat(V(e));return k(n)}function qa(t,e,n){const r=V(t).slice(e>>>0,n>>>0);return k(r)}function Ga(t,e){const n=Symbol.for(qe(t,e));return k(n)}function Qa(t){const e=V(t).toString();return k(e)}function Xa(){return Le(function(){const t=self.self;return k(t)},arguments)}function Za(){return Le(function(){const t=window.window;return k(t)},arguments)}function es(){return Le(function(){const t=globalThis.globalThis;return k(t)},arguments)}function ts(){return Le(function(){const t=global.global;return k(t)},arguments)}function ns(t,e,n){const r=new Uint8Array(V(t),e>>>0,n>>>0);return k(r)}function rs(t){const e=new Uint8Array(V(t));return k(e)}function is(t,e,n){V(t).set(V(e),n>>>0)}function os(t){return V(t).length}function as(t){let e;try{e=V(t) instanceof Uint8Array}catch{e=!1}return e}function ss(t){const e=new Uint8Array(t>>>0);return k(e)}function cs(t,e,n){const r=V(t).subarray(e>>>0,n>>>0);return k(r)}function us(t,e){const n=Ar(V(e)),r=rt(n,y.__wbindgen_malloc,y.__wbindgen_realloc),i=He;A()[t/4+1]=i,A()[t/4+0]=r}function fs(t,e){throw new Error(qe(t,e))}function ls(){const t=y.memory;return k(t)}const K=await Ru({"./automerge_wasm_bg.js":{__wbindgen_object_drop_ref:Po,__wbindgen_string_new:Mo,__wbindgen_is_null:No,__wbindgen_error_new:Lo,__wbindgen_string_get:Fo,__wbindgen_object_clone_ref:Uo,__wbindgen_number_get:$o,__wbindgen_is_undefined:Bo,__wbindgen_boolean_get:zo,__wbindgen_number_new:Vo,__wbindgen_is_function:Wo,__wbindgen_is_string:Ho,__wbindgen_json_serialize:Ko,__wbg_new_abda76e883ba8a5f:Jo,__wbg_stack_658279fe44541cf6:Yo,__wbg_error_f851667af71bcfc6:qo,__wbindgen_is_object:Go,__wbindgen_jsval_loose_eq:Qo,__wbg_String_91fba7ded13ba54c:Xo,__wbindgen_bigint_from_i64:Zo,__wbindgen_bigint_from_u64:ea,__wbg_set_20cbc34131e76824:ta,__wbg_getRandomValues_3774744e221a22ad:na,__wbg_randomFillSync_e950366c42764a07:ra,__wbg_crypto_70a96de3b6b73dac:ia,__wbg_process_dd1577445152112e:oa,__wbg_versions_58036bec3add9e6f:aa,__wbg_node_6a9d28205ed5b0d8:sa,__wbg_msCrypto_adbc770ec9eca9c7:ca,__wbg_require_f05d779769764e82:ua,__wbg_log_dc06ec929fc95a20:fa,__wbg_log_c9bb086ced3cfca3:la,__wbg_get_7303ed2ef026b2f5:da,__wbg_length_820c786973abdd8a:ha,__wbg_new_0394642eae39db16:_a,__wbg_newnoargs_c9e6043b8ad84109:ga,__wbg_next_f4bc0e96ea67da68:pa,__wbg_next_ec061e48a0e72a96:ya,__wbg_done_b6abb27d42b63867:va,__wbg_value_2f4ef2036bfad28e:ba,__wbg_iterator_7c7e58f62eb84700:ma,__wbg_get_f53c921291c381bd:wa,__wbg_call_557a2f2deacc4912:Sa,__wbg_new_2b6fea4ea03b1b95:xa,__wbg_length_afc8586b90a7a20b:Ea,__wbg_set_b4da98d504ac6091:Aa,__wbg_from_6bc98a09a0b58bb1:Ca,__wbg_isArray_04e59fb73f78ab5b:Oa,__wbg_push_109cfc26d02582dd:ka,__wbg_unshift_e6b077f26257e4e2:Ra,__wbg_instanceof_ArrayBuffer_ef2632aa0d4bfff8:Ia,__wbg_new_87297f22973157c8:Ta,__wbg_call_587b30eea3e09332:ja,__wbg_instanceof_Date_bfefb602389aff9e:Da,__wbg_getTime_40bd09e020e8bc8c:Pa,__wbg_new_606a90d0f3d171c7:Ma,__wbg_instanceof_Object_a9e9e5766628e8b5:Na,__wbg_assign_7104c235f731645f:La,__wbg_defineProperty_7c0fd2b6a4315db4:Fa,__wbg_entries_13e011453776468f:Ua,__wbg_freeze_2cdf48b297d65c5a:$a,__wbg_keys_964fd67be8b2f724:Ba,__wbg_values_099fd000c271c313:za,__wbg_apply_46ea2bb0ad750196:Va,__wbg_deleteProperty_9235094bd32a2d37:Wa,__wbg_ownKeys_16ca303f7a5c24f3:Ha,__wbg_set_07da13cc24b69217:Ka,__wbg_buffer_55ba7a6b1b92e2ac:Ja,__wbg_concat_f142c0b85cbc3819:Ya,__wbg_slice_f4ba79858cff09c3:qa,__wbg_for_965583fa75456097:Ga,__wbg_toString_0f4f66ff6b66f935:Qa,__wbg_self_742dd6eab3e9211e:Xa,__wbg_window_c409e731db53a0e2:Za,__wbg_globalThis_b70c095388441f2d:es,__wbg_global_1c72617491ed7194:ts,__wbg_newwithbyteoffsetandlength_88d1d8be5df94b9b:ns,__wbg_new_09938a7d020f049b:rs,__wbg_set_3698e3ca519b3c3c:is,__wbg_length_0aab7ffd65ad19ed:os,__wbg_instanceof_Uint8Array_1349640af2da2e88:as,__wbg_newwithlength_89eeca401d8918c2:ss,__wbg_subarray_d82be056deb4ad27:cs,__wbindgen_debug_string:us,__wbindgen_throw:fs,__wbindgen_memory:ls}},ku),Ku=K.memory,Ju=K.__wbg_syncstate_free,Yu=K.syncstate_sharedHeads,qu=K.syncstate_lastSentHeads,Gu=K.syncstate_set_lastSentHeads,Qu=K.syncstate_set_sentHashes,Xu=K.syncstate_clone,Zu=K.__wbg_automerge_free,ef=K.automerge_new,tf=K.automerge_clone,nf=K.automerge_fork,rf=K.automerge_pendingOps,of=K.automerge_commit,af=K.automerge_merge,sf=K.automerge_rollback,cf=K.automerge_keys,uf=K.automerge_text,ff=K.automerge_splice,lf=K.automerge_push,df=K.automerge_pushObject,hf=K.automerge_insert,_f=K.automerge_insertObject,gf=K.automerge_put,pf=K.automerge_putObject,yf=K.automerge_increment,vf=K.automerge_get,bf=K.automerge_getWithType,mf=K.automerge_getAll,wf=K.automerge_enableFreeze,Sf=K.automerge_registerDatatype,xf=K.automerge_applyPatches,Ef=K.automerge_applyAndReturnPatches,Af=K.automerge_popPatches,Cf=K.automerge_truncatePatches,Of=K.automerge_resetPatches,kf=K.automerge_diff,Rf=K.automerge_length,If=K.automerge_delete,Tf=K.automerge_save,jf=K.automerge_saveIncremental,Df=K.automerge_saveNoCompress,Pf=K.automerge_saveAndVerify,Mf=K.automerge_loadIncremental,Nf=K.automerge_applyChanges,Lf=K.automerge_getChanges,Ff=K.automerge_getChangeByHash,Uf=K.automerge_getChangesAdded,$f=K.automerge_getHeads,Bf=K.automerge_getActorId,zf=K.automerge_getLastLocalChange,Vf=K.automerge_dump,Wf=K.automerge_getMissingDeps,Hf=K.automerge_receiveSyncMessage,Kf=K.automerge_generateSyncMessage,Jf=K.automerge_toJS,Yf=K.automerge_materialize,qf=K.automerge_emptyChange,Gf=K.automerge_mark,Qf=K.automerge_unmark,Xf=K.automerge_marks,Zf=K.create,el=K.load,tl=K.encodeChange,nl=K.decodeChange,rl=K.initSyncState,il=K.importSyncState,ol=K.exportSyncState,al=K.encodeSyncMessage,sl=K.decodeSyncMessage,cl=K.encodeSyncState,ul=K.decodeSyncState,fl=K.__wbindgen_malloc,ll=K.__wbindgen_realloc,dl=K.__wbindgen_add_to_stack_pointer,hl=K.__wbindgen_free,_l=K.__wbindgen_exn_store;var gl=Object.freeze({__proto__:null,memory:Ku,__wbg_syncstate_free:Ju,syncstate_sharedHeads:Yu,syncstate_lastSentHeads:qu,syncstate_set_lastSentHeads:Gu,syncstate_set_sentHashes:Qu,syncstate_clone:Xu,__wbg_automerge_free:Zu,automerge_new:ef,automerge_clone:tf,automerge_fork:nf,automerge_pendingOps:rf,automerge_commit:of,automerge_merge:af,automerge_rollback:sf,automerge_keys:cf,automerge_text:uf,automerge_splice:ff,automerge_push:lf,automerge_pushObject:df,automerge_insert:hf,automerge_insertObject:_f,automerge_put:gf,automerge_putObject:pf,automerge_increment:yf,automerge_get:vf,automerge_getWithType:bf,automerge_getAll:mf,automerge_enableFreeze:wf,automerge_registerDatatype:Sf,automerge_applyPatches:xf,automerge_applyAndReturnPatches:Ef,automerge_popPatches:Af,automerge_truncatePatches:Cf,automerge_resetPatches:Of,automerge_diff:kf,automerge_length:Rf,automerge_delete:If,automerge_save:Tf,automerge_saveIncremental:jf,automerge_saveNoCompress:Df,automerge_saveAndVerify:Pf,automerge_loadIncremental:Mf,automerge_applyChanges:Nf,automerge_getChanges:Lf,automerge_getChangeByHash:Ff,automerge_getChangesAdded:Uf,automerge_getHeads:$f,automerge_getActorId:Bf,automerge_getLastLocalChange:zf,automerge_dump:Vf,automerge_getMissingDeps:Wf,automerge_receiveSyncMessage:Hf,automerge_generateSyncMessage:Kf,automerge_toJS:Jf,automerge_materialize:Yf,automerge_emptyChange:qf,automerge_mark:Gf,automerge_unmark:Qf,automerge_marks:Xf,create:Zf,load:el,encodeChange:tl,decodeChange:nl,initSyncState:rl,importSyncState:il,exportSyncState:ol,encodeSyncMessage:al,decodeSyncMessage:sl,encodeSyncState:cl,decodeSyncState:ul,__wbindgen_malloc:fl,__wbindgen_realloc:ll,__wbindgen_add_to_stack_pointer:dl,__wbindgen_free:hl,__wbindgen_exn_store:_l});jo(gl);var pl=Object.freeze({__proto__:null,__wbg_set_wasm:jo,create:Pu,load:Mu,encodeChange:Nu,decodeChange:Lu,initSyncState:Fu,importSyncState:Uu,exportSyncState:$u,encodeSyncMessage:Bu,decodeSyncMessage:zu,encodeSyncState:Vu,decodeSyncState:Wu,TextRepresentation:Hu,Automerge:tt,SyncState:Qe,__wbindgen_object_drop_ref:Po,__wbindgen_string_new:Mo,__wbindgen_is_null:No,__wbindgen_error_new:Lo,__wbindgen_string_get:Fo,__wbindgen_object_clone_ref:Uo,__wbindgen_number_get:$o,__wbindgen_is_undefined:Bo,__wbindgen_boolean_get:zo,__wbindgen_number_new:Vo,__wbindgen_is_function:Wo,__wbindgen_is_string:Ho,__wbindgen_json_serialize:Ko,__wbg_new_abda76e883ba8a5f:Jo,__wbg_stack_658279fe44541cf6:Yo,__wbg_error_f851667af71bcfc6:qo,__wbindgen_is_object:Go,__wbindgen_jsval_loose_eq:Qo,__wbg_String_91fba7ded13ba54c:Xo,__wbindgen_bigint_from_i64:Zo,__wbindgen_bigint_from_u64:ea,__wbg_set_20cbc34131e76824:ta,__wbg_getRandomValues_3774744e221a22ad:na,__wbg_randomFillSync_e950366c42764a07:ra,__wbg_crypto_70a96de3b6b73dac:ia,__wbg_process_dd1577445152112e:oa,__wbg_versions_58036bec3add9e6f:aa,__wbg_node_6a9d28205ed5b0d8:sa,__wbg_msCrypto_adbc770ec9eca9c7:ca,__wbg_require_f05d779769764e82:ua,__wbg_log_dc06ec929fc95a20:fa,__wbg_log_c9bb086ced3cfca3:la,__wbg_get_7303ed2ef026b2f5:da,__wbg_length_820c786973abdd8a:ha,__wbg_new_0394642eae39db16:_a,__wbg_newnoargs_c9e6043b8ad84109:ga,__wbg_next_f4bc0e96ea67da68:pa,__wbg_next_ec061e48a0e72a96:ya,__wbg_done_b6abb27d42b63867:va,__wbg_value_2f4ef2036bfad28e:ba,__wbg_iterator_7c7e58f62eb84700:ma,__wbg_get_f53c921291c381bd:wa,__wbg_call_557a2f2deacc4912:Sa,__wbg_new_2b6fea4ea03b1b95:xa,__wbg_length_afc8586b90a7a20b:Ea,__wbg_set_b4da98d504ac6091:Aa,__wbg_from_6bc98a09a0b58bb1:Ca,__wbg_isArray_04e59fb73f78ab5b:Oa,__wbg_push_109cfc26d02582dd:ka,__wbg_unshift_e6b077f26257e4e2:Ra,__wbg_instanceof_ArrayBuffer_ef2632aa0d4bfff8:Ia,__wbg_new_87297f22973157c8:Ta,__wbg_call_587b30eea3e09332:ja,__wbg_instanceof_Date_bfefb602389aff9e:Da,__wbg_getTime_40bd09e020e8bc8c:Pa,__wbg_new_606a90d0f3d171c7:Ma,__wbg_instanceof_Object_a9e9e5766628e8b5:Na,__wbg_assign_7104c235f731645f:La,__wbg_defineProperty_7c0fd2b6a4315db4:Fa,__wbg_entries_13e011453776468f:Ua,__wbg_freeze_2cdf48b297d65c5a:$a,__wbg_keys_964fd67be8b2f724:Ba,__wbg_values_099fd000c271c313:za,__wbg_apply_46ea2bb0ad750196:Va,__wbg_deleteProperty_9235094bd32a2d37:Wa,__wbg_ownKeys_16ca303f7a5c24f3:Ha,__wbg_set_07da13cc24b69217:Ka,__wbg_buffer_55ba7a6b1b92e2ac:Ja,__wbg_concat_f142c0b85cbc3819:Ya,__wbg_slice_f4ba79858cff09c3:qa,__wbg_for_965583fa75456097:Ga,__wbg_toString_0f4f66ff6b66f935:Qa,__wbg_self_742dd6eab3e9211e:Xa,__wbg_window_c409e731db53a0e2:Za,__wbg_globalThis_b70c095388441f2d:es,__wbg_global_1c72617491ed7194:ts,__wbg_newwithbyteoffsetandlength_88d1d8be5df94b9b:ns,__wbg_new_09938a7d020f049b:rs,__wbg_set_3698e3ca519b3c3c:is,__wbg_length_0aab7ffd65ad19ed:os,__wbg_instanceof_Uint8Array_1349640af2da2e88:as,__wbg_newwithlength_89eeca401d8918c2:ss,__wbg_subarray_d82be056deb4ad27:cs,__wbindgen_debug_string:us,__wbindgen_throw:fs,__wbindgen_memory:ls}),yl=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(t);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(t,r[i])&&(n[r[i]]=t[r[i]]);return n};function ds(t){Au(t)}ds(pl);function Jr(t){return ge(t).handle}function Yr(t){return typeof t=="object"?t:{actor:t}}function wt(t){const e=Yr(t),n=!!e.freeze,r=e.patchCallback,i=!e.enableTextV2,o=e.actor,a=Me.create({actor:o,text_v1:i});a.enableFreeze(!!e.freeze),a.registerDatatype("counter",c=>new mt(c));const s=e.enableTextV2||!1;return s?a.registerDatatype("str",c=>new qn(c)):a.registerDatatype("text",c=>new Ge(c)),a.materialize("/",void 0,{handle:a,heads:void 0,freeze:n,patchCallback:r,textV2:s})}function hs(t,e){const n=ge(t),r=n.handle;return n.handle.materialize("/",e,Object.assign(Object.assign({},n),{handle:r,heads:e}))}function _s(t,e){const n=ge(t),r=n.heads,i=Yr(e),o=n.handle.fork(i.actor,r),a=yl(n,["heads"]);return a.patchCallback=i.patchCallback,o.applyPatches(t,Object.assign(Object.assign({},a),{handle:o}))}function gs(t){return ge(t).handle.free()}function ps(t,e){return Gn(wt(e),n=>Object.assign(n,t))}function Gn(t,e,n){if(typeof e=="function")return zi(t,{},e);if(typeof n=="function")return typeof e=="string"&&(e={message:e}),zi(t,e,n);throw RangeError("Invalid args for change")}function Ft(t,e,n){if(e==null)return t;const r=ge(t),i=Object.assign(Object.assign({},r),{heads:void 0});let o;if(n!=null){r.heads;let{value:a,patches:s}=r.handle.applyAndReturnPatches(t,i);s.length>0&&n(s,{before:t,after:a}),o=a}else o=r.handle.applyPatches(t,i);return r.heads=e,o}function zi(t,e,n){if(typeof n!="function")throw new RangeError("invalid change function");const r=ge(t);if(t===void 0||r===void 0)throw new RangeError("must be the document root");if(r.heads)throw new RangeError("Attempting to change an outdated document.  Use Automerge.clone() if you wish to make a writable copy.");if(st(t))throw new RangeError("Calls to Automerge.change cannot be nested");const i=r.handle.getHeads();try{r.heads=i;const o=xu(r.handle,r.textV2);return n(o),r.handle.pendingOps()===0?(r.heads=void 0,t):(r.handle.commit(e.message,e.time),Ft(t,i,e.patchCallback||r.patchCallback))}catch(o){throw r.heads=void 0,r.handle.rollback(),o}}function ys(t,e){e===void 0&&(e={}),typeof e=="string"&&(e={message:e});const n=ge(t);if(n.heads)throw new RangeError("Attempting to change an outdated document.  Use Automerge.clone() if you wish to make a writable copy.");if(st(t))throw new RangeError("Calls to Automerge.change cannot be nested");const r=n.handle.getHeads();return n.handle.emptyChange(e.message,e.time),Ft(t,r)}function qr(t,e){const n=Yr(e),r=n.actor,i=n.patchCallback,o=!n.enableTextV2,a=n.unchecked||!1,s=Me.load(t,{text_v1:o,actor:r,unchecked:a});s.enableFreeze(!!n.freeze),s.registerDatatype("counter",f=>new mt(f));const u=n.enableTextV2||!1;return u?s.registerDatatype("str",f=>new qn(f)):s.registerDatatype("text",f=>new Ge(f)),s.materialize("/",void 0,{handle:s,heads:void 0,patchCallback:i,textV2:u})}function cn(t,e,n){n||(n={});const r=ge(t);if(r.heads)throw new RangeError("Attempting to change an out of date document - set at: "+Kr(t));if(st(t))throw new RangeError("Calls to Automerge.change cannot be nested");const i=r.handle.getHeads();return r.handle.loadIncremental(e),Ft(t,i,n.patchCallback||r.patchCallback)}function vl(t){const e=ge(t);if(e.heads)throw new RangeError("Attempting to change an out of date document - set at: "+Kr(t));if(st(t))throw new RangeError("Calls to Automerge.change cannot be nested");return e.handle.saveIncremental()}function Qn(t){return ge(t).handle.save()}function vs(t,e){const n=ge(t);if(n.heads)throw new RangeError("Attempting to change an out of date document - set at: "+Kr(t));const r=n.handle.getHeads(),i=ge(e),o=n.handle.getChangesAdded(i.handle);return n.handle.applyChanges(o),Ft(t,r,n.patchCallback)}function bs(t){return ge(t).handle.getActorId()}function bl(t,e){const n=ge(t,!1);if(n.textV2)throw new Error("use unstable.getConflicts for an unstable document");const r=at(t);if(r!=null)return Cu(n.handle,r,e)}function ms(t){return ge(t).handle.getLastLocalChange()||void 0}function Gr(t,e){if(e){const n=ge(t,!1),r=at(t);return!n||!r?null:n.handle.get(r,e)}else return at(t)}function ws(t,e){return ge(e).handle.getChanges(en(t))}function Qr(t){return ge(t).handle.getChanges([])}function Xr(t,e,n){const r=ge(t);if(n||(n={}),r.heads)throw new RangeError("Attempting to change an outdated document.  Use Automerge.clone() if you wish to make a writable copy.");if(st(t))throw new RangeError("Calls to Automerge.change cannot be nested");const i=r.handle.getHeads();return r.handle.applyChanges(e),r.heads=i,[Ft(t,i,n.patchCallback||r.patchCallback)]}function Ss(t){const e=ge(t).textV2,n=Qr(t);return n.map((r,i)=>({get change(){return oi(r)},get snapshot(){const[o]=Xr(wt({enableTextV2:e}),n.slice(0,i+1));return o}}))}function Zr(t,e){if(!Vi(t)||!Vi(e))return t===e;const n=Object.keys(t).sort(),r=Object.keys(e).sort();if(n.length!==r.length)return!1;for(let i=0;i<n.length;i++)if(n[i]!==r[i]||!Zr(t[n[i]],e[r[i]]))return!1;return!0}function ei(t){const e=Me.importSyncState(t),n=Me.encodeSyncState(e);return e.free(),n}function ti(t){const e=Me.decodeSyncState(t),n=Me.exportSyncState(e);return e.free(),n}function ni(t,e){const n=ge(t),r=Me.importSyncState(e),i=n.handle.generateSyncMessage(r);return[Me.exportSyncState(r),i]}function ri(t,e,n,r){const i=Me.importSyncState(e);r||(r={});const o=ge(t);if(o.heads)throw new RangeError("Attempting to change an outdated document.  Use Automerge.clone() if you wish to make a writable copy.");if(st(t))throw new RangeError("Calls to Automerge.change cannot be nested");const a=o.handle.getHeads();o.handle.receiveSyncMessage(i,n);const s=Me.exportSyncState(i);return[Ft(t,a,r.patchCallback||o.patchCallback),s,null]}function ii(){return Me.exportSyncState(Me.initSyncState())}function xs(t){return Me.encodeChange(t)}function oi(t){return Me.decodeChange(t)}function Es(t){return Me.encodeSyncMessage(t)}function As(t){return Me.decodeSyncMessage(t)}function Cs(t,e){return ge(t).handle.getMissingDeps(e)}function en(t){const e=ge(t);return e.heads||e.handle.getHeads()}function Os(t){ge(t).handle.dump()}function ks(t){const e=ge(t),n=e.handle.enableFreeze(!1),r=e.handle.materialize();return e.handle.enableFreeze(n),r}function Rs(t){return typeof t=="object"&&t!==null?Gr(t)==="_root"&&!!Reflect.get(t,_t):!1}function Vi(t){return typeof t=="object"&&t!==null}const ml=Jr;function wl(t){const e=Xn(t);return e.enableTextV2=!0,wt(e)}function Sl(t,e){const n=Xn(e);return n.enableTextV2=!0,_s(t,n)}function xl(t,e){const n=Xn(e);return n.enableTextV2=!0,ps(t,n)}function El(t,e){const n=Xn(e);return n.enableTextV2=!0,n.patchCallback?cn(wt(n),t):qr(t,n)}function Xn(t){return typeof t=="object"?t:{actor:t}}function Al(t,e,n,r,i){if(!st(t))throw new RangeError("object cannot be modified outside of a change block");const o=ge(t,!1),a=at(t);if(!a)throw new RangeError("invalid object for splice");const s=`${a}/${e}`;try{return o.handle.splice(s,n,r,i)}catch(u){throw new RangeError(`Cannot splice: ${u}`)}}function Cl(t,e,n,r,i){if(!st(t))throw new RangeError("object cannot be modified outside of a change block");const o=ge(t,!1),a=at(t);if(!a)throw new RangeError("invalid object for mark");const s=`${a}/${e}`;try{return o.handle.mark(s,n,r,i)}catch(u){throw new RangeError(`Cannot mark: ${u}`)}}function Ol(t,e,n,r){if(!st(t))throw new RangeError("object cannot be modified outside of a change block");const i=ge(t,!1),o=at(t);if(!o)throw new RangeError("invalid object for unmark");const a=`${o}/${e}`;try{return i.handle.unmark(a,n,r)}catch(s){throw new RangeError(`Cannot unmark: ${s}`)}}function kl(t,e){const n=ge(t,!1),r=at(t);if(!r)throw new RangeError("invalid object for unmark");const i=`${r}/${e}`;try{return n.handle.marks(i)}catch(o){throw new RangeError(`Cannot call marks(): ${o}`)}}function Rl(t,e){const n=ge(t,!1);if(!n.textV2)throw new Error("use getConflicts for a stable document");const r=at(t);if(r!=null)return Ou(n.handle,r,e)}var Il=Object.freeze({__proto__:null,getBackend:ml,init:wl,clone:Sl,from:xl,load:El,splice:Al,mark:Cl,unmark:Ol,marks:kl,getConflicts:Rl,Counter:mt,Int:ko,Uint:Ro,Float64:Io,view:hs,free:gs,getHeads:en,change:Gn,emptyChange:ys,loadIncremental:cn,save:Qn,merge:vs,getActorId:bs,getLastLocalChange:ms,getChanges:ws,getAllChanges:Qr,applyChanges:Xr,getHistory:Ss,equals:Zr,encodeSyncState:ei,decodeSyncState:ti,generateSyncMessage:ni,receiveSyncMessage:ri,initSyncState:ii,encodeChange:xs,decodeChange:oi,encodeSyncMessage:Es,decodeSyncMessage:As,getMissingDeps:Cs,dump:Os,toJS:ks,isAutomerge:Rs,getObjectId:Gr,RawString:qn}),Tl=Object.freeze({__proto__:null,unstable:Il,uuid:Wr,Counter:mt,Int:ko,Uint:Ro,Float64:Io,Text:Ge,use:ds,getBackend:Jr,init:wt,view:hs,clone:_s,free:gs,from:ps,change:Gn,emptyChange:ys,load:qr,loadIncremental:cn,saveIncremental:vl,save:Qn,merge:vs,getActorId:bs,getConflicts:bl,getLastLocalChange:ms,getObjectId:Gr,getChanges:ws,getAllChanges:Qr,applyChanges:Xr,getHistory:Ss,equals:Zr,encodeSyncState:ei,decodeSyncState:ti,generateSyncMessage:ni,receiveSyncMessage:ri,initSyncState:ii,encodeChange:xs,decodeChange:oi,encodeSyncMessage:Es,decodeSyncMessage:As,getMissingDeps:Cs,getHeads:en,dump:Os,toJS:ks,isAutomerge:Rs}),Cr={exports:{}},dr,Wi;function jl(){if(Wi)return dr;Wi=1;var t=1e3,e=t*60,n=e*60,r=n*24,i=r*7,o=r*365.25;dr=function(f,l){l=l||{};var _=typeof f;if(_==="string"&&f.length>0)return a(f);if(_==="number"&&isFinite(f))return l.long?u(f):s(f);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(f))};function a(f){if(f=String(f),!(f.length>100)){var l=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(f);if(!!l){var _=parseFloat(l[1]),m=(l[2]||"ms").toLowerCase();switch(m){case"years":case"year":case"yrs":case"yr":case"y":return _*o;case"weeks":case"week":case"w":return _*i;case"days":case"day":case"d":return _*r;case"hours":case"hour":case"hrs":case"hr":case"h":return _*n;case"minutes":case"minute":case"mins":case"min":case"m":return _*e;case"seconds":case"second":case"secs":case"sec":case"s":return _*t;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return _;default:return}}}}function s(f){var l=Math.abs(f);return l>=r?Math.round(f/r)+"d":l>=n?Math.round(f/n)+"h":l>=e?Math.round(f/e)+"m":l>=t?Math.round(f/t)+"s":f+"ms"}function u(f){var l=Math.abs(f);return l>=r?c(f,l,r,"day"):l>=n?c(f,l,n,"hour"):l>=e?c(f,l,e,"minute"):l>=t?c(f,l,t,"second"):f+" ms"}function c(f,l,_,m){var E=l>=_*1.5;return Math.round(f/_)+" "+m+(E?"s":"")}return dr}function Dl(t){n.debug=n,n.default=n,n.coerce=u,n.disable=o,n.enable=i,n.enabled=a,n.humanize=jl(),n.destroy=c,Object.keys(t).forEach(f=>{n[f]=t[f]}),n.names=[],n.skips=[],n.formatters={};function e(f){let l=0;for(let _=0;_<f.length;_++)l=(l<<5)-l+f.charCodeAt(_),l|=0;return n.colors[Math.abs(l)%n.colors.length]}n.selectColor=e;function n(f){let l,_=null,m,E;function O(...C){if(!O.enabled)return;const N=O,P=Number(new Date),j=P-(l||P);N.diff=j,N.prev=l,N.curr=P,l=P,C[0]=n.coerce(C[0]),typeof C[0]!="string"&&C.unshift("%O");let ee=0;C[0]=C[0].replace(/%([a-zA-Z%])/g,(Y,J)=>{if(Y==="%%")return"%";ee++;const q=n.formatters[J];if(typeof q=="function"){const Z=C[ee];Y=q.call(N,Z),C.splice(ee,1),ee--}return Y}),n.formatArgs.call(N,C),(N.log||n.log).apply(N,C)}return O.namespace=f,O.useColors=n.useColors(),O.color=n.selectColor(f),O.extend=r,O.destroy=n.destroy,Object.defineProperty(O,"enabled",{enumerable:!0,configurable:!1,get:()=>_!==null?_:(m!==n.namespaces&&(m=n.namespaces,E=n.enabled(f)),E),set:C=>{_=C}}),typeof n.init=="function"&&n.init(O),O}function r(f,l){const _=n(this.namespace+(typeof l>"u"?":":l)+f);return _.log=this.log,_}function i(f){n.save(f),n.namespaces=f,n.names=[],n.skips=[];let l;const _=(typeof f=="string"?f:"").split(/[\s,]+/),m=_.length;for(l=0;l<m;l++)!_[l]||(f=_[l].replace(/\*/g,".*?"),f[0]==="-"?n.skips.push(new RegExp("^"+f.slice(1)+"$")):n.names.push(new RegExp("^"+f+"$")))}function o(){const f=[...n.names.map(s),...n.skips.map(s).map(l=>"-"+l)].join(",");return n.enable(""),f}function a(f){if(f[f.length-1]==="*")return!0;let l,_;for(l=0,_=n.skips.length;l<_;l++)if(n.skips[l].test(f))return!1;for(l=0,_=n.names.length;l<_;l++)if(n.names[l].test(f))return!0;return!1}function s(f){return f.toString().substring(2,f.toString().length-2).replace(/\.\*\?$/,"*")}function u(f){return f instanceof Error?f.stack||f.message:f}function c(){console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`.")}return n.enable(n.load()),n}var Pl=Dl;(function(t,e){e.formatArgs=r,e.save=i,e.load=o,e.useColors=n,e.storage=a(),e.destroy=(()=>{let u=!1;return()=>{u||(u=!0,console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`."))}})(),e.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"];function n(){return typeof window<"u"&&window.process&&(window.process.type==="renderer"||window.process.__nwjs)?!0:typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/)?!1:typeof document<"u"&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||typeof window<"u"&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/)}function r(u){if(u[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+u[0]+(this.useColors?"%c ":" ")+"+"+t.exports.humanize(this.diff),!this.useColors)return;const c="color: "+this.color;u.splice(1,0,c,"color: inherit");let f=0,l=0;u[0].replace(/%[a-zA-Z%]/g,_=>{_!=="%%"&&(f++,_==="%c"&&(l=f))}),u.splice(l,0,c)}e.log=console.debug||console.log||(()=>{});function i(u){try{u?e.storage.setItem("debug",u):e.storage.removeItem("debug")}catch{}}function o(){let u;try{u=e.storage.getItem("debug")}catch{}return!u&&typeof process<"u"&&"env"in process&&(u=process.env.DEBUG),u}function a(){try{return localStorage}catch{}}t.exports=Pl(e);const{formatters:s}=t.exports;s.j=function(u){try{return JSON.stringify(u)}catch(c){return"[UnexpectedJSONParseError]: "+c.message}}})(Cr,Cr.exports);var Ke=Cr.exports;var H=function(){return H=Object.assign||function(e){for(var n,r=1,i=arguments.length;r<i;r++){n=arguments[r];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o])}return e},H.apply(this,arguments)};function ai(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(t);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(t,r[i])&&(n[r[i]]=t[r[i]]);return n}function de(t){var e=typeof Symbol=="function"&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function he(t,e){var n=typeof Symbol=="function"&&t[Symbol.iterator];if(!n)return t;var r=n.call(t),i,o=[],a;try{for(;(e===void 0||e-- >0)&&!(i=r.next()).done;)o.push(i.value)}catch(s){a={error:s}}finally{try{i&&!i.done&&(n=r.return)&&n.call(r)}finally{if(a)throw a.error}}return o}function me(t,e,n){if(n||arguments.length===2)for(var r=0,i=e.length,o;r<i;r++)(o||!(r in e))&&(o||(o=Array.prototype.slice.call(e,0,r)),o[r]=e[r]);return t.concat(o||Array.prototype.slice.call(e))}var be;(function(t){t.Start="xstate.start",t.Stop="xstate.stop",t.Raise="xstate.raise",t.Send="xstate.send",t.Cancel="xstate.cancel",t.NullEvent="",t.Assign="xstate.assign",t.After="xstate.after",t.DoneState="done.state",t.DoneInvoke="done.invoke",t.Log="xstate.log",t.Init="xstate.init",t.Invoke="xstate.invoke",t.ErrorExecution="error.execution",t.ErrorCommunication="error.communication",t.ErrorPlatform="error.platform",t.ErrorCustom="xstate.error",t.Update="xstate.update",t.Pure="xstate.pure",t.Choose="xstate.choose"})(be||(be={}));var Mt;(function(t){t.Parent="#_parent",t.Internal="#_internal"})(Mt||(Mt={}));var Or=be.Start,si=be.Stop,un=be.Raise,Zn=be.Send,Is=be.Cancel,Ml=be.NullEvent,ci=be.Assign;be.After;be.DoneState;var Ts=be.Log,Nl=be.Init,kr=be.Invoke;be.ErrorExecution;var Hi=be.ErrorPlatform,Ll=be.ErrorCustom,js=be.Update,Fl=be.Choose,Ul=be.Pure,Ds=".",Ki={},Rr="xstate.guard",$l="",Bl=!0,mn;function ui(t,e,n){n===void 0&&(n=Ds);var r=Xt(t,n),i=Xt(e,n);return ye(i)?ye(r)?i===r:!1:ye(r)?r in i:Object.keys(r).every(function(o){return o in i?ui(r[o],i[o]):!1})}function Ps(t){try{return ye(t)||typeof t=="number"?"".concat(t):t.type}catch{throw new Error("Events must be strings or objects with a string event.type property.")}}function Ir(t,e){try{return Ut(t)?t:t.toString().split(e)}catch{throw new Error("'".concat(t,"' is not a valid state path."))}}function zl(t){return typeof t=="object"&&"value"in t&&"context"in t&&"event"in t&&"_event"in t}function Xt(t,e){if(zl(t))return t.value;if(Ut(t))return zn(t);if(typeof t!="string")return t;var n=Ir(t,e);return zn(n)}function zn(t){if(t.length===1)return t[0];for(var e={},n=e,r=0;r<t.length-1;r++)r===t.length-2?n[t[r]]=t[r+1]:(n[t[r]]={},n=n[t[r]]);return e}function Ht(t,e){for(var n={},r=Object.keys(t),i=0;i<r.length;i++){var o=r[i];n[o]=e(t[o],o,t,i)}return n}function Ji(t,e,n){var r,i,o={};try{for(var a=de(Object.keys(t)),s=a.next();!s.done;s=a.next()){var u=s.value,c=t[u];!n(c)||(o[u]=e(c,u,t))}}catch(f){r={error:f}}finally{try{s&&!s.done&&(i=a.return)&&i.call(a)}finally{if(r)throw r.error}}return o}var Vl=function(t){return function(e){var n,r,i=e;try{for(var o=de(t),a=o.next();!a.done;a=o.next()){var s=a.value;i=i[s]}}catch(u){n={error:u}}finally{try{a&&!a.done&&(r=o.return)&&r.call(o)}finally{if(n)throw n.error}}return i}};function Wl(t,e){return function(n){var r,i,o=n;try{for(var a=de(t),s=a.next();!s.done;s=a.next()){var u=s.value;o=o[e][u]}}catch(c){r={error:c}}finally{try{s&&!s.done&&(i=a.return)&&i.call(a)}finally{if(r)throw r.error}}return o}}function Tn(t){if(!t)return[[]];if(ye(t))return[[t]];var e=Se(Object.keys(t).map(function(n){var r=t[n];return typeof r!="string"&&(!r||!Object.keys(r).length)?[[n]]:Tn(t[n]).map(function(i){return[n].concat(i)})}));return e}function Se(t){var e;return(e=[]).concat.apply(e,me([],he(t),!1))}function Ms(t){return Ut(t)?t:[t]}function Je(t){return t===void 0?[]:Ms(t)}function Vn(t,e,n){var r,i;if(_e(t))return t(e,n.data);var o={};try{for(var a=de(Object.keys(t)),s=a.next();!s.done;s=a.next()){var u=s.value,c=t[u];_e(c)?o[u]=c(e,n.data):o[u]=c}}catch(f){r={error:f}}finally{try{s&&!s.done&&(i=a.return)&&i.call(a)}finally{if(r)throw r.error}}return o}function Hl(t){return/^(done|error)\./.test(t)}function Yi(t){return!!(t instanceof Promise||t!==null&&(_e(t)||typeof t=="object")&&_e(t.then))}function Kl(t){return t!==null&&typeof t=="object"&&"transition"in t&&typeof t.transition=="function"}function Jl(t,e){var n,r,i=he([[],[]],2),o=i[0],a=i[1];try{for(var s=de(t),u=s.next();!u.done;u=s.next()){var c=u.value;e(c)?o.push(c):a.push(c)}}catch(f){n={error:f}}finally{try{u&&!u.done&&(r=s.return)&&r.call(s)}finally{if(n)throw n.error}}return[o,a]}function Ns(t,e){return Ht(t.states,function(n,r){if(!!n){var i=(ye(e)?void 0:e[r])||(n?n.current:void 0);if(!!i)return{current:i,states:Ns(n,i)}}})}function Yl(t,e){return{current:e,states:Ns(t,e)}}function qi(t,e,n,r){var i=t&&n.reduce(function(o,a){var s,u,c=a.assignment,f={state:r,action:a,_event:e},l={};if(_e(c))l=c(o,e.data,f);else try{for(var _=de(Object.keys(c)),m=_.next();!m.done;m=_.next()){var E=m.value,O=c[E];l[E]=_e(O)?O(o,e.data,f):O}}catch(C){s={error:C}}finally{try{m&&!m.done&&(u=_.return)&&u.call(_)}finally{if(s)throw s.error}}return Object.assign({},o,l)},t);return i}var ql=function(){};function Ut(t){return Array.isArray(t)}function _e(t){return typeof t=="function"}function ye(t){return typeof t=="string"}function Ls(t,e){if(!!t)return ye(t)?{type:Rr,name:t,predicate:e?e[t]:void 0}:_e(t)?{type:Rr,name:t.name,predicate:t}:t}function Gl(t){try{return"subscribe"in t&&_e(t.subscribe)}catch{return!1}}var dt=function(){return typeof Symbol=="function"&&Symbol.observable||"@@observable"}();mn={},mn[dt]=function(){return this},mn[Symbol.observable]=function(){return this};function Nt(t){return!!t&&"__xstatenode"in t}function Ql(t){return!!t&&typeof t.send=="function"}function er(t,e){return ye(t)||typeof t=="number"?H({type:t},e):t}function Pe(t,e){if(!ye(t)&&"$$type"in t&&t.$$type==="scxml")return t;var n=er(t);return H({name:n.type,data:n,$$type:"scxml",type:"external"},e)}function Et(t,e){var n=Ms(e).map(function(r){return typeof r>"u"||typeof r=="string"||Nt(r)?{target:r,event:t}:H(H({},r),{event:t})});return n}function Xl(t){if(!(t===void 0||t===$l))return Je(t)}function Fs(t,e,n,r,i){var o=t.options.guards,a={state:i,cond:e,_event:r};if(e.type===Rr)return(o?.[e.name]||e.predicate)(n,r.data,a);var s=o?.[e.type];if(!s)throw new Error("Guard '".concat(e.type,"' is not implemented on machine '").concat(t.id,"'."));return s(n,r.data,a)}function Us(t){return typeof t=="string"?{type:t}:t}function jn(t,e,n){var r=function(){},i=typeof t=="object",o=i?t:null;return{next:((i?t.next:t)||r).bind(o),error:((i?t.error:e)||r).bind(o),complete:((i?t.complete:n)||r).bind(o)}}function wn(t,e){return"".concat(t,":invocation[").concat(e,"]")}function Tr(t){return(t.type===un||t.type===Zn&&t.to===Mt.Internal)&&typeof t.delay!="number"}var Dt=Pe({type:Nl});function jr(t,e){return e&&e[t]||void 0}function tn(t,e){var n;if(ye(t)||typeof t=="number"){var r=jr(t,e);_e(r)?n={type:t,exec:r}:r?n=r:n={type:t,exec:void 0}}else if(_e(t))n={type:t.name||t.toString(),exec:t};else{var r=jr(t.type,e);if(_e(r))n=H(H({},t),{exec:r});else if(r){var i=r.type||t.type;n=H(H(H({},r),t),{type:i})}else n=t}return n}var ht=function(t,e){if(!t)return[];var n=Ut(t)?t:[t];return n.map(function(r){return tn(r,e)})};function fi(t){var e=tn(t);return H(H({id:ye(t)?t:e.id},e),{type:e.type})}function Zl(t,e){return{type:un,event:typeof t=="function"?t:er(t),delay:e?e.delay:void 0,id:e?.id}}function ed(t,e,n,r){var i={_event:n},o=Pe(_e(t.event)?t.event(e,n.data,i):t.event),a;if(ye(t.delay)){var s=r&&r[t.delay];a=_e(s)?s(e,n.data,i):s}else a=_e(t.delay)?t.delay(e,n.data,i):t.delay;return H(H({},t),{type:un,_event:o,delay:a})}function td(t,e){return{to:e?e.to:void 0,type:Zn,event:_e(t)?t:er(t),delay:e?e.delay:void 0,id:e&&e.id!==void 0?e.id:_e(t)?t.name:Ps(t)}}function nd(t,e,n,r){var i={_event:n},o=Pe(_e(t.event)?t.event(e,n.data,i):t.event),a;if(ye(t.delay)){var s=r&&r[t.delay];a=_e(s)?s(e,n.data,i):s}else a=_e(t.delay)?t.delay(e,n.data,i):t.delay;var u=_e(t.to)?t.to(e,n.data,i):t.to;return H(H({},t),{to:u,_event:o,event:o.data,delay:a})}var rd=function(t,e,n){return H(H({},t),{value:ye(t.expr)?t.expr:t.expr(e,n.data,{_event:n})})},id=function(t){return{type:Is,sendId:t}};function od(t){var e=fi(t);return{type:be.Start,activity:e,exec:void 0}}function ad(t){var e=_e(t)?t:fi(t);return{type:be.Stop,activity:e,exec:void 0}}function sd(t,e,n){var r=_e(t.activity)?t.activity(e,n.data):t.activity,i=typeof r=="string"?{id:r}:r,o={type:be.Stop,activity:i};return o}var cd=function(t){return{type:ci,assignment:t}};function ud(t,e){var n=e?"#".concat(e):"";return"".concat(be.After,"(").concat(t,")").concat(n)}function Sn(t,e){var n="".concat(be.DoneState,".").concat(t),r={type:n,data:e};return r.toString=function(){return n},r}function Dn(t,e){var n="".concat(be.DoneInvoke,".").concat(t),r={type:n,data:e};return r.toString=function(){return n},r}function Kt(t,e){var n="".concat(be.ErrorPlatform,".").concat(t),r={type:n,data:e};return r.toString=function(){return n},r}var fd=function(t){var e,n,r=[];try{for(var i=de(t),o=i.next();!o.done;o=i.next())for(var a=o.value,s=0;s<a.actions.length;){if(a.actions[s].type===ci){r.push(a.actions[s]),a.actions.splice(s,1);continue}s++}}catch(u){e={error:u}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(e)throw e.error}}return r};function Wn(t,e,n,r,i,o,a){a===void 0&&(a=!1);var s=a?[]:fd(i),u=s.length?qi(n,r,s,e):n,c=a?[n]:void 0,f=[];function l(E,O){var C;switch(O.type){case un:{var N=ed(O,u,r,t.options.delays);return o&&typeof N.delay=="number"&&o(N,u,r),N}case Zn:var P=nd(O,u,r,t.options.delays);return o&&P.to!==Mt.Internal&&(E==="entry"?f.push(P):o(P,u,r)),P;case Ts:{var j=rd(O,u,r);return o?.(j,u,r),j}case Fl:{var ee=O,D=(C=ee.conds.find(function(F){var R=Ls(F.cond,t.options.guards);return!R||Fs(t,R,u,r,o?void 0:e)}))===null||C===void 0?void 0:C.actions;if(!D)return[];var Y=he(Wn(t,e,u,r,[{type:E,actions:ht(Je(D),t.options.actions)}],o,a),2),J=Y[0],q=Y[1];return u=q,c?.push(u),J}case Ul:{var D=O.get(u,r.data);if(!D)return[];var Z=he(Wn(t,e,u,r,[{type:E,actions:ht(Je(D),t.options.actions)}],o,a),2),ae=Z[0],ne=Z[1];return u=ne,c?.push(u),ae}case si:{var j=sd(O,u,r);return o?.(j,n,r),j}case ci:{u=qi(u,r,[O],o?void 0:e),c?.push(u);break}default:var ie=tn(O,t.options.actions),S=ie.exec;if(o)o(ie,u,r);else if(S&&c){var z=c.length-1,M=H(H({},ie),{exec:function(F){for(var R=[],te=1;te<arguments.length;te++)R[te-1]=arguments[te];S.apply(void 0,me([c[z]],he(R),!1))}});ie=M}return ie}}function _(E){var O,C,N=[];try{for(var P=de(E.actions),j=P.next();!j.done;j=P.next()){var ee=j.value,D=l(E.type,ee);D&&(N=N.concat(D))}}catch(Y){O={error:Y}}finally{try{j&&!j.done&&(C=P.return)&&C.call(P)}finally{if(O)throw O.error}}return f.forEach(function(Y){o(Y,u,r)}),f.length=0,N}var m=Se(i.map(_));return[m,u]}var Rt=function(t,e){var n=e(t);return n};function $s(t){var e;return e={id:t,send:function(){},subscribe:function(){return{unsubscribe:function(){}}},getSnapshot:function(){},toJSON:function(){return{id:t}}},e[dt]=function(){return this},e}function ld(t,e,n,r){var i,o=Us(t.src),a=(i=e?.options.services)===null||i===void 0?void 0:i[o.type],s=t.data?Vn(t.data,n,r):void 0,u=a?Bs(a,t.id,s):$s(t.id);return u.meta=t,u}function Bs(t,e,n){var r=$s(e);if(r.deferred=!0,Nt(t)){var i=r.state=Rt(void 0,function(){return(n?t.withContext(n):t).initialState});r.getSnapshot=function(){return i}}return r}function dd(t){try{return typeof t.send=="function"}catch{return!1}}function hd(t){return dd(t)&&"id"in t}function _d(t){var e;return H((e={subscribe:function(){return{unsubscribe:function(){}}},id:"anonymous",getSnapshot:function(){}},e[dt]=function(){return this},e),t)}var Hn=function(t){return t.type==="atomic"||t.type==="final"};function zs(t){return Object.keys(t.states).map(function(e){return t.states[e]})}function nn(t){return zs(t).filter(function(e){return e.type!=="history"})}function Vs(t){var e=[t];return Hn(t)?e:e.concat(Se(nn(t).map(Vs)))}function Jt(t,e){var n,r,i,o,a,s,u,c,f=new Set(t),l=Dr(f),_=new Set(e);try{for(var m=de(_),E=m.next();!E.done;E=m.next())for(var O=E.value,C=O.parent;C&&!_.has(C);)_.add(C),C=C.parent}catch(Z){n={error:Z}}finally{try{E&&!E.done&&(r=m.return)&&r.call(m)}finally{if(n)throw n.error}}var N=Dr(_);try{for(var P=de(_),j=P.next();!j.done;j=P.next()){var O=j.value;if(O.type==="compound"&&(!N.get(O)||!N.get(O).length))l.get(O)?l.get(O).forEach(function(ae){return _.add(ae)}):O.initialStateNodes.forEach(function(ae){return _.add(ae)});else if(O.type==="parallel")try{for(var ee=(a=void 0,de(nn(O))),D=ee.next();!D.done;D=ee.next()){var Y=D.value;_.has(Y)||(_.add(Y),l.get(Y)?l.get(Y).forEach(function(ae){return _.add(ae)}):Y.initialStateNodes.forEach(function(ae){return _.add(ae)}))}}catch(ae){a={error:ae}}finally{try{D&&!D.done&&(s=ee.return)&&s.call(ee)}finally{if(a)throw a.error}}}}catch(Z){i={error:Z}}finally{try{j&&!j.done&&(o=P.return)&&o.call(P)}finally{if(i)throw i.error}}try{for(var J=de(_),q=J.next();!q.done;q=J.next())for(var O=q.value,C=O.parent;C&&!_.has(C);)_.add(C),C=C.parent}catch(Z){u={error:Z}}finally{try{q&&!q.done&&(c=J.return)&&c.call(J)}finally{if(u)throw u.error}}return _}function Ws(t,e){var n=e.get(t);if(!n)return{};if(t.type==="compound"){var r=n[0];if(r){if(Hn(r))return r.key}else return{}}var i={};return n.forEach(function(o){i[o.key]=Ws(o,e)}),i}function Dr(t){var e,n,r=new Map;try{for(var i=de(t),o=i.next();!o.done;o=i.next()){var a=o.value;r.has(a)||r.set(a,[]),a.parent&&(r.has(a.parent)||r.set(a.parent,[]),r.get(a.parent).push(a))}}catch(s){e={error:s}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(e)throw e.error}}return r}function gd(t,e){var n=Jt([t],e);return Ws(t,Dr(n))}function Yt(t,e){return Array.isArray(t)?t.some(function(n){return n===e}):t instanceof Set?t.has(e):!1}function pd(t){return me([],he(new Set(Se(me([],he(t.map(function(e){return e.ownEvents})),!1)))),!1)}function Pn(t,e){return e.type==="compound"?nn(e).some(function(n){return n.type==="final"&&Yt(t,n)}):e.type==="parallel"?nn(e).every(function(n){return Pn(t,n)}):!1}function yd(t){return t===void 0&&(t=[]),t.reduce(function(e,n){return n.meta!==void 0&&(e[n.id]=n.meta),e},{})}function Gi(t){return new Set(Se(t.map(function(e){return e.tags})))}function Hs(t,e){if(t===e)return!0;if(t===void 0||e===void 0)return!1;if(ye(t)||ye(e))return t===e;var n=Object.keys(t),r=Object.keys(e);return n.length===r.length&&n.every(function(i){return Hs(t[i],e[i])})}function vd(t){return typeof t!="object"||t===null?!1:"value"in t&&"_event"in t}function bd(t,e){var n=t.exec,r=H(H({},t),{exec:n!==void 0?function(){return n(e.context,e.event,{action:t,state:e,_event:e._event})}:void 0});return r}var Ze=function(){function t(e){var n=this,r;this.actions=[],this.activities=Ki,this.meta={},this.events=[],this.value=e.value,this.context=e.context,this._event=e._event,this._sessionid=e._sessionid,this.event=this._event.data,this.historyValue=e.historyValue,this.history=e.history,this.actions=e.actions||[],this.activities=e.activities||Ki,this.meta=yd(e.configuration),this.events=e.events||[],this.matches=this.matches.bind(this),this.toStrings=this.toStrings.bind(this),this.configuration=e.configuration,this.transitions=e.transitions,this.children=e.children,this.done=!!e.done,this.tags=(r=Array.isArray(e.tags)?new Set(e.tags):e.tags)!==null&&r!==void 0?r:new Set,this.machine=e.machine,Object.defineProperty(this,"nextEvents",{get:function(){return pd(n.configuration)}})}return t.from=function(e,n){if(e instanceof t)return e.context!==n?new t({value:e.value,context:n,_event:e._event,_sessionid:null,historyValue:e.historyValue,history:e.history,actions:[],activities:e.activities,meta:{},events:[],configuration:[],transitions:[],children:{}}):e;var r=Dt;return new t({value:e,context:n,_event:r,_sessionid:null,historyValue:void 0,history:void 0,actions:[],activities:void 0,meta:void 0,events:[],configuration:[],transitions:[],children:{}})},t.create=function(e){return new t(e)},t.inert=function(e,n){if(e instanceof t){if(!e.actions.length)return e;var r=Dt;return new t({value:e.value,context:n,_event:r,_sessionid:null,historyValue:e.historyValue,history:e.history,activities:e.activities,configuration:e.configuration,transitions:[],children:{}})}return t.from(e,n)},t.prototype.toStrings=function(e,n){var r=this;if(e===void 0&&(e=this.value),n===void 0&&(n="."),ye(e))return[e];var i=Object.keys(e);return i.concat.apply(i,me([],he(i.map(function(o){return r.toStrings(e[o],n).map(function(a){return o+n+a})})),!1))},t.prototype.toJSON=function(){var e=this;e.configuration,e.transitions;var n=e.tags;e.machine;var r=ai(e,["configuration","transitions","tags","machine"]);return H(H({},r),{tags:Array.from(n)})},t.prototype.matches=function(e){return ui(e,this.value)},t.prototype.hasTag=function(e){return this.tags.has(e)},t.prototype.can=function(e){var n;ql(!!this.machine);var r=(n=this.machine)===null||n===void 0?void 0:n.getTransitionData(this,e);return!!r?.transitions.length&&r.transitions.some(function(i){return i.target!==void 0||i.actions.length})},t}(),md={deferEvents:!1},Qi=function(){function t(e){this.processingEvent=!1,this.queue=[],this.initialized=!1,this.options=H(H({},md),e)}return t.prototype.initialize=function(e){if(this.initialized=!0,e){if(!this.options.deferEvents){this.schedule(e);return}this.process(e)}this.flushEvents()},t.prototype.schedule=function(e){if(!this.initialized||this.processingEvent){this.queue.push(e);return}if(this.queue.length!==0)throw new Error("Event queue should be empty when it is not processing events");this.process(e),this.flushEvents()},t.prototype.clear=function(){this.queue=[]},t.prototype.flushEvents=function(){for(var e=this.queue.shift();e;)this.process(e),e=this.queue.shift()},t.prototype.process=function(e){this.processingEvent=!0;try{e()}catch(n){throw this.clear(),n}finally{this.processingEvent=!1}},t}(),hr=new Map,wd=0,Vt={bookId:function(){return"x:".concat(wd++)},register:function(t,e){return hr.set(t,e),t},get:function(t){return hr.get(t)},free:function(t){hr.delete(t)}};function li(){if(typeof globalThis<"u")return globalThis;if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global}function Sd(){var t=li();if(t&&"__xstate__"in t)return t.__xstate__}function xd(t){if(!!li()){var e=Sd();e&&e.register(t)}}function Ed(t,e){e===void 0&&(e={});var n=t.initialState,r=new Set,i=[],o=!1,a=function(){if(!o){for(o=!0;i.length>0;){var c=i.shift();n=t.transition(n,c,u),r.forEach(function(f){return f.next(n)})}o=!1}},s=_d({id:e.id,send:function(c){i.push(c),a()},getSnapshot:function(){return n},subscribe:function(c,f,l){var _=jn(c,f,l);return r.add(_),_.next(n),{unsubscribe:function(){r.delete(_)}}}}),u={parent:e.parent,self:s,id:e.id||"anonymous",observers:r};return n=t.start?t.start(u):n,s}var Ad={sync:!1,autoForward:!1},Ie;(function(t){t[t.NotStarted=0]="NotStarted",t[t.Running=1]="Running",t[t.Stopped=2]="Stopped"})(Ie||(Ie={}));var Cd=function(){function t(e,n){n===void 0&&(n=t.defaultOptions);var r=this;this.machine=e,this.delayedEventsMap={},this.listeners=new Set,this.contextListeners=new Set,this.stopListeners=new Set,this.doneListeners=new Set,this.eventListeners=new Set,this.sendListeners=new Set,this.initialized=!1,this.status=Ie.NotStarted,this.children=new Map,this.forwardTo=new Set,this._outgoingQueue=[],this.init=this.start,this.send=function(f,l){if(Ut(f))return r.batch(f),r.state;var _=Pe(er(f,l));if(r.status===Ie.Stopped)return r.state;if(r.status!==Ie.Running&&!r.options.deferEvents)throw new Error('Event "'.concat(_.name,'" was sent to uninitialized service "').concat(r.machine.id,`". Make sure .start() is called for this service, or set { deferEvents: true } in the service options.
Event: `).concat(JSON.stringify(_.data)));return r.scheduler.schedule(function(){r.forward(_);var m=r._nextState(_);r.update(m,_)}),r._state},this.sendTo=function(f,l,_){var m=r.parent&&(l===Mt.Parent||r.parent.id===l),E=m?r.parent:ye(l)?l===Mt.Internal?r:r.children.get(l)||Vt.get(l):Ql(l)?l:void 0;if(!E){if(!m)throw new Error("Unable to send event to child '".concat(l,"' from service '").concat(r.id,"'."));return}if("machine"in E){if(r.status!==Ie.Stopped||r.parent!==E||r.state.done){var O=H(H({},f),{name:f.name===Ll?"".concat(Kt(r.id)):f.name,origin:r.sessionId});!_&&r.machine.config.predictableActionArguments?r._outgoingQueue.push([E,O]):E.send(O)}}else!_&&r.machine.config.predictableActionArguments?r._outgoingQueue.push([E,f.data]):E.send(f.data)},this._exec=function(f,l,_,m){m===void 0&&(m=r.machine.options.actions);var E=f.exec||jr(f.type,m),O=_e(E)?E:E?E.exec:f.exec;if(O)try{return O(l,_.data,r.machine.config.predictableActionArguments?{action:f,_event:_}:{action:f,state:r.state,_event:_})}catch(z){throw r.parent&&r.parent.send({type:"xstate.error",data:z}),z}switch(f.type){case un:{var C=f;r.defer(C);break}case Zn:var N=f;if(typeof N.delay=="number"){r.defer(N);return}else N.to?r.sendTo(N._event,N.to,_===Dt):r.send(N._event);break;case Is:r.cancel(f.sendId);break;case Or:{if(r.status!==Ie.Running)return;var P=f.activity;if(!r.machine.config.predictableActionArguments&&!r.state.activities[P.id||P.type])break;if(P.type===be.Invoke){var j=Us(P.src),ee=r.machine.options.services?r.machine.options.services[j.type]:void 0,D=P.id,Y=P.data,J="autoForward"in P?P.autoForward:!!P.forward;if(!ee)return;var q=Y?Vn(Y,l,_):void 0;if(typeof ee=="string")return;var Z=_e(ee)?ee(l,_.data,{data:q,src:j,meta:P.meta}):ee;if(!Z)return;var ae=void 0;Nt(Z)&&(Z=q?Z.withContext(q):Z,ae={autoForward:J}),r.spawn(Z,D,ae)}else r.spawnActivity(P);break}case si:{r.stopChild(f.activity.id);break}case Ts:var ne=f,ie=ne.label,S=ne.value;ie?r.logger(ie,S):r.logger(S);break}};var i=H(H({},t.defaultOptions),n),o=i.clock,a=i.logger,s=i.parent,u=i.id,c=u!==void 0?u:e.id;this.id=c,this.logger=a,this.clock=o,this.parent=s,this.options=i,this.scheduler=new Qi({deferEvents:this.options.deferEvents}),this.sessionId=Vt.bookId()}return Object.defineProperty(t.prototype,"initialState",{get:function(){var e=this;return this._initialState?this._initialState:Rt(this,function(){return e._initialState=e.machine.initialState,e._initialState})},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"state",{get:function(){return this._state},enumerable:!1,configurable:!0}),t.prototype.execute=function(e,n){var r,i;try{for(var o=de(e.actions),a=o.next();!a.done;a=o.next()){var s=a.value;this.exec(s,e,n)}}catch(u){r={error:u}}finally{try{a&&!a.done&&(i=o.return)&&i.call(o)}finally{if(r)throw r.error}}},t.prototype.update=function(e,n){var r,i,o,a,s,u,c,f,l=this;if(e._sessionid=this.sessionId,this._state=e,(!this.machine.config.predictableActionArguments||n===Dt)&&this.options.execute)this.execute(this.state);else for(var _=void 0;_=this._outgoingQueue.shift();)_[0].send(_[1]);if(this.children.forEach(function(Z){l.state.children[Z.id]=Z}),this.devTools&&this.devTools.send(n.data,e),e.event)try{for(var m=de(this.eventListeners),E=m.next();!E.done;E=m.next()){var O=E.value;O(e.event)}}catch(Z){r={error:Z}}finally{try{E&&!E.done&&(i=m.return)&&i.call(m)}finally{if(r)throw r.error}}try{for(var C=de(this.listeners),N=C.next();!N.done;N=C.next()){var O=N.value;O(e,e.event)}}catch(Z){o={error:Z}}finally{try{N&&!N.done&&(a=C.return)&&a.call(C)}finally{if(o)throw o.error}}try{for(var P=de(this.contextListeners),j=P.next();!j.done;j=P.next()){var ee=j.value;ee(this.state.context,this.state.history?this.state.history.context:void 0)}}catch(Z){s={error:Z}}finally{try{j&&!j.done&&(u=P.return)&&u.call(P)}finally{if(s)throw s.error}}if(this.state.done){var D=e.configuration.find(function(Z){return Z.type==="final"&&Z.parent===l.machine}),Y=D&&D.doneData?Vn(D.doneData,e.context,n):void 0;this._doneEvent=Dn(this.id,Y);try{for(var J=de(this.doneListeners),q=J.next();!q.done;q=J.next()){var O=q.value;O(this._doneEvent)}}catch(Z){c={error:Z}}finally{try{q&&!q.done&&(f=J.return)&&f.call(J)}finally{if(c)throw c.error}}this._stop(),this._stopChildren(),Vt.free(this.sessionId)}},t.prototype.onTransition=function(e){return this.listeners.add(e),this.status===Ie.Running&&e(this.state,this.state.event),this},t.prototype.subscribe=function(e,n,r){var i=this,o=jn(e,n,r);this.listeners.add(o.next),this.status!==Ie.NotStarted&&o.next(this.state);var a=function(){i.doneListeners.delete(a),i.stopListeners.delete(a),o.complete()};return this.status===Ie.Stopped?o.complete():(this.onDone(a),this.onStop(a)),{unsubscribe:function(){i.listeners.delete(o.next),i.doneListeners.delete(a),i.stopListeners.delete(a)}}},t.prototype.onEvent=function(e){return this.eventListeners.add(e),this},t.prototype.onSend=function(e){return this.sendListeners.add(e),this},t.prototype.onChange=function(e){return this.contextListeners.add(e),this},t.prototype.onStop=function(e){return this.stopListeners.add(e),this},t.prototype.onDone=function(e){return this.status===Ie.Stopped&&this._doneEvent?e(this._doneEvent):this.doneListeners.add(e),this},t.prototype.off=function(e){return this.listeners.delete(e),this.eventListeners.delete(e),this.sendListeners.delete(e),this.stopListeners.delete(e),this.doneListeners.delete(e),this.contextListeners.delete(e),this},t.prototype.start=function(e){var n=this;if(this.status===Ie.Running)return this;this.machine._init(),Vt.register(this.sessionId,this),this.initialized=!0,this.status=Ie.Running;var r=e===void 0?this.initialState:Rt(this,function(){return vd(e)?n.machine.resolveState(e):n.machine.resolveState(Ze.from(e,n.machine.context))});return this.options.devTools&&this.attachDev(),this.scheduler.initialize(function(){n.update(r,Dt)}),this},t.prototype._stopChildren=function(){this.children.forEach(function(e){_e(e.stop)&&e.stop()}),this.children.clear()},t.prototype._stop=function(){var e,n,r,i,o,a,s,u,c,f;try{for(var l=de(this.listeners),_=l.next();!_.done;_=l.next()){var m=_.value;this.listeners.delete(m)}}catch(J){e={error:J}}finally{try{_&&!_.done&&(n=l.return)&&n.call(l)}finally{if(e)throw e.error}}try{for(var E=de(this.stopListeners),O=E.next();!O.done;O=E.next()){var m=O.value;m(),this.stopListeners.delete(m)}}catch(J){r={error:J}}finally{try{O&&!O.done&&(i=E.return)&&i.call(E)}finally{if(r)throw r.error}}try{for(var C=de(this.contextListeners),N=C.next();!N.done;N=C.next()){var m=N.value;this.contextListeners.delete(m)}}catch(J){o={error:J}}finally{try{N&&!N.done&&(a=C.return)&&a.call(C)}finally{if(o)throw o.error}}try{for(var P=de(this.doneListeners),j=P.next();!j.done;j=P.next()){var m=j.value;this.doneListeners.delete(m)}}catch(J){s={error:J}}finally{try{j&&!j.done&&(u=P.return)&&u.call(P)}finally{if(s)throw s.error}}if(!this.initialized)return this;this.initialized=!1,this.status=Ie.Stopped,this._initialState=void 0;try{for(var ee=de(Object.keys(this.delayedEventsMap)),D=ee.next();!D.done;D=ee.next()){var Y=D.value;this.clock.clearTimeout(this.delayedEventsMap[Y])}}catch(J){c={error:J}}finally{try{D&&!D.done&&(f=ee.return)&&f.call(ee)}finally{if(c)throw c.error}}this.scheduler.clear(),this.scheduler=new Qi({deferEvents:this.options.deferEvents})},t.prototype.stop=function(){var e=this,n=this.scheduler;return this._stop(),n.schedule(function(){var r=Pe({type:"xstate.stop"}),i=Rt(e,function(){var o=Se(me([],he(e.state.configuration),!1).sort(function(f,l){return l.order-f.order}).map(function(f){return ht(f.onExit,e.machine.options.actions)})),a=he(Wn(e.machine,e.state,e.state.context,r,[{type:"exit",actions:o}],e.machine.config.predictableActionArguments?e._exec:void 0,e.machine.config.predictableActionArguments||e.machine.config.preserveActionOrder),2),s=a[0],u=a[1],c=new Ze({value:e.state.value,context:u,_event:r,_sessionid:e.sessionId,historyValue:void 0,history:e.state,actions:s.filter(function(f){return!Tr(f)}),activities:{},events:[],configuration:[],transitions:[],children:{},done:e.state.done,tags:e.state.tags,machine:e.machine});return c.changed=!0,c});e.update(i,r),e._stopChildren(),Vt.free(e.sessionId)}),this},t.prototype.batch=function(e){var n=this;if(!(this.status===Ie.NotStarted&&this.options.deferEvents)){if(this.status!==Ie.Running)throw new Error("".concat(e.length,' event(s) were sent to uninitialized service "').concat(this.machine.id,'". Make sure .start() is called for this service, or set { deferEvents: true } in the service options.'))}if(!!e.length){var r=!!this.machine.config.predictableActionArguments&&this._exec;this.scheduler.schedule(function(){var i,o,a=n.state,s=!1,u=[],c=function(m){var E=Pe(m);n.forward(E),a=Rt(n,function(){return n.machine.transition(a,E,void 0,r||void 0)}),u.push.apply(u,me([],he(n.machine.config.predictableActionArguments?a.actions:a.actions.map(function(O){return bd(O,a)})),!1)),s=s||!!a.changed};try{for(var f=de(e),l=f.next();!l.done;l=f.next()){var _=l.value;c(_)}}catch(m){i={error:m}}finally{try{l&&!l.done&&(o=f.return)&&o.call(f)}finally{if(i)throw i.error}}a.changed=s,a.actions=u,n.update(a,Pe(e[e.length-1]))})}},t.prototype.sender=function(e){return this.send.bind(this,e)},t.prototype._nextState=function(e,n){var r=this;n===void 0&&(n=!!this.machine.config.predictableActionArguments&&this._exec);var i=Pe(e);if(i.name.indexOf(Hi)===0&&!this.state.nextEvents.some(function(a){return a.indexOf(Hi)===0}))throw i.data.data;var o=Rt(this,function(){return r.machine.transition(r.state,i,void 0,n||void 0)});return o},t.prototype.nextState=function(e){return this._nextState(e,!1)},t.prototype.forward=function(e){var n,r;try{for(var i=de(this.forwardTo),o=i.next();!o.done;o=i.next()){var a=o.value,s=this.children.get(a);if(!s)throw new Error("Unable to forward event '".concat(e,"' from interpreter '").concat(this.id,"' to nonexistant child '").concat(a,"'."));s.send(e)}}catch(u){n={error:u}}finally{try{o&&!o.done&&(r=i.return)&&r.call(i)}finally{if(n)throw n.error}}},t.prototype.defer=function(e){var n=this,r=this.clock.setTimeout(function(){"to"in e&&e.to?n.sendTo(e._event,e.to,!0):n.send(e._event)},e.delay);e.id&&(this.delayedEventsMap[e.id]=r)},t.prototype.cancel=function(e){this.clock.clearTimeout(this.delayedEventsMap[e]),delete this.delayedEventsMap[e]},t.prototype.exec=function(e,n,r){r===void 0&&(r=this.machine.options.actions),this._exec(e,n.context,n._event,r)},t.prototype.removeChild=function(e){var n;this.children.delete(e),this.forwardTo.delete(e),(n=this.state)===null||n===void 0||delete n.children[e]},t.prototype.stopChild=function(e){var n=this.children.get(e);!n||(this.removeChild(e),_e(n.stop)&&n.stop())},t.prototype.spawn=function(e,n,r){if(this.status!==Ie.Running)return Bs(e,n);if(Yi(e))return this.spawnPromise(Promise.resolve(e),n);if(_e(e))return this.spawnCallback(e,n);if(hd(e))return this.spawnActor(e,n);if(Gl(e))return this.spawnObservable(e,n);if(Nt(e))return this.spawnMachine(e,H(H({},r),{id:n}));if(Kl(e))return this.spawnBehavior(e,n);throw new Error('Unable to spawn entity "'.concat(n,'" of type "').concat(typeof e,'".'))},t.prototype.spawnMachine=function(e,n){var r=this;n===void 0&&(n={});var i=new t(e,H(H({},this.options),{parent:this,id:n.id||e.id})),o=H(H({},Ad),n);o.sync&&i.onTransition(function(s){r.send(js,{state:s,id:i.id})});var a=i;return this.children.set(i.id,a),o.autoForward&&this.forwardTo.add(i.id),i.onDone(function(s){r.removeChild(i.id),r.send(Pe(s,{origin:i.id}))}).start(),a},t.prototype.spawnBehavior=function(e,n){var r=Ed(e,{id:n,parent:this});return this.children.set(n,r),r},t.prototype.spawnPromise=function(e,n){var r,i=this,o=!1,a;e.then(function(u){o||(a=u,i.removeChild(n),i.send(Pe(Dn(n,u),{origin:n})))},function(u){if(!o){i.removeChild(n);var c=Kt(n,u);try{i.send(Pe(c,{origin:n}))}catch{i.devTools&&i.devTools.send(c,i.state),i.machine.strict&&i.stop()}}});var s=(r={id:n,send:function(){},subscribe:function(u,c,f){var l=jn(u,c,f),_=!1;return e.then(function(m){_||(l.next(m),!_&&l.complete())},function(m){_||l.error(m)}),{unsubscribe:function(){return _=!0}}},stop:function(){o=!0},toJSON:function(){return{id:n}},getSnapshot:function(){return a}},r[dt]=function(){return this},r);return this.children.set(n,s),s},t.prototype.spawnCallback=function(e,n){var r,i=this,o=!1,a=new Set,s=new Set,u,c=function(_){u=_,s.forEach(function(m){return m(_)}),!o&&i.send(Pe(_,{origin:n}))},f;try{f=e(c,function(_){a.add(_)})}catch(_){this.send(Kt(n,_))}if(Yi(f))return this.spawnPromise(f,n);var l=(r={id:n,send:function(_){return a.forEach(function(m){return m(_)})},subscribe:function(_){var m=jn(_);return s.add(m.next),{unsubscribe:function(){s.delete(m.next)}}},stop:function(){o=!0,_e(f)&&f()},toJSON:function(){return{id:n}},getSnapshot:function(){return u}},r[dt]=function(){return this},r);return this.children.set(n,l),l},t.prototype.spawnObservable=function(e,n){var r,i=this,o,a=e.subscribe(function(u){o=u,i.send(Pe(u,{origin:n}))},function(u){i.removeChild(n),i.send(Pe(Kt(n,u),{origin:n}))},function(){i.removeChild(n),i.send(Pe(Dn(n),{origin:n}))}),s=(r={id:n,send:function(){},subscribe:function(u,c,f){return e.subscribe(u,c,f)},stop:function(){return a.unsubscribe()},getSnapshot:function(){return o},toJSON:function(){return{id:n}}},r[dt]=function(){return this},r);return this.children.set(n,s),s},t.prototype.spawnActor=function(e,n){return this.children.set(n,e),e},t.prototype.spawnActivity=function(e){var n=this.machine.options&&this.machine.options.activities?this.machine.options.activities[e.type]:void 0;if(!!n){var r=n(this.state.context,e);this.spawnEffect(e.id,r)}},t.prototype.spawnEffect=function(e,n){var r;this.children.set(e,(r={id:e,send:function(){},subscribe:function(){return{unsubscribe:function(){}}},stop:n||void 0,getSnapshot:function(){},toJSON:function(){return{id:e}}},r[dt]=function(){return this},r))},t.prototype.attachDev=function(){var e=li();if(this.options.devTools&&e){if(e.__REDUX_DEVTOOLS_EXTENSION__){var n=typeof this.options.devTools=="object"?this.options.devTools:void 0;this.devTools=e.__REDUX_DEVTOOLS_EXTENSION__.connect(H(H({name:this.id,autoPause:!0,stateSanitizer:function(r){return{value:r.value,context:r.context,actions:r.actions}}},n),{features:H({jump:!1,skip:!1},n?n.features:void 0)}),this.machine),this.devTools.init(this.state)}xd(this)}},t.prototype.toJSON=function(){return{id:this.id}},t.prototype[dt]=function(){return this},t.prototype.getSnapshot=function(){return this.status===Ie.NotStarted?this.initialState:this._state},t.defaultOptions={execute:!0,deferEvents:!0,clock:{setTimeout:function(e,n){return setTimeout(e,n)},clearTimeout:function(e){return clearTimeout(e)}},logger:console.log.bind(console),devTools:!1},t.interpret=Ks,t}();function Ks(t,e){var n=new Cd(t,e);return n}function Od(t){if(typeof t=="string"){var e={type:t};return e.toString=function(){return t},e}return t}function xn(t){return H(H({type:kr},t),{toJSON:function(){t.onDone,t.onError;var e=ai(t,["onDone","onError"]);return H(H({},e),{type:kr,src:Od(t.src)})}})}var En="",Pr="#",_r="*",At={},Ct=function(t){return t[0]===Pr},kd=function(){return{actions:{},guards:{},services:{},activities:{},delays:{}}},Rd=function(){function t(e,n,r,i){r===void 0&&(r="context"in e?e.context:void 0);var o=this,a;this.config=e,this._context=r,this.order=-1,this.__xstatenode=!0,this.__cache={events:void 0,relativeValue:new Map,initialStateValue:void 0,initialState:void 0,on:void 0,transitions:void 0,candidates:{},delayedTransitions:void 0},this.idMap={},this.tags=[],this.options=Object.assign(kd(),n),this.parent=i?.parent,this.key=this.config.key||i?.key||this.config.id||"(machine)",this.machine=this.parent?this.parent.machine:this,this.path=this.parent?this.parent.path.concat(this.key):[],this.delimiter=this.config.delimiter||(this.parent?this.parent.delimiter:Ds),this.id=this.config.id||me([this.machine.key],he(this.path),!1).join(this.delimiter),this.version=this.parent?this.parent.version:this.config.version,this.type=this.config.type||(this.config.parallel?"parallel":this.config.states&&Object.keys(this.config.states).length?"compound":this.config.history?"history":"atomic"),this.schema=this.parent?this.machine.schema:(a=this.config.schema)!==null&&a!==void 0?a:{},this.description=this.config.description,this.initial=this.config.initial,this.states=this.config.states?Ht(this.config.states,function(c,f){var l,_=new t(c,{},void 0,{parent:o,key:f});return Object.assign(o.idMap,H((l={},l[_.id]=_,l),_.idMap)),_}):At;var s=0;function u(c){var f,l;c.order=s++;try{for(var _=de(zs(c)),m=_.next();!m.done;m=_.next()){var E=m.value;u(E)}}catch(O){f={error:O}}finally{try{m&&!m.done&&(l=_.return)&&l.call(_)}finally{if(f)throw f.error}}}u(this),this.history=this.config.history===!0?"shallow":this.config.history||!1,this._transient=!!this.config.always||(this.config.on?Array.isArray(this.config.on)?this.config.on.some(function(c){var f=c.event;return f===En}):En in this.config.on:!1),this.strict=!!this.config.strict,this.onEntry=Je(this.config.entry||this.config.onEntry).map(function(c){return tn(c)}),this.onExit=Je(this.config.exit||this.config.onExit).map(function(c){return tn(c)}),this.meta=this.config.meta,this.doneData=this.type==="final"?this.config.data:void 0,this.invoke=Je(this.config.invoke).map(function(c,f){var l,_;if(Nt(c)){var m=wn(o.id,f);return o.machine.options.services=H((l={},l[m]=c,l),o.machine.options.services),xn({src:m,id:m})}else if(ye(c.src)){var m=c.id||wn(o.id,f);return xn(H(H({},c),{id:m,src:c.src}))}else if(Nt(c.src)||_e(c.src)){var m=c.id||wn(o.id,f);return o.machine.options.services=H((_={},_[m]=c.src,_),o.machine.options.services),xn(H(H({id:m},c),{src:m}))}else{var E=c.src;return xn(H(H({id:wn(o.id,f)},c),{src:E}))}}),this.activities=Je(this.config.activities).concat(this.invoke).map(function(c){return fi(c)}),this.transition=this.transition.bind(this),this.tags=Je(this.config.tags)}return t.prototype._init=function(){this.__cache.transitions||Vs(this).forEach(function(e){return e.on})},t.prototype.withConfig=function(e,n){var r=this.options,i=r.actions,o=r.activities,a=r.guards,s=r.services,u=r.delays;return new t(this.config,{actions:H(H({},i),e.actions),activities:H(H({},o),e.activities),guards:H(H({},a),e.guards),services:H(H({},s),e.services),delays:H(H({},u),e.delays)},n??this.context)},t.prototype.withContext=function(e){return new t(this.config,this.options,e)},Object.defineProperty(t.prototype,"context",{get:function(){return _e(this._context)?this._context():this._context},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"definition",{get:function(){return{id:this.id,key:this.key,version:this.version,context:this.context,type:this.type,initial:this.initial,history:this.history,states:Ht(this.states,function(e){return e.definition}),on:this.on,transitions:this.transitions,entry:this.onEntry,exit:this.onExit,activities:this.activities||[],meta:this.meta,order:this.order||-1,data:this.doneData,invoke:this.invoke,description:this.description,tags:this.tags}},enumerable:!1,configurable:!0}),t.prototype.toJSON=function(){return this.definition},Object.defineProperty(t.prototype,"on",{get:function(){if(this.__cache.on)return this.__cache.on;var e=this.transitions;return this.__cache.on=e.reduce(function(n,r){return n[r.eventType]=n[r.eventType]||[],n[r.eventType].push(r),n},{})},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"after",{get:function(){return this.__cache.delayedTransitions||(this.__cache.delayedTransitions=this.getDelayedTransitions(),this.__cache.delayedTransitions)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"transitions",{get:function(){return this.__cache.transitions||(this.__cache.transitions=this.formatTransitions(),this.__cache.transitions)},enumerable:!1,configurable:!0}),t.prototype.getCandidates=function(e){if(this.__cache.candidates[e])return this.__cache.candidates[e];var n=e===En,r=this.transitions.filter(function(i){var o=i.eventType===e;return n?o:o||i.eventType===_r});return this.__cache.candidates[e]=r,r},t.prototype.getDelayedTransitions=function(){var e=this,n=this.config.after;if(!n)return[];var r=function(o,a){var s=_e(o)?"".concat(e.id,":delay[").concat(a,"]"):o,u=ud(s,e.id);return e.onEntry.push(td(u,{delay:o})),e.onExit.push(id(u)),u},i=Ut(n)?n.map(function(o,a){var s=r(o.delay,a);return H(H({},o),{event:s})}):Se(Object.keys(n).map(function(o,a){var s=n[o],u=ye(s)?{target:s}:s,c=isNaN(+o)?o:+o,f=r(c,a);return Je(u).map(function(l){return H(H({},l),{event:f,delay:c})})}));return i.map(function(o){var a=o.delay;return H(H({},e.formatTransition(o)),{delay:a})})},t.prototype.getStateNodes=function(e){var n,r=this;if(!e)return[];var i=e instanceof Ze?e.value:Xt(e,this.delimiter);if(ye(i)){var o=this.getStateNode(i).initial;return o!==void 0?this.getStateNodes((n={},n[i]=o,n)):[this,this.states[i]]}var a=Object.keys(i),s=[this];return s.push.apply(s,me([],he(Se(a.map(function(u){return r.getStateNode(u).getStateNodes(i[u])}))),!1)),s},t.prototype.handles=function(e){var n=Ps(e);return this.events.includes(n)},t.prototype.resolveState=function(e){var n=e instanceof Ze?e:Ze.create(e),r=Array.from(Jt([],this.getStateNodes(n.value)));return new Ze(H(H({},n),{value:this.resolve(n.value),configuration:r,done:Pn(r,this),tags:Gi(r),machine:this.machine}))},t.prototype.transitionLeafNode=function(e,n,r){var i=this.getStateNode(e),o=i.next(n,r);return!o||!o.transitions.length?this.next(n,r):o},t.prototype.transitionCompoundNode=function(e,n,r){var i=Object.keys(e),o=this.getStateNode(i[0]),a=o._transition(e[i[0]],n,r);return!a||!a.transitions.length?this.next(n,r):a},t.prototype.transitionParallelNode=function(e,n,r){var i,o,a={};try{for(var s=de(Object.keys(e)),u=s.next();!u.done;u=s.next()){var c=u.value,f=e[c];if(!!f){var l=this.getStateNode(c),_=l._transition(f,n,r);_&&(a[c]=_)}}}catch(N){i={error:N}}finally{try{u&&!u.done&&(o=s.return)&&o.call(s)}finally{if(i)throw i.error}}var m=Object.keys(a).map(function(N){return a[N]}),E=Se(m.map(function(N){return N.transitions})),O=m.some(function(N){return N.transitions.length>0});if(!O)return this.next(n,r);var C=Se(Object.keys(a).map(function(N){return a[N].configuration}));return{transitions:E,exitSet:Se(m.map(function(N){return N.exitSet})),configuration:C,source:n,actions:Se(Object.keys(a).map(function(N){return a[N].actions}))}},t.prototype._transition=function(e,n,r){return ye(e)?this.transitionLeafNode(e,n,r):Object.keys(e).length===1?this.transitionCompoundNode(e,n,r):this.transitionParallelNode(e,n,r)},t.prototype.getTransitionData=function(e,n){return this._transition(e.value,e,Pe(n))},t.prototype.next=function(e,n){var r,i,o=this,a=n.name,s=[],u=[],c;try{for(var f=de(this.getCandidates(a)),l=f.next();!l.done;l=f.next()){var _=l.value,m=_.cond,E=_.in,O=e.context,C=E?ye(E)&&Ct(E)?e.matches(Xt(this.getStateNodeById(E).path,this.delimiter)):ui(Xt(E,this.delimiter),Vl(this.path.slice(0,-2))(e.value)):!0,N=!1;try{N=!m||Fs(this.machine,m,O,n,e)}catch(ee){throw new Error("Unable to evaluate guard '".concat(m.name||m.type,"' in transition for event '").concat(a,"' in state node '").concat(this.id,`':
`).concat(ee.message))}if(N&&C){_.target!==void 0&&(u=_.target),s.push.apply(s,me([],he(_.actions),!1)),c=_;break}}}catch(ee){r={error:ee}}finally{try{l&&!l.done&&(i=f.return)&&i.call(f)}finally{if(r)throw r.error}}if(!!c){if(!u.length)return{transitions:[c],exitSet:[],configuration:e.value?[this]:[],source:e,actions:s};var P=Se(u.map(function(ee){return o.getRelativeStateNodes(ee,e.historyValue)})),j=!!c.internal;return{transitions:[c],exitSet:j?[]:Se(u.map(function(ee){return o.getPotentiallyReenteringNodes(ee)})),configuration:P,source:e,actions:s}}},t.prototype.getPotentiallyReenteringNodes=function(e){if(this.order<e.order)return[this];for(var n=[],r=this,i=e;r&&r!==i;)n.push(r),r=r.parent;return r!==i?[]:(n.push(i),n)},t.prototype.getActions=function(e,n,r,i,o,a,s){var u,c,f,l,_=this,m=a?Jt([],this.getStateNodes(a.value)):[],E=new Set;try{for(var O=de(Array.from(e).sort(function(ne,ie){return ne.order-ie.order})),C=O.next();!C.done;C=O.next()){var N=C.value;(!Yt(m,N)||Yt(r.exitSet,N)||N.parent&&E.has(N.parent))&&E.add(N)}}catch(ne){u={error:ne}}finally{try{C&&!C.done&&(c=O.return)&&c.call(O)}finally{if(u)throw u.error}}try{for(var P=de(m),j=P.next();!j.done;j=P.next()){var N=j.value;(!Yt(e,N)||Yt(r.exitSet,N.parent))&&r.exitSet.push(N)}}catch(ne){f={error:ne}}finally{try{j&&!j.done&&(l=P.return)&&l.call(P)}finally{if(f)throw f.error}}r.exitSet.sort(function(ne,ie){return ie.order-ne.order});var ee=Array.from(E).sort(function(ne,ie){return ne.order-ie.order}),D=new Set(r.exitSet),Y=Se(ee.map(function(ne){var ie=[];if(ne.type!=="final")return ie;var S=ne.parent;if(!S.parent)return ie;ie.push(Sn(ne.id,ne.doneData),Sn(S.id,ne.doneData?Vn(ne.doneData,i,o):void 0));var z=S.parent;return z.type==="parallel"&&nn(z).every(function(M){return Pn(r.configuration,M)})&&ie.push(Sn(z.id)),ie})),J=ee.map(function(ne){var ie=ne.onEntry,S=ne.activities.map(function(z){return od(z)});return{type:"entry",actions:ht(s?me(me([],he(ie),!1),he(S),!1):me(me([],he(S),!1),he(ie),!1),_.machine.options.actions)}}).concat({type:"state_done",actions:Y.map(function(ne){return Zl(ne)})}),q=Array.from(D).map(function(ne){return{type:"exit",actions:ht(me(me([],he(ne.onExit),!1),he(ne.activities.map(function(ie){return ad(ie)})),!1),_.machine.options.actions)}}),Z=q.concat({type:"transition",actions:ht(r.actions,this.machine.options.actions)}).concat(J);if(n){var ae=ht(Se(me([],he(e),!1).sort(function(ne,ie){return ie.order-ne.order}).map(function(ne){return ne.onExit})),this.machine.options.actions).filter(function(ne){return!Tr(ne)});return Z.concat({type:"stop",actions:ae})}return Z},t.prototype.transition=function(e,n,r,i){e===void 0&&(e=this.initialState);var o=Pe(n),a;if(e instanceof Ze)a=r===void 0?e:this.resolveState(Ze.from(e,r));else{var s=ye(e)?this.resolve(zn(this.getResolvedPath(e))):this.resolve(e),u=r??this.machine.context;a=this.resolveState(Ze.from(s,u))}if(this.strict&&!this.events.includes(o.name)&&!Hl(o.name))throw new Error("Machine '".concat(this.id,"' does not accept event '").concat(o.name,"'"));var c=this._transition(a.value,a,o)||{transitions:[],configuration:[],exitSet:[],source:a,actions:[]},f=Jt([],this.getStateNodes(a.value)),l=c.configuration.length?Jt(f,c.configuration):f;return c.configuration=me([],he(l),!1),this.resolveTransition(c,a,a.context,i,o)},t.prototype.resolveRaisedTransition=function(e,n,r,i){var o,a=e.actions;return e=this.transition(e,n,void 0,i),e._event=r,e.event=r.data,(o=e.actions).unshift.apply(o,me([],he(a),!1)),e},t.prototype.resolveTransition=function(e,n,r,i,o){var a,s,u,c,f=this;o===void 0&&(o=Dt);var l=e.configuration,_=!n||e.transitions.length>0,m=_?e.configuration:n?n.configuration:[],E=Pn(m,this),O=_?gd(this.machine,l):void 0,C=n?n.historyValue?n.historyValue:e.source?this.machine.historyValue(n.value):void 0:void 0,N=this.getActions(new Set(m),E,e,r,o,n,i),P=n?H({},n.activities):{};try{for(var j=de(N),ee=j.next();!ee.done;ee=j.next()){var D=ee.value;try{for(var Y=(u=void 0,de(D.actions)),J=Y.next();!J.done;J=Y.next()){var q=J.value;q.type===Or?P[q.activity.id||q.activity.type]=q:q.type===si&&(P[q.activity.id||q.activity.type]=!1)}}catch($e){u={error:$e}}finally{try{J&&!J.done&&(c=Y.return)&&c.call(Y)}finally{if(u)throw u.error}}}}catch($e){a={error:$e}}finally{try{ee&&!ee.done&&(s=j.return)&&s.call(j)}finally{if(a)throw a.error}}var Z=he(Wn(this,n,r,o,N,i,this.machine.config.predictableActionArguments||this.machine.config.preserveActionOrder),2),ae=Z[0],ne=Z[1],ie=he(Jl(ae,Tr),2),S=ie[0],z=ie[1],M=ae.filter(function($e){var ct;return $e.type===Or&&((ct=$e.activity)===null||ct===void 0?void 0:ct.type)===kr}),F=M.reduce(function($e,ct){return $e[ct.activity.id]=ld(ct.activity,f.machine,ne,o),$e},n?H({},n.children):{}),R=new Ze({value:O||n.value,context:ne,_event:o,_sessionid:n?n._sessionid:null,historyValue:O?C?Yl(C,O):void 0:n?n.historyValue:void 0,history:!O||e.source?n:void 0,actions:O?z:[],activities:O?P:n?n.activities:{},events:[],configuration:m,transitions:e.transitions,children:F,done:E,tags:Gi(m),machine:this}),te=r!==ne;R.changed=o.name===js||te;var re=R.history;re&&delete re.history;var oe=!E&&(this._transient||l.some(function($e){return $e._transient}));if(!_&&(!oe||o.name===En))return R;var Q=R;if(!E)for(oe&&(Q=this.resolveRaisedTransition(Q,{type:Ml},o,i));S.length;){var se=S.shift();Q=this.resolveRaisedTransition(Q,se._event,o,i)}var St=Q.changed||(re?!!Q.actions.length||te||typeof re.value!=typeof Q.value||!Hs(Q.value,re.value):void 0);return Q.changed=St,Q.history=re,Q},t.prototype.getStateNode=function(e){if(Ct(e))return this.machine.getStateNodeById(e);if(!this.states)throw new Error("Unable to retrieve child state '".concat(e,"' from '").concat(this.id,"'; no child states exist."));var n=this.states[e];if(!n)throw new Error("Child state '".concat(e,"' does not exist on '").concat(this.id,"'"));return n},t.prototype.getStateNodeById=function(e){var n=Ct(e)?e.slice(Pr.length):e;if(n===this.id)return this;var r=this.machine.idMap[n];if(!r)throw new Error("Child state node '#".concat(n,"' does not exist on machine '").concat(this.id,"'"));return r},t.prototype.getStateNodeByPath=function(e){if(typeof e=="string"&&Ct(e))try{return this.getStateNodeById(e.slice(1))}catch{}for(var n=Ir(e,this.delimiter).slice(),r=this;n.length;){var i=n.shift();if(!i.length)break;r=r.getStateNode(i)}return r},t.prototype.resolve=function(e){var n,r=this;if(!e)return this.initialStateValue||At;switch(this.type){case"parallel":return Ht(this.initialStateValue,function(o,a){return o?r.getStateNode(a).resolve(e[a]||o):At});case"compound":if(ye(e)){var i=this.getStateNode(e);return i.type==="parallel"||i.type==="compound"?(n={},n[e]=i.initialStateValue,n):e}return Object.keys(e).length?Ht(e,function(o,a){return o?r.getStateNode(a).resolve(o):At}):this.initialStateValue||{};default:return e||At}},t.prototype.getResolvedPath=function(e){if(Ct(e)){var n=this.machine.idMap[e.slice(Pr.length)];if(!n)throw new Error("Unable to find state node '".concat(e,"'"));return n.path}return Ir(e,this.delimiter)},Object.defineProperty(t.prototype,"initialStateValue",{get:function(){var e;if(this.__cache.initialStateValue)return this.__cache.initialStateValue;var n;if(this.type==="parallel")n=Ji(this.states,function(r){return r.initialStateValue||At},function(r){return r.type!=="history"});else if(this.initial!==void 0){if(!this.states[this.initial])throw new Error("Initial state '".concat(this.initial,"' not found on '").concat(this.key,"'"));n=Hn(this.states[this.initial])?this.initial:(e={},e[this.initial]=this.states[this.initial].initialStateValue,e)}else n={};return this.__cache.initialStateValue=n,this.__cache.initialStateValue},enumerable:!1,configurable:!0}),t.prototype.getInitialState=function(e,n){this._init();var r=this.getStateNodes(e);return this.resolveTransition({configuration:r,exitSet:[],transitions:[],source:void 0,actions:[]},void 0,n??this.machine.context,void 0)},Object.defineProperty(t.prototype,"initialState",{get:function(){var e=this.initialStateValue;if(!e)throw new Error("Cannot retrieve initial state from simple state '".concat(this.id,"'."));return this.getInitialState(e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"target",{get:function(){var e;if(this.type==="history"){var n=this.config;ye(n.target)?e=Ct(n.target)?zn(this.machine.getStateNodeById(n.target).path.slice(this.path.length-1)):n.target:e=n.target}return e},enumerable:!1,configurable:!0}),t.prototype.getRelativeStateNodes=function(e,n,r){return r===void 0&&(r=!0),r?e.type==="history"?e.resolveHistory(n):e.initialStateNodes:[e]},Object.defineProperty(t.prototype,"initialStateNodes",{get:function(){var e=this;if(Hn(this))return[this];if(this.type==="compound"&&!this.initial)return[this];var n=Tn(this.initialStateValue);return Se(n.map(function(r){return e.getFromRelativePath(r)}))},enumerable:!1,configurable:!0}),t.prototype.getFromRelativePath=function(e){if(!e.length)return[this];var n=he(e),r=n[0],i=n.slice(1);if(!this.states)throw new Error("Cannot retrieve subPath '".concat(r,"' from node with no states"));var o=this.getStateNode(r);if(o.type==="history")return o.resolveHistory();if(!this.states[r])throw new Error("Child state '".concat(r,"' does not exist on '").concat(this.id,"'"));return this.states[r].getFromRelativePath(i)},t.prototype.historyValue=function(e){if(!!Object.keys(this.states).length)return{current:e||this.initialStateValue,states:Ji(this.states,function(n,r){if(!e)return n.historyValue();var i=ye(e)?void 0:e[r];return n.historyValue(i||n.initialStateValue)},function(n){return!n.history})}},t.prototype.resolveHistory=function(e){var n=this;if(this.type!=="history")return[this];var r=this.parent;if(!e){var i=this.target;return i?Se(Tn(i).map(function(a){return r.getFromRelativePath(a)})):r.initialStateNodes}var o=Wl(r.path,"states")(e).current;return ye(o)?[r.getStateNode(o)]:Se(Tn(o).map(function(a){return n.history==="deep"?r.getFromRelativePath(a):[r.states[a[0]]]}))},Object.defineProperty(t.prototype,"stateIds",{get:function(){var e=this,n=Se(Object.keys(this.states).map(function(r){return e.states[r].stateIds}));return[this.id].concat(n)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"events",{get:function(){var e,n,r,i;if(this.__cache.events)return this.__cache.events;var o=this.states,a=new Set(this.ownEvents);if(o)try{for(var s=de(Object.keys(o)),u=s.next();!u.done;u=s.next()){var c=u.value,f=o[c];if(f.states)try{for(var l=(r=void 0,de(f.events)),_=l.next();!_.done;_=l.next()){var m=_.value;a.add("".concat(m))}}catch(E){r={error:E}}finally{try{_&&!_.done&&(i=l.return)&&i.call(l)}finally{if(r)throw r.error}}}}catch(E){e={error:E}}finally{try{u&&!u.done&&(n=s.return)&&n.call(s)}finally{if(e)throw e.error}}return this.__cache.events=Array.from(a)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"ownEvents",{get:function(){var e=new Set(this.transitions.filter(function(n){return!(!n.target&&!n.actions.length&&n.internal)}).map(function(n){return n.eventType}));return Array.from(e)},enumerable:!1,configurable:!0}),t.prototype.resolveTarget=function(e){var n=this;if(e!==void 0)return e.map(function(r){if(!ye(r))return r;var i=r[0]===n.delimiter;if(i&&!n.parent)return n.getStateNodeByPath(r.slice(1));var o=i?n.key+r:r;if(n.parent)try{var a=n.parent.getStateNodeByPath(o);return a}catch(s){throw new Error("Invalid transition definition for state node '".concat(n.id,`':
`).concat(s.message))}else return n.getStateNodeByPath(o)})},t.prototype.formatTransition=function(e){var n=this,r=Xl(e.target),i="internal"in e?e.internal:r?r.some(function(u){return ye(u)&&u[0]===n.delimiter}):!0,o=this.machine.options.guards,a=this.resolveTarget(r),s=H(H({},e),{actions:ht(Je(e.actions)),cond:Ls(e.cond,o),target:a,source:this,internal:i,eventType:e.event,toJSON:function(){return H(H({},s),{target:s.target?s.target.map(function(u){return"#".concat(u.id)}):void 0,source:"#".concat(n.id)})}});return s},t.prototype.formatTransitions=function(){var e,n,r=this,i;if(!this.config.on)i=[];else if(Array.isArray(this.config.on))i=this.config.on;else{var o=this.config.on,a=_r,s=o[a],u=s===void 0?[]:s,c=ai(o,[typeof a=="symbol"?a:a+""]);i=Se(Object.keys(c).map(function(P){var j=Et(P,c[P]);return j}).concat(Et(_r,u)))}var f=this.config.always?Et("",this.config.always):[],l=this.config.onDone?Et(String(Sn(this.id)),this.config.onDone):[],_=Se(this.invoke.map(function(P){var j=[];return P.onDone&&j.push.apply(j,me([],he(Et(String(Dn(P.id)),P.onDone)),!1)),P.onError&&j.push.apply(j,me([],he(Et(String(Kt(P.id)),P.onError)),!1)),j})),m=this.after,E=Se(me(me(me(me([],he(l),!1),he(_),!1),he(i),!1),he(f),!1).map(function(P){return Je(P).map(function(j){return r.formatTransition(j)})}));try{for(var O=de(m),C=O.next();!C.done;C=O.next()){var N=C.value;E.push(N)}}catch(P){e={error:P}}finally{try{C&&!C.done&&(n=O.return)&&n.call(O)}finally{if(e)throw e.error}}return E},t}(),Xi=!1;function Id(t,e){return!Bl&&!("predictableActionArguments"in t)&&!Xi&&(Xi=!0,console.warn("It is highly recommended to set `predictableActionArguments` to `true` when using `createMachine`. https://xstate.js.org/docs/guides/actions.html")),new Rd(t,e)}var gr=cd,Js={},Ys={};(function(t){Object.defineProperty(t,"__esModule",{value:!0});t.__assign=function(){return t.__assign=Object.assign||function(a){for(var s,u=1,c=arguments.length;u<c;u++){s=arguments[u];for(var f in s)Object.prototype.hasOwnProperty.call(s,f)&&(a[f]=s[f])}return a},t.__assign.apply(this,arguments)};function e(o,a){var s={};for(var u in o)Object.prototype.hasOwnProperty.call(o,u)&&a.indexOf(u)<0&&(s[u]=o[u]);if(o!=null&&typeof Object.getOwnPropertySymbols=="function")for(var c=0,u=Object.getOwnPropertySymbols(o);c<u.length;c++)a.indexOf(u[c])<0&&Object.prototype.propertyIsEnumerable.call(o,u[c])&&(s[u[c]]=o[u[c]]);return s}function n(o){var a=typeof Symbol=="function"&&Symbol.iterator,s=a&&o[a],u=0;if(s)return s.call(o);if(o&&typeof o.length=="number")return{next:function(){return o&&u>=o.length&&(o=void 0),{value:o&&o[u++],done:!o}}};throw new TypeError(a?"Object is not iterable.":"Symbol.iterator is not defined.")}function r(o,a){var s=typeof Symbol=="function"&&o[Symbol.iterator];if(!s)return o;var u=s.call(o),c,f=[],l;try{for(;(a===void 0||a-- >0)&&!(c=u.next()).done;)f.push(c.value)}catch(_){l={error:_}}finally{try{c&&!c.done&&(s=u.return)&&s.call(u)}finally{if(l)throw l.error}}return f}function i(o,a,s){if(s||arguments.length===2)for(var u=0,c=a.length,f;u<c;u++)(f||!(u in a))&&(f||(f=Array.prototype.slice.call(a,0,u)),f[u]=a[u]);return o.concat(f||Array.prototype.slice.call(a))}t.__read=r,t.__rest=e,t.__spreadArray=i,t.__values=n})(Ys);Object.defineProperty(Js,"__esModule",{value:!0});var Zi=Ys,Td={timeout:1e4};function jd(t,e,n){var r=Zi.__assign(Zi.__assign({},Td),n);return new Promise(function(i,o){var a=!1,s=r.timeout===1/0?void 0:setTimeout(function(){c.unsubscribe(),o(new Error("Timeout of ".concat(r.timeout," ms exceeded")))},r.timeout),u=function(){clearTimeout(s),a=!0,c?.unsubscribe()},c=t.subscribe({next:function(f){e(f)&&(u(),i(f))},error:function(f){u(),o(f)},complete:function(){u(),o(new Error("Actor terminated without satisfying predicate"))}});a&&c.unsubscribe()})}var Dd=Js.waitFor=jd;const Pd=(t,e)=>t.length===e.length&&t.every((n,r)=>n===e[r]),Md=(t,e)=>{const n=en(t),r=en(e);return Pd(n,r)},Nd=(t=0)=>new Promise(e=>setTimeout(()=>e(),t)),Ld=async(t,e)=>{let n;const r=new Promise((i,o)=>{n=setTimeout(()=>o(new qs(`withTimeout: timed out after ${e}ms`)),e)});try{return await Promise.race([t,r])}finally{clearTimeout(n)}};class qs extends Error{constructor(e){super(e),this.name="TimeoutError"}}class Fd extends gt{documentId;#e;#t;#n;constructor(e,{isNew:n=!1,timeoutDelay:r=7e5}={}){super(),this.documentId=e,this.#n=r,this.#e=Ke(`automerge-repo:dochandle:${e.slice(0,5)}`);const i=wt({patchCallback:(o,{before:a,after:s})=>this.emit("patch",{handle:this,patches:o,before:a,after:s})});this.#t=Ks(Id({predictableActionArguments:!0,id:"docHandle",initial:Bd,context:{documentId:e,doc:i},states:{idle:{on:{CREATE:{target:pt},FIND:{target:eo},DELETE:{actions:"onDelete",target:Wt}}},loading:{on:{LOAD:{actions:"onLoad",target:pt},REQUEST:{target:to},DELETE:{actions:"onDelete",target:Wt}}},requesting:{on:{UPDATE:{actions:"onUpdate"},REQUEST_COMPLETE:{target:pt},DELETE:{actions:"onDelete",target:Wt}}},ready:{on:{UPDATE:{actions:"onUpdate",target:pt},DELETE:{actions:"onDelete",target:Wt}}},error:{},deleted:{}}},{actions:{onLoad:gr((o,{payload:a})=>{const{binary:s}=a,{doc:u}=o,c=qr(s,{unchecked:!0}),f=Qn(c);return{doc:cn(u,f)}}),onUpdate:gr((o,{payload:a})=>{const{doc:s}=o,{callback:u}=a,c=u(s);return!Md(c,s)&&(this.emit("change",{handle:this,doc:c}),this.isReady()||this.#t.send(Jd)),{doc:c}}),onDelete:gr(()=>(this.emit("delete",{handle:this}),{doc:void 0}))}})).onTransition(({value:o},{type:a})=>this.#e(`${a} \u2192 ${o}`,this.#r)).start(),this.#t.send(n?zd:Wd)}get doc(){if(!this.isReady())throw new Error(`DocHandle#${this.documentId} is not ready. Check \`handle.isReady()\` before accessing the document.`);return this.#r}get #r(){return this.#t?.getSnapshot().context.doc}get #i(){return this.#t?.getSnapshot().value}#o(e){return Array.isArray(e)||(e=[e]),Promise.any(e.map(n=>Dd(this.#t,r=>r.matches(n))))}isReady=()=>this.#i===pt;isDeleted=()=>this.#i===Wt;async value(e=[pt]){await Nd();try{await Ld(this.#o(e),this.#n)}catch(n){throw n instanceof qs?new Error(`DocHandle: timed out loading ${this.documentId}`):n}return this.#r}async loadAttemptedValue(){return this.value([pt,to])}load(e){e.length&&this.#t.send(Vd,{payload:{binary:e}})}update(e){this.#t.send(no,{payload:{callback:e}})}change(e,n={}){if(!this.isReady())throw new Error(`DocHandle#${this.documentId} is not ready. Check \`handle.isReady()\` before accessing the document.`);this.#t.send(no,{payload:{callback:r=>Gn(r,n,e)}})}request(){this.#i===eo&&this.#t.send(Hd)}delete(){this.#t.send(Kd)}}const Ud={IDLE:"idle",LOADING:"loading",REQUESTING:"requesting",READY:"ready",ERROR:"error",DELETED:"deleted"},$d={CREATE:"CREATE",LOAD:"LOAD",FIND:"FIND",REQUEST:"REQUEST",REQUEST_COMPLETE:"REQUEST_COMPLETE",UPDATE:"UPDATE",TIMEOUT:"TIMEOUT",DELETE:"DELETE"},{IDLE:Bd,LOADING:eo,REQUESTING:to,READY:pt,ERROR:Xh,DELETED:Wt}=Ud,{CREATE:zd,LOAD:Vd,FIND:Wd,REQUEST:Hd,UPDATE:no,TIMEOUT:Zh,DELETE:Kd,REQUEST_COMPLETE:Jd}=$d;class Yd extends gt{#e={};sharePolicy=async()=>!0;constructor(){super()}#t(e,n){if(this.#e[e])return this.#e[e];const r=new Fd(e,{isNew:n});return this.#e[e]=r,r}get handles(){return this.#e}create(){const e=du(),n=this.#t(e,!0);return this.emit("document",{handle:n}),n}find(e){if(this.#e[e])return this.#e[e];const n=this.#t(e,!1);return this.emit("document",{handle:n}),n}delete(e){this.#t(e,!1).delete(),delete this.#e[e],this.emit("delete-document",{documentId:e})}}class Gs extends gt{peerId}class qd extends gt{adapters;peerId;#e;#t={};#n;constructor(e,n=Gd()){super(),this.adapters=e,this.peerId=n,this.#e=Ke(`automerge-repo:network:${this.peerId}`),this.#n=[],this.adapters.forEach(r=>this.addNetworkAdapter(r))}addNetworkAdapter(e){e.connect(this.peerId),e.on("peer-candidate",({peerId:n,channelId:r})=>{this.#e(`peer candidate: ${n} `),this.#t[n]||(this.#t[n]=e),this.emit("peer",{peerId:n,channelId:r})}),e.on("peer-disconnected",({peerId:n})=>{this.#e(`peer disconnected: ${n} `),delete this.#t[n],this.emit("peer-disconnected",{peerId:n})}),e.on("message",n=>{const{senderId:r,channelId:i,broadcast:o,message:a}=n;this.#e(`message from ${r}`),o&&Object.entries(this.#t).filter(([s])=>s!==r).forEach(([s,u])=>{u.sendMessage(s,i,a,o)}),this.emit("message",n)}),e.on("close",()=>{this.#e("adapter closed"),Object.entries(this.#t).forEach(([n,r])=>{r===e&&delete this.#t[n]})}),this.#n.forEach(n=>e.join(n))}sendMessage(e,n,r,i){if(i)Object.entries(this.#t).forEach(([o,a])=>{this.#e(`sending broadcast to ${o}`),a.sendMessage(o,n,r,!0)});else{const o=this.#t[e];if(!o){this.#e(`Tried to send message but peer not found: ${e}`);return}this.#e(`Sending message to ${e}`),o.sendMessage(e,n,r,!1)}}join(e){this.#e(`Joining channel ${e}`),this.#n.push(e),this.adapters.forEach(n=>n.join(e))}leave(e){this.#e(`Leaving channel ${e}`),this.#n=this.#n.filter(n=>n!==e),this.adapters.forEach(n=>n.leave(e))}}function Gd(){return`user-${Math.round(Math.random()*1e5)}`}let Mr;try{Mr=new TextDecoder}catch{}let G,vt,I=0;const Qd=105,Xd=57342,Zd=57343,ro=57337,io=6,Ot={};let le={},xe,Kn,Jn=0,rn=0,Re,Ye,Oe=[],Nr=[],Ue,Ne,qt,oo={useRecords:!1,mapsAsObjects:!0},on=!1,Qs=2;try{new Function("")}catch{Qs=1/0}class an{constructor(e){if(e&&((e.keyMap||e._keyMap)&&!e.useRecords&&(e.useRecords=!1,e.mapsAsObjects=!0),e.useRecords===!1&&e.mapsAsObjects===void 0&&(e.mapsAsObjects=!0),e.getStructures&&(e.getShared=e.getStructures),e.getShared&&!e.structures&&((e.structures=[]).uninitialized=!0),e.keyMap)){this.mapKey=new Map;for(let[n,r]of Object.entries(e.keyMap))this.mapKey.set(r,n)}Object.assign(this,e)}decodeKey(e){return this.keyMap&&this.mapKey.get(e)||e}encodeKey(e){return this.keyMap&&this.keyMap.hasOwnProperty(e)?this.keyMap[e]:e}encodeKeys(e){if(!this._keyMap)return e;let n=new Map;for(let[r,i]of Object.entries(e))n.set(this._keyMap.hasOwnProperty(r)?this._keyMap[r]:r,i);return n}decodeKeys(e){if(!this._keyMap||e.constructor.name!="Map")return e;if(!this._mapKey){this._mapKey=new Map;for(let[r,i]of Object.entries(this._keyMap))this._mapKey.set(i,r)}let n={};return e.forEach((r,i)=>n[We(this._mapKey.has(i)?this._mapKey.get(i):i)]=r),n}mapDecode(e,n){let r=this.decode(e);if(this._keyMap)switch(r.constructor.name){case"Array":return r.map(i=>this.decodeKeys(i))}return r}decode(e,n){if(G)return tc(()=>($r(),this?this.decode(e,n):an.prototype.decode.call(oo,e,n)));vt=n>-1?n:e.length,I=0,rn=0,Kn=null,Re=null,G=e;try{Ne=e.dataView||(e.dataView=new DataView(e.buffer,e.byteOffset,e.byteLength))}catch(r){throw G=null,e instanceof Uint8Array?r:new Error("Source must be a Uint8Array or Buffer but was a "+(e&&typeof e=="object"?e.constructor.name:typeof e))}if(this instanceof an){if(le=this,Ue=this.sharedValues&&(this.pack?new Array(this.maxPrivatePackedValues||16).concat(this.sharedValues):this.sharedValues),this.structures)return xe=this.structures,An();(!xe||xe.length>0)&&(xe=[])}else le=oo,(!xe||xe.length>0)&&(xe=[]),Ue=null;return An()}decodeMultiple(e,n){let r,i=0;try{let o=e.length;on=!0;let a=this?this.decode(e,o):_i.decode(e,o);if(n){if(n(a)===!1)return;for(;I<o;)if(i=I,n(An())===!1)return}else{for(r=[a];I<o;)i=I,r.push(An());return r}}catch(o){throw o.lastPosition=i,o.values=r,o}finally{on=!1,$r()}}}function An(){try{let t=fe();if(Re){if(I>=Re.postBundlePosition){let e=new Error("Unexpected bundle position");throw e.incomplete=!0,e}I=Re.postBundlePosition,Re=null}if(I==vt)xe=null,G=null,Ye&&(Ye=null);else if(I>vt){let e=new Error("Unexpected end of CBOR data");throw e.incomplete=!0,e}else if(!on)throw new Error("Data read, but end of buffer not reached");return t}catch(t){throw $r(),(t instanceof RangeError||t.message.startsWith("Unexpected end of buffer"))&&(t.incomplete=!0),t}}function fe(){let t=G[I++],e=t>>5;if(t=t&31,t>23)switch(t){case 24:t=G[I++];break;case 25:if(e==7)return rh();t=Ne.getUint16(I),I+=2;break;case 26:if(e==7){let n=Ne.getFloat32(I);if(le.useFloat32>2){let r=hi[(G[I]&127)<<1|G[I+1]>>7];return I+=4,(r*n+(n>0?.5:-.5)>>0)/r}return I+=4,n}t=Ne.getUint32(I),I+=4;break;case 27:if(e==7){let n=Ne.getFloat64(I);return I+=8,n}if(e>1){if(Ne.getUint32(I)>0)throw new Error("JavaScript does not support arrays, maps, or strings with length over 4294967295");t=Ne.getUint32(I+4)}else le.int64AsNumber?(t=Ne.getUint32(I)*4294967296,t+=Ne.getUint32(I+4)):t=Ne.getBigUint64(I);I+=8;break;case 31:switch(e){case 2:case 3:throw new Error("Indefinite length not supported for byte or text strings");case 4:let n=[],r,i=0;for(;(r=fe())!=Ot;)n[i++]=r;return e==4?n:e==3?n.join(""):Buffer.concat(n);case 5:let o;if(le.mapsAsObjects){let a={};if(le.keyMap)for(;(o=fe())!=Ot;)a[We(le.decodeKey(o))]=fe();else for(;(o=fe())!=Ot;)a[We(o)]=fe();return a}else{qt&&(le.mapsAsObjects=!0,qt=!1);let a=new Map;if(le.keyMap)for(;(o=fe())!=Ot;)a.set(le.decodeKey(o),fe());else for(;(o=fe())!=Ot;)a.set(o,fe());return a}case 7:return Ot;default:throw new Error("Invalid major type for indefinite length "+e)}default:throw new Error("Unknown token "+t)}switch(e){case 0:return t;case 1:return~t;case 2:return nh(t);case 3:if(rn>=I)return Kn.slice(I-Jn,(I+=t)-Jn);if(rn==0&&vt<140&&t<32){let i=t<16?Xs(t):th(t);if(i!=null)return i}return eh(t);case 4:let n=new Array(t);for(let i=0;i<t;i++)n[i]=fe();return n;case 5:if(le.mapsAsObjects){let i={};if(le.keyMap)for(let o=0;o<t;o++)i[We(le.decodeKey(fe()))]=fe();else for(let o=0;o<t;o++)i[We(fe())]=fe();return i}else{qt&&(le.mapsAsObjects=!0,qt=!1);let i=new Map;if(le.keyMap)for(let o=0;o<t;o++)i.set(le.decodeKey(fe()),fe());else for(let o=0;o<t;o++)i.set(fe(),fe());return i}case 6:if(t>=ro){let i=xe[t&8191];if(i)return i.read||(i.read=Lr(i)),i.read();if(t<65536){if(t==Zd){let o=jt(),a=fe(),s=fe();Ur(a,s);let u={};if(le.keyMap)for(let c=2;c<o;c++){let f=le.decodeKey(s[c-2]);u[We(f)]=fe()}else for(let c=2;c<o;c++){let f=s[c-2];u[We(f)]=fe()}return u}else if(t==Xd){let o=jt(),a=fe();for(let s=2;s<o;s++)Ur(a++,fe());return fe()}else if(t==ro)return uh();if(le.getShared&&(di(),i=xe[t&8191],i))return i.read||(i.read=Lr(i)),i.read()}}let r=Oe[t];if(r)return r.handlesRead?r(fe):r(fe());{let i=fe();for(let o=0;o<Nr.length;o++){let a=Nr[o](t,i);if(a!==void 0)return a}return new bt(i,t)}case 7:switch(t){case 20:return!1;case 21:return!0;case 22:return null;case 23:return;case 31:default:let i=(Ue||yt())[t];if(i!==void 0)return i;throw new Error("Unknown token "+t)}default:if(isNaN(t)){let i=new Error("Unexpected end of CBOR data");throw i.incomplete=!0,i}throw new Error("Unknown CBOR token "+t)}}const ao=/^[a-zA-Z_$][a-zA-Z\d_$]*$/;function Lr(t){function e(){let n=G[I++];if(n=n&31,n>23)switch(n){case 24:n=G[I++];break;case 25:n=Ne.getUint16(I),I+=2;break;case 26:n=Ne.getUint32(I),I+=4;break;default:throw new Error("Expected array header, but got "+G[I-1])}let r=this.compiledReader;for(;r;){if(r.propertyCount===n)return r(fe);r=r.next}if(this.slowReads++>=Qs){let o=this.length==n?this:this.slice(0,n);return r=le.keyMap?new Function("r","return {"+o.map(a=>le.decodeKey(a)).map(a=>ao.test(a)?We(a)+":r()":"["+JSON.stringify(a)+"]:r()").join(",")+"}"):new Function("r","return {"+o.map(a=>ao.test(a)?We(a)+":r()":"["+JSON.stringify(a)+"]:r()").join(",")+"}"),this.compiledReader&&(r.next=this.compiledReader),r.propertyCount=n,this.compiledReader=r,r(fe)}let i={};if(le.keyMap)for(let o=0;o<n;o++)i[We(le.decodeKey(this[o]))]=fe();else for(let o=0;o<n;o++)i[We(this[o])]=fe();return i}return t.slowReads=0,e}function We(t){return t==="__proto__"?"__proto_":t}let eh=Fr;function Fr(t){let e;if(t<16&&(e=Xs(t)))return e;if(t>64&&Mr)return Mr.decode(G.subarray(I,I+=t));const n=I+t,r=[];for(e="";I<n;){const i=G[I++];if((i&128)===0)r.push(i);else if((i&224)===192){const o=G[I++]&63;r.push((i&31)<<6|o)}else if((i&240)===224){const o=G[I++]&63,a=G[I++]&63;r.push((i&31)<<12|o<<6|a)}else if((i&248)===240){const o=G[I++]&63,a=G[I++]&63,s=G[I++]&63;let u=(i&7)<<18|o<<12|a<<6|s;u>65535&&(u-=65536,r.push(u>>>10&1023|55296),u=56320|u&1023),r.push(u)}else r.push(i);r.length>=4096&&(e+=Te.apply(String,r),r.length=0)}return r.length>0&&(e+=Te.apply(String,r)),e}let Te=String.fromCharCode;function th(t){let e=I,n=new Array(t);for(let r=0;r<t;r++){const i=G[I++];if((i&128)>0){I=e;return}n[r]=i}return Te.apply(String,n)}function Xs(t){if(t<4)if(t<2){if(t===0)return"";{let e=G[I++];if((e&128)>1){I-=1;return}return Te(e)}}else{let e=G[I++],n=G[I++];if((e&128)>0||(n&128)>0){I-=2;return}if(t<3)return Te(e,n);let r=G[I++];if((r&128)>0){I-=3;return}return Te(e,n,r)}else{let e=G[I++],n=G[I++],r=G[I++],i=G[I++];if((e&128)>0||(n&128)>0||(r&128)>0||(i&128)>0){I-=4;return}if(t<6){if(t===4)return Te(e,n,r,i);{let o=G[I++];if((o&128)>0){I-=5;return}return Te(e,n,r,i,o)}}else if(t<8){let o=G[I++],a=G[I++];if((o&128)>0||(a&128)>0){I-=6;return}if(t<7)return Te(e,n,r,i,o,a);let s=G[I++];if((s&128)>0){I-=7;return}return Te(e,n,r,i,o,a,s)}else{let o=G[I++],a=G[I++],s=G[I++],u=G[I++];if((o&128)>0||(a&128)>0||(s&128)>0||(u&128)>0){I-=8;return}if(t<10){if(t===8)return Te(e,n,r,i,o,a,s,u);{let c=G[I++];if((c&128)>0){I-=9;return}return Te(e,n,r,i,o,a,s,u,c)}}else if(t<12){let c=G[I++],f=G[I++];if((c&128)>0||(f&128)>0){I-=10;return}if(t<11)return Te(e,n,r,i,o,a,s,u,c,f);let l=G[I++];if((l&128)>0){I-=11;return}return Te(e,n,r,i,o,a,s,u,c,f,l)}else{let c=G[I++],f=G[I++],l=G[I++],_=G[I++];if((c&128)>0||(f&128)>0||(l&128)>0||(_&128)>0){I-=12;return}if(t<14){if(t===12)return Te(e,n,r,i,o,a,s,u,c,f,l,_);{let m=G[I++];if((m&128)>0){I-=13;return}return Te(e,n,r,i,o,a,s,u,c,f,l,_,m)}}else{let m=G[I++],E=G[I++];if((m&128)>0||(E&128)>0){I-=14;return}if(t<15)return Te(e,n,r,i,o,a,s,u,c,f,l,_,m,E);let O=G[I++];if((O&128)>0){I-=15;return}return Te(e,n,r,i,o,a,s,u,c,f,l,_,m,E,O)}}}}}function nh(t){return le.copyBuffers?Uint8Array.prototype.slice.call(G,I,I+=t):G.subarray(I,I+=t)}let Zs=new Float32Array(1),Cn=new Uint8Array(Zs.buffer,0,4);function rh(){let t=G[I++],e=G[I++],n=(t&127)>>2;if(n===31)return e||t&3?NaN:t&128?-1/0:1/0;if(n===0){let r=((t&3)<<8|e)/16777216;return t&128?-r:r}return Cn[3]=t&128|(n>>1)+56,Cn[2]=(t&7)<<5|e>>3,Cn[1]=e<<5,Cn[0]=0,Zs[0]}new Array(4096);class bt{constructor(e,n){this.value=e,this.tag=n}}Oe[0]=t=>new Date(t);Oe[1]=t=>new Date(Math.round(t*1e3));Oe[2]=t=>{let e=BigInt(0);for(let n=0,r=t.byteLength;n<r;n++)e=BigInt(t[n])+e<<BigInt(8);return e};Oe[3]=t=>BigInt(-1)-Oe[2](t);Oe[4]=t=>+(t[1]+"e"+t[0]);Oe[5]=t=>t[1]*Math.exp(t[0]*Math.log(2));const Ur=(t,e)=>{t=t-57344;let n=xe[t];n&&n.isShared&&((xe.restoreStructures||(xe.restoreStructures=[]))[t]=n),xe[t]=e,e.read=Lr(e)};Oe[Qd]=t=>{let e=t.length,n=t[1];Ur(t[0],n);let r={};for(let i=2;i<e;i++){let o=n[i-2];r[We(o)]=t[i]}return r};Oe[14]=t=>Re?Re[0].slice(Re.position0,Re.position0+=t):new bt(t,14);Oe[15]=t=>Re?Re[1].slice(Re.position1,Re.position1+=t):new bt(t,15);let ih={Error,RegExp};Oe[27]=t=>(ih[t[0]]||Error)(t[1],t[2]);const ec=t=>{if(G[I++]!=132)throw new Error("Packed values structure must be followed by a 4 element array");let e=t();return Ue=Ue?e.concat(Ue.slice(e.length)):e,Ue.prefixes=t(),Ue.suffixes=t(),t()};ec.handlesRead=!0;Oe[51]=ec;Oe[io]=t=>{if(!Ue)if(le.getShared)di();else return new bt(t,io);if(typeof t=="number")return Ue[16+(t>=0?2*t:-2*t-1)];throw new Error("No support for non-integer packed references yet")};Oe[28]=t=>{Ye||(Ye=new Map,Ye.id=0);let e=Ye.id++,n=G[I],r;n>>5==4?r=[]:r={};let i={target:r};Ye.set(e,i);let o=t();return i.used?Object.assign(r,o):(i.target=o,o)};Oe[28].handlesRead=!0;Oe[29]=t=>{let e=Ye.get(t);return e.used=!0,e.target};Oe[258]=t=>new Set(t);(Oe[259]=t=>(le.mapsAsObjects&&(le.mapsAsObjects=!1,qt=!0),t())).handlesRead=!0;function kt(t,e){return typeof t=="string"?t+e:t instanceof Array?t.concat(e):Object.assign({},t,e)}function yt(){if(!Ue)if(le.getShared)di();else throw new Error("No packed values available");return Ue}const oh=1399353956;Nr.push((t,e)=>{if(t>=225&&t<=255)return kt(yt().prefixes[t-224],e);if(t>=28704&&t<=32767)return kt(yt().prefixes[t-28672],e);if(t>=1879052288&&t<=2147483647)return kt(yt().prefixes[t-1879048192],e);if(t>=216&&t<=223)return kt(e,yt().suffixes[t-216]);if(t>=27647&&t<=28671)return kt(e,yt().suffixes[t-27639]);if(t>=1811940352&&t<=1879048191)return kt(e,yt().suffixes[t-1811939328]);if(t==oh)return{packedValues:Ue,structures:xe.slice(0),version:e};if(t==55799)return e});const ah=new Uint8Array(new Uint16Array([1]).buffer)[0]==1,so=[Uint8Array,Uint8ClampedArray,Uint16Array,Uint32Array,typeof BigUint64Array>"u"?{name:"BigUint64Array"}:BigUint64Array,Int8Array,Int16Array,Int32Array,typeof BigInt64Array>"u"?{name:"BigInt64Array"}:BigInt64Array,Float32Array,Float64Array],sh=[64,68,69,70,71,72,77,78,79,85,86];for(let t=0;t<so.length;t++)ch(so[t],sh[t]);function ch(t,e){let n="get"+t.name.slice(0,-5),r;typeof t=="function"?r=t.BYTES_PER_ELEMENT:t=null;for(let i=0;i<2;i++){if(!i&&r==1)continue;let o=r==2?1:r==4?2:3;Oe[i?e:e-4]=r==1||i==ah?a=>{if(!t)throw new Error("Could not find typed array for code "+e);return new t(Uint8Array.prototype.slice.call(a,0).buffer)}:a=>{if(!t)throw new Error("Could not find typed array for code "+e);let s=new DataView(a.buffer,a.byteOffset,a.byteLength),u=a.length>>o,c=new t(u),f=s[n];for(let l=0;l<u;l++)c[l]=f.call(s,l<<o,i);return c}}}function uh(){let t=jt(),e=I+fe();for(let r=2;r<t;r++){let i=jt();I+=i}let n=I;return I=e,Re=[Fr(jt()),Fr(jt())],Re.position0=0,Re.position1=0,Re.postBundlePosition=I,I=n,fe()}function jt(){let t=G[I++]&31;if(t>23)switch(t){case 24:t=G[I++];break;case 25:t=Ne.getUint16(I),I+=2;break;case 26:t=Ne.getUint32(I),I+=4;break}return t}function di(){if(le.getShared){let t=tc(()=>(G=null,le.getShared()))||{},e=t.structures||[];le.sharedVersion=t.version,Ue=le.sharedValues=t.packedValues,xe===!0?le.structures=xe=e:xe.splice.apply(xe,[0,e.length].concat(e))}}function tc(t){let e=vt,n=I,r=Jn,i=rn,o=Kn,a=Ye,s=Re,u=new Uint8Array(G.slice(0,vt)),c=xe,f=le,l=on,_=t();return vt=e,I=n,Jn=r,rn=i,Kn=o,Ye=a,Re=s,G=u,on=l,xe=c,le=f,Ne=new DataView(G.buffer,G.byteOffset,G.byteLength),_}function $r(){G=null,Ye=null,xe=null}const hi=new Array(147);for(let t=0;t<256;t++)hi[t]=+("1e"+Math.floor(45.15-t*.30103));let _i=new an({useRecords:!1});const nc=_i.decode;_i.decodeMultiple;let Mn;try{Mn=new TextEncoder}catch{}let Br,rc;const tr=typeof globalThis=="object"&&globalThis.Buffer,fn=typeof tr<"u",pr=fn?tr.allocUnsafeSlow:Uint8Array,co=fn?tr:Uint8Array,uo=256,fo=fn?4294967296:2144337920;let yr,x,we,p=0,lt,ke=null;const fh=61440,lh=/[\u0080-\uFFFF]/,Be=Symbol("record-id");class dh extends an{constructor(e){super(e),this.offset=0;let n,r,i,o,a;e=e||{};let s=co.prototype.utf8Write?function(S,z,M){return x.utf8Write(S,z,M)}:Mn&&Mn.encodeInto?function(S,z){return Mn.encodeInto(S,x.subarray(z)).written}:!1,u=this,c=e.structures||e.saveStructures,f=e.maxSharedStructures;if(f==null&&(f=c?128:0),f>8190)throw new Error("Maximum maxSharedStructure is 8190");let l=e.sequential;l&&(f=0),this.structures||(this.structures=[]),this.saveStructures&&(this.saveShared=this.saveStructures);let _,m,E=e.sharedValues,O;if(E){O=Object.create(null);for(let S=0,z=E.length;S<z;S++)O[E[S]]=S}let C=[],N=0,P=0;this.mapEncode=function(S,z){if(this._keyMap&&!this._mapped)switch(S.constructor.name){case"Array":S=S.map(M=>this.encodeKeys(M));break}return this.encode(S,z)},this.encode=function(S,z){if(x||(x=new pr(8192),we=new DataView(x.buffer,0,8192),p=0),lt=x.length-10,lt-p<2048?(x=new pr(x.length),we=new DataView(x.buffer,0,x.length),lt=x.length-10,p=0):z===go&&(p=p+7&2147483640),n=p,u.useSelfDescribedHeader&&(we.setUint32(p,3654940416),p+=3),a=u.structuredClone?new Map:null,u.bundleStrings&&typeof S!="string"?(ke=[],ke.size=1/0):ke=null,r=u.structures,r){if(r.uninitialized){let F=u.getShared()||{};u.structures=r=F.structures||[],u.sharedVersion=F.version;let R=u.sharedValues=F.packedValues;if(R){O={};for(let te=0,re=R.length;te<re;te++)O[R[te]]=te}}let M=r.length;if(M>f&&!l&&(M=f),!r.transitions){r.transitions=Object.create(null);for(let F=0;F<M;F++){let R=r[F];if(!R)continue;let te,re=r.transitions;for(let oe=0,Q=R.length;oe<Q;oe++){re[Be]===void 0&&(re[Be]=F);let se=R[oe];te=re[se],te||(te=re[se]=Object.create(null)),re=te}re[Be]=F|1048576}}l||(r.nextId=M)}if(i&&(i=!1),o=r||[],m=O,e.pack){let M=new Map;if(M.values=[],M.encoder=u,M.maxValues=e.maxPrivatePackedValues||(O?16:1/0),M.objectMap=O||!1,M.samplingPackedValues=_,Nn(S,M),M.values.length>0){x[p++]=216,x[p++]=51,et(4);let F=M.values;j(F),et(0),et(0),m=Object.create(O||null);for(let R=0,te=F.length;R<te;R++)m[F[R]]=R}}yr=z&br;try{if(yr)return;if(j(S),ke&&_o(n,j),u.offset=p,a&&a.idsToInsert){p+=a.idsToInsert.length*2,p>lt&&D(p),u.offset=p;let M=gh(x.subarray(n,p),a.idsToInsert);return a=null,M}return z&go?(x.start=n,x.end=p,x):x.subarray(n,p)}finally{if(r){if(P<10&&P++,r.length>f&&(r.length=f),N>1e4)r.transitions=null,P=0,N=0,C.length>0&&(C=[]);else if(C.length>0&&!l){for(let M=0,F=C.length;M<F;M++)C[M][Be]=void 0;C=[]}}if(i&&u.saveShared){u.structures.length>f&&(u.structures=u.structures.slice(0,f));let M=x.subarray(n,p);return u.updateSharedData()===!1?u.encode(S):M}z&ph&&(p=n)}},this.findCommonStringsToPack=()=>(_=new Map,O||(O=Object.create(null)),S=>{let z=S&&S.threshold||4,M=this.pack?S.maxPrivatePackedValues||16:0;E||(E=this.sharedValues=[]);for(let[F,R]of _)R.count>z&&(O[F]=M++,E.push(F),i=!0);for(;this.saveShared&&this.updateSharedData()===!1;);_=null});const j=S=>{p>lt&&(x=D(p));var z=typeof S,M;if(z==="string"){if(m){let re=m[S];if(re>=0){re<16?x[p++]=re+224:(x[p++]=198,re&1?j(15-re>>1):j(re-16>>1));return}else if(_&&!e.pack){let oe=_.get(S);oe?oe.count++:_.set(S,{count:1})}}let F=S.length;if(ke&&F>=4&&F<1024){if((ke.size+=F)>fh){let oe,Q=(ke[0]?ke[0].length*3+ke[1].length:0)+10;p+Q>lt&&(x=D(p+Q)),x[p++]=217,x[p++]=223,x[p++]=249,x[p++]=ke.position?132:130,x[p++]=26,oe=p-n,p+=4,ke.position&&_o(n,j),ke=["",""],ke.size=0,ke.position=oe}let re=lh.test(S);ke[re?0:1]+=S,x[p++]=re?206:207,j(F);return}let R;F<32?R=1:F<256?R=2:F<65536?R=3:R=5;let te=F*3;if(p+te>lt&&(x=D(p+te)),F<64||!s){let re,oe,Q,se=p+R;for(re=0;re<F;re++)oe=S.charCodeAt(re),oe<128?x[se++]=oe:oe<2048?(x[se++]=oe>>6|192,x[se++]=oe&63|128):(oe&64512)===55296&&((Q=S.charCodeAt(re+1))&64512)===56320?(oe=65536+((oe&1023)<<10)+(Q&1023),re++,x[se++]=oe>>18|240,x[se++]=oe>>12&63|128,x[se++]=oe>>6&63|128,x[se++]=oe&63|128):(x[se++]=oe>>12|224,x[se++]=oe>>6&63|128,x[se++]=oe&63|128);M=se-p-R}else M=s(S,p+R,te);M<24?x[p++]=96|M:M<256?(R<2&&x.copyWithin(p+2,p+1,p+1+M),x[p++]=120,x[p++]=M):M<65536?(R<3&&x.copyWithin(p+3,p+2,p+2+M),x[p++]=121,x[p++]=M>>8,x[p++]=M&255):(R<5&&x.copyWithin(p+5,p+3,p+3+M),x[p++]=122,we.setUint32(p,M),p+=4),p+=M}else if(z==="number")if(!this.alwaysUseFloat&&S>>>0===S)S<24?x[p++]=S:S<256?(x[p++]=24,x[p++]=S):S<65536?(x[p++]=25,x[p++]=S>>8,x[p++]=S&255):(x[p++]=26,we.setUint32(p,S),p+=4);else if(!this.alwaysUseFloat&&S>>0===S)S>=-24?x[p++]=31-S:S>=-256?(x[p++]=56,x[p++]=~S):S>=-65536?(x[p++]=57,we.setUint16(p,~S),p+=2):(x[p++]=58,we.setUint32(p,~S),p+=4);else{let F;if((F=this.useFloat32)>0&&S<4294967296&&S>=-2147483648){x[p++]=250,we.setFloat32(p,S);let R;if(F<4||(R=S*hi[(x[p]&127)<<1|x[p+1]>>7])>>0===R){p+=4;return}else p--}x[p++]=251,we.setFloat64(p,S),p+=8}else if(z==="object")if(!S)x[p++]=246;else{if(a){let R=a.get(S);if(R){if(x[p++]=216,x[p++]=29,x[p++]=25,!R.references){let te=a.idsToInsert||(a.idsToInsert=[]);R.references=[],te.push(R)}R.references.push(p-n),p+=2;return}else a.set(S,{offset:p-n})}let F=S.constructor;if(F===Object)ee(S,!0);else if(F===Array){M=S.length,M<24?x[p++]=128|M:et(M);for(let R=0;R<M;R++)j(S[R])}else if(F===Map)if((this.mapsAsObjects?this.useTag259ForMaps!==!1:this.useTag259ForMaps)&&(x[p++]=217,x[p++]=1,x[p++]=3),M=S.size,M<24?x[p++]=160|M:M<256?(x[p++]=184,x[p++]=M):M<65536?(x[p++]=185,x[p++]=M>>8,x[p++]=M&255):(x[p++]=186,we.setUint32(p,M),p+=4),u.keyMap)for(let[R,te]of S)j(u.encodeKey(R)),j(te);else for(let[R,te]of S)j(R),j(te);else{for(let R=0,te=Br.length;R<te;R++){let re=rc[R];if(S instanceof re){let oe=Br[R],Q=oe.tag;Q==null&&(Q=oe.getTag&&oe.getTag.call(this,S)),Q<24?x[p++]=192|Q:Q<256?(x[p++]=216,x[p++]=Q):Q<65536?(x[p++]=217,x[p++]=Q>>8,x[p++]=Q&255):Q>-1&&(x[p++]=218,we.setUint32(p,Q),p+=4),oe.encode.call(this,S,j,D);return}}if(S[Symbol.iterator]){if(yr){let R=new Error("Iterable should be serialized as iterator");throw R.iteratorNotHandled=!0,R}x[p++]=159;for(let R of S)j(R);x[p++]=255;return}if(S[Symbol.asyncIterator]||vr(S)){let R=new Error("Iterable/blob should be serialized as iterator");throw R.iteratorNotHandled=!0,R}ee(S,!S.hasOwnProperty)}}else if(z==="boolean")x[p++]=S?245:244;else if(z==="bigint"){if(S<BigInt(1)<<BigInt(64)&&S>=0)x[p++]=27,we.setBigUint64(p,S);else if(S>-(BigInt(1)<<BigInt(64))&&S<0)x[p++]=59,we.setBigUint64(p,-S-BigInt(1));else if(this.largeBigIntToFloat)x[p++]=251,we.setFloat64(p,Number(S));else throw new RangeError(S+" was too large to fit in CBOR 64-bit integer format, set largeBigIntToFloat to convert to float-64");p+=8}else if(z==="undefined")x[p++]=247;else throw new Error("Unknown type: "+z)},ee=this.useRecords===!1?this.variableMapSize?S=>{let z=Object.keys(S),M=Object.values(S),F=z.length;if(F<24?x[p++]=160|F:F<256?(x[p++]=184,x[p++]=F):F<65536?(x[p++]=185,x[p++]=F>>8,x[p++]=F&255):(x[p++]=186,we.setUint32(p,F),p+=4),u.keyMap)for(let R=0;R<F;R++)j(encodeKey(z[R])),j(M[R]);else for(let R=0;R<F;R++)j(z[R]),j(M[R])}:(S,z)=>{x[p++]=185;let M=p-n;p+=2;let F=0;if(u.keyMap)for(let R in S)(z||S.hasOwnProperty(R))&&(j(u.encodeKey(R)),j(S[R]),F++);else for(let R in S)(z||S.hasOwnProperty(R))&&(j(R),j(S[R]),F++);x[M+++n]=F>>8,x[M+n]=F&255}:(S,z)=>{let M,F=o.transitions||(o.transitions=Object.create(null)),R=0,te=0,re,oe;if(this.keyMap){oe=Object.keys(S).map(se=>this.encodeKey(se)),te=oe.length;for(let se=0;se<te;se++){let St=oe[se];M=F[St],M||(M=F[St]=Object.create(null),R++),F=M}}else for(let se in S)(z||S.hasOwnProperty(se))&&(M=F[se],M||(F[Be]&1048576&&(re=F[Be]&65535),M=F[se]=Object.create(null),R++),F=M,te++);let Q=F[Be];if(Q!==void 0)Q&=65535,x[p++]=217,x[p++]=Q>>8|224,x[p++]=Q&255;else if(oe||(oe=F.__keys__||(F.__keys__=Object.keys(S))),re===void 0?(Q=o.nextId++,Q||(Q=0,o.nextId=1),Q>=uo&&(o.nextId=(Q=f)+1)):Q=re,o[Q]=oe,Q<f){x[p++]=217,x[p++]=Q>>8|224,x[p++]=Q&255,F=o.transitions;for(let se=0;se<te;se++)(F[Be]===void 0||F[Be]&1048576)&&(F[Be]=Q),F=F[oe[se]];F[Be]=Q|1048576,i=!0}else{if(F[Be]=Q,we.setUint32(p,3655335680),p+=3,R&&(N+=P*R),C.length>=uo-f&&(C.shift()[Be]=void 0),C.push(F),et(te+2),j(57344+Q),j(oe),z===null)return;for(let se in S)(z||S.hasOwnProperty(se))&&j(S[se]);return}if(te<24?x[p++]=128|te:et(te),z!==null)for(let se in S)(z||S.hasOwnProperty(se))&&j(S[se])},D=S=>{let z;if(S>16777216){if(S-n>fo)throw new Error("Encoded buffer would be larger than maximum buffer size");z=Math.min(fo,Math.round(Math.max((S-n)*(S>67108864?1.25:2),4194304)/4096)*4096)}else z=(Math.max(S-n<<2,x.length-1)>>12)+1<<12;let M=new pr(z);return we=new DataView(M.buffer,0,z),x.copy?x.copy(M,0,n,S):M.set(x.slice(n,S)),p-=n,n=0,lt=M.length-10,x=M};let Y=100,J=1e3;this.encodeAsIterable=function(S,z){return ne(S,z,q)},this.encodeAsAsyncIterable=function(S,z){return ne(S,z,ie)};function*q(S,z,M){let F=S.constructor;if(F===Object){let R=u.useRecords!==!1;R?ee(S,null):lo(Object.keys(S).length,160);for(let te in S){let re=S[te];R||j(te),re&&typeof re=="object"?z[te]?yield*q(re,z[te]):yield*Z(re,z,te):j(re)}}else if(F===Array){let R=S.length;et(R);for(let te=0;te<R;te++){let re=S[te];re&&(typeof re=="object"||p-n>Y)?z.element?yield*q(re,z.element):yield*Z(re,z,"element"):j(re)}}else if(S[Symbol.iterator]){x[p++]=159;for(let R of S)R&&(typeof R=="object"||p-n>Y)?z.element?yield*q(R,z.element):yield*Z(R,z,"element"):j(R);x[p++]=255}else vr(S)?(lo(S.size,64),yield x.subarray(n,p),yield S,ae()):S[Symbol.asyncIterator]?(x[p++]=159,yield x.subarray(n,p),yield S,ae(),x[p++]=255):j(S);M&&p>n?yield x.subarray(n,p):p-n>Y&&(yield x.subarray(n,p),ae())}function*Z(S,z,M){let F=p-n;try{j(S),p-n>Y&&(yield x.subarray(n,p),ae())}catch(R){if(R.iteratorNotHandled)z[M]={},p=n+F,yield*q.call(this,S,z[M]);else throw R}}function ae(){Y=J,u.encode(null,br)}function ne(S,z,M){return z&&z.chunkThreshold?Y=J=z.chunkThreshold:Y=100,S&&typeof S=="object"?(u.encode(null,br),M(S,u.iterateProperties||(u.iterateProperties={}),!0)):[u.encode(S)]}async function*ie(S,z){for(let M of q(S,z,!0)){let F=M.constructor;if(F===co||F===Uint8Array)yield M;else if(vr(M)){let R=M.stream().getReader(),te;for(;!(te=await R.read()).done;)yield te.value}else if(M[Symbol.asyncIterator])for await(let R of M)ae(),R?yield*ie(R,z.async||(z.async={})):yield u.encode(R);else yield M}}}useBuffer(e){x=e,we=new DataView(x.buffer,x.byteOffset,x.byteLength),p=0}clearSharedData(){this.structures&&(this.structures=[]),this.sharedValues&&(this.sharedValues=void 0)}updateSharedData(){let e=this.sharedVersion||0;this.sharedVersion=e+1;let n=this.structures.slice(0),r=new ic(n,this.sharedValues,this.sharedVersion),i=this.saveShared(r,o=>(o&&o.version||0)==e);return i===!1?(r=this.getShared()||{},this.structures=r.structures||[],this.sharedValues=r.packedValues,this.sharedVersion=r.version,this.structures.nextId=this.structures.length):n.forEach((o,a)=>this.structures[a]=o),i}}function lo(t,e){t<24?x[p++]=e|t:t<256?(x[p++]=e|24,x[p++]=t):t<65536?(x[p++]=e|25,x[p++]=t>>8,x[p++]=t&255):(x[p++]=e|26,we.setUint32(p,t),p+=4)}class ic{constructor(e,n,r){this.structures=e,this.packedValues=n,this.version=r}}function et(t){t<24?x[p++]=128|t:t<256?(x[p++]=152,x[p++]=t):t<65536?(x[p++]=153,x[p++]=t>>8,x[p++]=t&255):(x[p++]=154,we.setUint32(p,t),p+=4)}const hh=typeof Blob>"u"?function(){}:Blob;function vr(t){if(t instanceof hh)return!0;let e=t[Symbol.toStringTag];return e==="Blob"||e==="File"}function Nn(t,e){switch(typeof t){case"string":if(t.length>3){if(e.objectMap[t]>-1||e.values.length>=e.maxValues)return;let r=e.get(t);if(r)++r.count==2&&e.values.push(t);else if(e.set(t,{count:1}),e.samplingPackedValues){let i=e.samplingPackedValues.get(t);i?i.count++:e.samplingPackedValues.set(t,{count:1})}}break;case"object":if(t)if(t instanceof Array)for(let r=0,i=t.length;r<i;r++)Nn(t[r],e);else{let r=!e.encoder.useRecords;for(var n in t)t.hasOwnProperty(n)&&(r&&Nn(n,e),Nn(t[n],e))}break;case"function":console.log(t)}}const _h=new Uint8Array(new Uint16Array([1]).buffer)[0]==1;rc=[Date,Set,Error,RegExp,bt,ArrayBuffer,Uint8Array,Uint8ClampedArray,Uint16Array,Uint32Array,typeof BigUint64Array>"u"?function(){}:BigUint64Array,Int8Array,Int16Array,Int32Array,typeof BigInt64Array>"u"?function(){}:BigInt64Array,Float32Array,Float64Array,ic];Br=[{tag:1,encode(t,e){let n=t.getTime()/1e3;(this.useTimestamp32||t.getMilliseconds()===0)&&n>=0&&n<4294967296?(x[p++]=26,we.setUint32(p,n),p+=4):(x[p++]=251,we.setFloat64(p,n),p+=8)}},{tag:258,encode(t,e){let n=Array.from(t);e(n)}},{tag:27,encode(t,e){e([t.name,t.message])}},{tag:27,encode(t,e){e(["RegExp",t.source,t.flags])}},{getTag(t){return t.tag},encode(t,e){e(t.value)}},{encode(t,e,n){ho(t,n)}},{getTag(t){if(t.constructor===Uint8Array&&(this.tagUint8Array||fn&&this.tagUint8Array!==!1))return 64},encode(t,e,n){ho(t,n)}},Xe(68,1),Xe(69,2),Xe(70,4),Xe(71,8),Xe(72,1),Xe(77,2),Xe(78,4),Xe(79,8),Xe(85,4),Xe(86,8),{encode(t,e){let n=t.packedValues||[],r=t.structures||[];if(n.values.length>0){x[p++]=216,x[p++]=51,et(4);let i=n.values;e(i),et(0),et(0),packedObjectMap=Object.create(sharedPackedObjectMap||null);for(let o=0,a=i.length;o<a;o++)packedObjectMap[i[o]]=o}if(r){we.setUint32(p,3655335424),p+=3;let i=r.slice(0);i.unshift(57344),i.push(new bt(t.version,1399353956)),e(i)}else e(new bt(t.version,1399353956))}}];function Xe(t,e){return!_h&&e>1&&(t-=4),{tag:t,encode:function(r,i){let o=r.byteLength,a=r.byteOffset||0,s=r.buffer||r;i(fn?tr.from(s,a,o):new Uint8Array(s,a,o))}}}function ho(t,e){let n=t.byteLength;n<24?x[p++]=64+n:n<256?(x[p++]=88,x[p++]=n):n<65536?(x[p++]=89,x[p++]=n>>8,x[p++]=n&255):(x[p++]=90,we.setUint32(p,n),p+=4),p+n>=x.length&&e(p+n),x.set(t.buffer?t:new Uint8Array(t),p),p+=n}function gh(t,e){let n,r=e.length*2,i=t.length-r;e.sort((o,a)=>o.offset>a.offset?1:-1);for(let o=0;o<e.length;o++){let a=e[o];a.id=o;for(let s of a.references)t[s++]=o>>8,t[s]=o&255}for(;n=e.pop();){let o=n.offset;t.copyWithin(o+r,o,i),r-=2;let a=o+r;t[a++]=216,t[a++]=28,i=o}return t}function _o(t,e){we.setUint32(ke.position+t,p-ke.position-t+1);let n=ke;ke=null,e(n[0]),e(n[1])}let gi=new dh({useRecords:!1});const Gt=gi.encode;gi.encodeAsIterable;gi.encodeAsAsyncIterable;const go=512,ph=1024,br=2048;class yh extends gt{broadcast(e,n){const r=Gt(n);this.emit("message",{targetId:"*",channelId:"m/"+e,message:r,broadcast:!0})}receive(e,n,r){const i=nc(r),o=n.slice(2);this.emit("data",{peerId:e,channelId:o,data:i})}}function vh(t){let e=0;t.forEach(i=>{e+=i.length});const n=new Uint8Array(e);let r=0;return t.forEach(i=>{n.set(i,r),r+=i.length}),n}class bh{#e;#t={};constructor(e){this.#e=e}#n(e,n){const r=Jr(n).saveIncremental();r&&r.length>0&&(this.#t[e]||(this.#t[e]=0),this.#e.save(`${e}.incremental.${this.#t[e]}`,r),this.#t[e]++)}#r(e,n){const r=Qn(n);this.#e.save(`${e}.snapshot`,r);for(let i=0;i<this.#t[e];i++)this.#e.remove(`${e}.incremental.${i}`);this.#t[e]=0}async loadBinary(e){const n=[];let r=await this.#e.load(`${e}.snapshot`);r&&r.length>0&&n.push(r);let i=0;for(;r=await this.#e.load(`${e}.incremental.${i}`);)this.#t[e]=i+1,r&&r.length>0&&n.push(r),i+=1;return vh(n)}async load(e,n=wt()){return cn(n,await this.loadBinary(e))}save(e,n){this.#i(e)?this.#r(e,n):this.#n(e,n)}remove(e){this.#e.remove(`${e}.snapshot`);for(let n=0;n<this.#t[e];n++)this.#e.remove(`${e}.incremental.${n}`)}#i(e){return this.#t[e]>=20}}class oc extends gt{}class mh extends oc{handle;#e;#t;#n;#r=[];#i={};constructor(e){super(),this.handle=e;const n=e.documentId.slice(0,5);this.#t=Ke(`automerge-repo:concise:docsync:${n}`),this.#e=Ke(`automerge-repo:docsync:${n}`),this.#n=Ke(`automerge-repo:ops:docsync:${n}`),e.on("change",()=>this.#o())}get documentId(){return this.handle.documentId}async #o(){this.#e("syncWithPeers");const e=await this.handle.value();this.#r.forEach(n=>this.#c(n,e))}#a(e){return this.#r.includes(e)||(this.#e("adding a new peer",e),this.#r.push(e)),this.#i[e]??ii()}#s(e,n){this.#i[e]=n}#c(e,n){this.#e(`sendSyncMessage ->${e}`);const r=this.#a(e),[i,o]=ni(n,r);if(this.#s(e,i),o){this.#u(`sendSyncMessage \u{1F852} ${e}`,o);const a=this.handle.documentId;this.emit("message",{targetId:e,channelId:a,message:o,broadcast:!1})}else this.#e(`sendSyncMessage ->${e} [no message generated]`)}#u=(e,n)=>{};hasPeer(e){return this.#r.includes(e)}beginSync(e){this.#e(`beginSync: ${e}`),this.handle.loadAttemptedValue().then(n=>{const r=this.#a(e),i=ti(ei(r));this.#s(e,i),this.#c(e,n)})}endSync(e){this.#e(`removing peer ${e}`),this.#r=this.#r.filter(n=>n!==e)}async receiveSyncMessage(e,n,r){if(n!==this.documentId)throw new Error("channelId doesn't match documentId");await this.handle.loadAttemptedValue(),this.handle.update(i=>{const[o,a]=ri(i,this.#a(e),r);return this.#s(e,a),this.#c(e,i),o})}}const mr=Ke("automerge-repo:collectionsync");class wh extends oc{repo;#e=new Set;#t={};constructor(e){super(),this.repo=e}#n(e){if(!this.#t[e]){const n=this.repo.find(e);this.#t[e]=this.#r(n)}return this.#t[e]}#r(e){const n=new mh(e);return n.on("message",r=>this.emit("message",r)),n}async #i(e){const n=Array.from(this.#e),r=[];for(const i of n)await this.repo.sharePolicy(i,e)&&r.push(i);return r}async receiveSyncMessage(e,n,r){mr(`onSyncMessage: ${e}, ${n}, ${r.byteLength}bytes`);const i=n,o=await this.#n(i);await o.receiveSyncMessage(e,n,r),(await this.#i(i)).filter(s=>!o.hasPeer(s)).forEach(s=>o.beginSync(s))}addDocument(e){const n=this.#n(e);this.#i(e).then(r=>{r.forEach(i=>{n.beginSync(i)})})}removeDocument(e){throw new Error("not implemented")}addPeer(e){mr(`adding ${e} & synchronizing with them`),this.#e.add(e);for(const n of Object.values(this.#t)){const{documentId:r}=n;this.repo.sharePolicy(e,r).then(i=>{i&&n.beginSync(e)})}}removePeer(e){mr(`removing peer ${e}`),this.#e.delete(e);for(const n of Object.values(this.#t))n.endSync(e)}}const Sh="sync_channel";class xh extends Yd{#e;networkSubsystem;storageSubsystem;ephemeralData;constructor({storage:e,network:n,peerId:r,sharePolicy:i}){super(),this.#e=Ke("automerge-repo:repo"),this.sharePolicy=i??this.sharePolicy,this.on("document",async({handle:c})=>{if(a){c.on("change",async({handle:l})=>{const _=await l.value();a.save(l.documentId,_)});const f=await a.loadBinary(c.documentId);c.load(f)}c.request(),await o.addDocument(c.documentId)}),this.on("delete-document",({documentId:c})=>{a&&a.remove(c)});const o=new wh(this);o.on("message",({targetId:c,channelId:f,message:l,broadcast:_})=>{this.#e(`sending sync message to ${c}`),s.sendMessage(c,f,l,_)});const a=e?new bh(e):void 0;this.storageSubsystem=a;const s=new qd(n,r);this.networkSubsystem=s,s.on("peer",async({peerId:c})=>{this.#e("peer connected",{peerId:c}),await o.addPeer(c)}),s.on("peer-disconnected",({peerId:c})=>{o.removePeer(c)}),s.on("message",async c=>{const{senderId:f,channelId:l,message:_}=c;l.startsWith("m/")?(this.#e(`receiving ephemeral message from ${f}`),u.receive(f,l,_)):(this.#e(`receiving sync message from ${f}`),await o.receiveSyncMessage(f,l,_))}),s.join(Sh);const u=new yh;this.ephemeralData=u,u.on("message",({targetId:c,channelId:f,message:l,broadcast:_})=>{this.#e(`sending ephemeral message to ${c}`),s.sendMessage(c,f,l,_)})}}class Eh extends gt{port;constructor(e){e.addEventListener("message",n=>{this.emit("message",n)}),super(),this.port=e}postMessage(e,n){this.port.postMessage(e,n)}start(){this.port.start()}isAlive(){return!0}}class Ah extends gt{weakRef;isDisconnected=!1;constructor(e){super(),this.weakRef=new WeakRef(e),e.addEventListener("message",n=>{this.emit("message",n)})}postMessage(e,n){const r=this.weakRef.deref();if(!r){this.disconnnect();return}try{r.postMessage(e,n)}catch{this.disconnnect()}}start(){const e=this.weakRef.deref();if(!e){this.disconnnect();return}try{e.start()}catch{this.disconnnect()}}disconnnect(){this.isDisconnected||(this.emit("close"),this.isDisconnected=!0)}isAlive(){return this.isDisconnected?!1:this.weakRef.deref()?!0:(this.disconnnect(),!1)}}const po=Ke("automerge-repo:messagechannel");class Ch extends Gs{channels={};messagePortRef;constructor(e,n={}){super();const r=n.useWeakRef??!1;this.messagePortRef=r?new Ah(e):new Eh(e)}connect(e){po("messageport connecting"),this.peerId=e,this.messagePortRef.start(),this.messagePortRef.addListener("message",n=>{po("message port received",n.data);const{origin:r,destination:i,type:o,channelId:a,message:s,broadcast:u}=n.data;if(i&&!(i===this.peerId||u))throw new Error("MessagePortNetwork should never receive messages for a different peer.");switch(o){case"arrive":this.messagePortRef.postMessage({origin:this.peerId,destination:r,type:"welcome"}),this.announceConnection(a,r);break;case"welcome":this.announceConnection(a,r);break;case"message":this.emit("message",{senderId:r,targetId:i,channelId:a,message:new Uint8Array(s),broadcast:u});break;default:throw new Error("unhandled message from network")}}),this.messagePortRef.addListener("close",()=>{this.emit("close")})}sendMessage(e,n,r,i){const o=r.buffer.slice(r.byteOffset,r.byteOffset+r.byteLength);this.messagePortRef.postMessage({origin:this.peerId,destination:e,channelId:n,type:"message",message:o,broadcast:i},[o])}announceConnection(e,n){this.emit("peer-candidate",{peerId:n,channelId:e})}join(e){this.messagePortRef.postMessage({origin:this.peerId,channelId:e,type:"arrive"})}leave(e){throw new Error("Unimplemented: leave on MessagePortNetworkAdapter: "+e)}}function On(t){throw new Error('Could not dynamically require "'+t+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var Ln={exports:{}};(function(t,e){(function(n){t.exports=n()})(function(){return function n(r,i,o){function a(c,f){if(!i[c]){if(!r[c]){var l=typeof On=="function"&&On;if(!f&&l)return l(c,!0);if(s)return s(c,!0);var _=new Error("Cannot find module '"+c+"'");throw _.code="MODULE_NOT_FOUND",_}var m=i[c]={exports:{}};r[c][0].call(m.exports,function(E){var O=r[c][1][E];return a(O||E)},m,m.exports,n,r,i,o)}return i[c].exports}for(var s=typeof On=="function"&&On,u=0;u<o.length;u++)a(o[u]);return a}({1:[function(n,r,i){(function(o){var a=o.MutationObserver||o.WebKitMutationObserver,s;if(a){var u=0,c=new a(E),f=o.document.createTextNode("");c.observe(f,{characterData:!0}),s=function(){f.data=u=++u%2}}else if(!o.setImmediate&&typeof o.MessageChannel<"u"){var l=new o.MessageChannel;l.port1.onmessage=E,s=function(){l.port2.postMessage(0)}}else"document"in o&&"onreadystatechange"in o.document.createElement("script")?s=function(){var C=o.document.createElement("script");C.onreadystatechange=function(){E(),C.onreadystatechange=null,C.parentNode.removeChild(C),C=null},o.document.documentElement.appendChild(C)}:s=function(){setTimeout(E,0)};var _,m=[];function E(){_=!0;for(var C,N,P=m.length;P;){for(N=m,m=[],C=-1;++C<P;)N[C]();P=m.length}_=!1}r.exports=O;function O(C){m.push(C)===1&&!_&&s()}}).call(this,typeof _n<"u"?_n:typeof self<"u"?self:typeof window<"u"?window:{})},{}],2:[function(n,r,i){var o=n(1);function a(){}var s={},u=["REJECTED"],c=["FULFILLED"],f=["PENDING"];r.exports=l;function l(D){if(typeof D!="function")throw new TypeError("resolver must be a function");this.state=f,this.queue=[],this.outcome=void 0,D!==a&&O(this,D)}l.prototype.catch=function(D){return this.then(null,D)},l.prototype.then=function(D,Y){if(typeof D!="function"&&this.state===c||typeof Y!="function"&&this.state===u)return this;var J=new this.constructor(a);if(this.state!==f){var q=this.state===c?D:Y;m(J,q,this.outcome)}else this.queue.push(new _(J,D,Y));return J};function _(D,Y,J){this.promise=D,typeof Y=="function"&&(this.onFulfilled=Y,this.callFulfilled=this.otherCallFulfilled),typeof J=="function"&&(this.onRejected=J,this.callRejected=this.otherCallRejected)}_.prototype.callFulfilled=function(D){s.resolve(this.promise,D)},_.prototype.otherCallFulfilled=function(D){m(this.promise,this.onFulfilled,D)},_.prototype.callRejected=function(D){s.reject(this.promise,D)},_.prototype.otherCallRejected=function(D){m(this.promise,this.onRejected,D)};function m(D,Y,J){o(function(){var q;try{q=Y(J)}catch(Z){return s.reject(D,Z)}q===D?s.reject(D,new TypeError("Cannot resolve promise with itself")):s.resolve(D,q)})}s.resolve=function(D,Y){var J=C(E,Y);if(J.status==="error")return s.reject(D,J.value);var q=J.value;if(q)O(D,q);else{D.state=c,D.outcome=Y;for(var Z=-1,ae=D.queue.length;++Z<ae;)D.queue[Z].callFulfilled(Y)}return D},s.reject=function(D,Y){D.state=u,D.outcome=Y;for(var J=-1,q=D.queue.length;++J<q;)D.queue[J].callRejected(Y);return D};function E(D){var Y=D&&D.then;if(D&&(typeof D=="object"||typeof D=="function")&&typeof Y=="function")return function(){Y.apply(D,arguments)}}function O(D,Y){var J=!1;function q(ie){J||(J=!0,s.reject(D,ie))}function Z(ie){J||(J=!0,s.resolve(D,ie))}function ae(){Y(Z,q)}var ne=C(ae);ne.status==="error"&&q(ne.value)}function C(D,Y){var J={};try{J.value=D(Y),J.status="success"}catch(q){J.status="error",J.value=q}return J}l.resolve=N;function N(D){return D instanceof this?D:s.resolve(new this(a),D)}l.reject=P;function P(D){var Y=new this(a);return s.reject(Y,D)}l.all=j;function j(D){var Y=this;if(Object.prototype.toString.call(D)!=="[object Array]")return this.reject(new TypeError("must be an array"));var J=D.length,q=!1;if(!J)return this.resolve([]);for(var Z=new Array(J),ae=0,ne=-1,ie=new this(a);++ne<J;)S(D[ne],ne);return ie;function S(z,M){Y.resolve(z).then(F,function(R){q||(q=!0,s.reject(ie,R))});function F(R){Z[M]=R,++ae===J&&!q&&(q=!0,s.resolve(ie,Z))}}}l.race=ee;function ee(D){var Y=this;if(Object.prototype.toString.call(D)!=="[object Array]")return this.reject(new TypeError("must be an array"));var J=D.length,q=!1;if(!J)return this.resolve([]);for(var Z=-1,ae=new this(a);++Z<J;)ne(D[Z]);return ae;function ne(ie){Y.resolve(ie).then(function(S){q||(q=!0,s.resolve(ae,S))},function(S){q||(q=!0,s.reject(ae,S))})}}},{1:1}],3:[function(n,r,i){(function(o){typeof o.Promise!="function"&&(o.Promise=n(2))}).call(this,typeof _n<"u"?_n:typeof self<"u"?self:typeof window<"u"?window:{})},{2:2}],4:[function(n,r,i){var o=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(d){return typeof d}:function(d){return d&&typeof Symbol=="function"&&d.constructor===Symbol&&d!==Symbol.prototype?"symbol":typeof d};function a(d,g){if(!(d instanceof g))throw new TypeError("Cannot call a class as a function")}function s(){try{if(typeof indexedDB<"u")return indexedDB;if(typeof webkitIndexedDB<"u")return webkitIndexedDB;if(typeof mozIndexedDB<"u")return mozIndexedDB;if(typeof OIndexedDB<"u")return OIndexedDB;if(typeof msIndexedDB<"u")return msIndexedDB}catch{return}}var u=s();function c(){try{if(!u||!u.open)return!1;var d=typeof openDatabase<"u"&&/(Safari|iPhone|iPad|iPod)/.test(navigator.userAgent)&&!/Chrome/.test(navigator.userAgent)&&!/BlackBerry/.test(navigator.platform),g=typeof fetch=="function"&&fetch.toString().indexOf("[native code")!==-1;return(!d||g)&&typeof indexedDB<"u"&&typeof IDBKeyRange<"u"}catch{return!1}}function f(d,g){d=d||[],g=g||{};try{return new Blob(d,g)}catch(v){if(v.name!=="TypeError")throw v;for(var h=typeof BlobBuilder<"u"?BlobBuilder:typeof MSBlobBuilder<"u"?MSBlobBuilder:typeof MozBlobBuilder<"u"?MozBlobBuilder:WebKitBlobBuilder,b=new h,w=0;w<d.length;w+=1)b.append(d[w]);return b.getBlob(g.type)}}typeof Promise>"u"&&n(3);var l=Promise;function _(d,g){g&&d.then(function(h){g(null,h)},function(h){g(h)})}function m(d,g,h){typeof g=="function"&&d.then(g),typeof h=="function"&&d.catch(h)}function E(d){return typeof d!="string"&&(console.warn(d+" used as a key, but it is not a string."),d=String(d)),d}function O(){if(arguments.length&&typeof arguments[arguments.length-1]=="function")return arguments[arguments.length-1]}var C="local-forage-detect-blob-support",N=void 0,P={},j=Object.prototype.toString,ee="readonly",D="readwrite";function Y(d){for(var g=d.length,h=new ArrayBuffer(g),b=new Uint8Array(h),w=0;w<g;w++)b[w]=d.charCodeAt(w);return h}function J(d){return new l(function(g){var h=d.transaction(C,D),b=f([""]);h.objectStore(C).put(b,"key"),h.onabort=function(w){w.preventDefault(),w.stopPropagation(),g(!1)},h.oncomplete=function(){var w=navigator.userAgent.match(/Chrome\/(\d+)/),v=navigator.userAgent.match(/Edge\//);g(v||!w||parseInt(w[1],10)>=43)}}).catch(function(){return!1})}function q(d){return typeof N=="boolean"?l.resolve(N):J(d).then(function(g){return N=g,N})}function Z(d){var g=P[d.name],h={};h.promise=new l(function(b,w){h.resolve=b,h.reject=w}),g.deferredOperations.push(h),g.dbReady?g.dbReady=g.dbReady.then(function(){return h.promise}):g.dbReady=h.promise}function ae(d){var g=P[d.name],h=g.deferredOperations.pop();if(h)return h.resolve(),h.promise}function ne(d,g){var h=P[d.name],b=h.deferredOperations.pop();if(b)return b.reject(g),b.promise}function ie(d,g){return new l(function(h,b){if(P[d.name]=P[d.name]||se(),d.db)if(g)Z(d),d.db.close();else return h(d.db);var w=[d.name];g&&w.push(d.version);var v=u.open.apply(u,w);g&&(v.onupgradeneeded=function(T){var L=v.result;try{L.createObjectStore(d.storeName),T.oldVersion<=1&&L.createObjectStore(C)}catch(U){if(U.name==="ConstraintError")console.warn('The database "'+d.name+'" has been upgraded from version '+T.oldVersion+" to version "+T.newVersion+', but the storage "'+d.storeName+'" already exists.');else throw U}}),v.onerror=function(T){T.preventDefault(),b(v.error)},v.onsuccess=function(){var T=v.result;T.onversionchange=function(L){L.target.close()},h(T),ae(d)}})}function S(d){return ie(d,!1)}function z(d){return ie(d,!0)}function M(d,g){if(!d.db)return!0;var h=!d.db.objectStoreNames.contains(d.storeName),b=d.version<d.db.version,w=d.version>d.db.version;if(b&&(d.version!==g&&console.warn('The database "'+d.name+`" can't be downgraded from version `+d.db.version+" to version "+d.version+"."),d.version=d.db.version),w||h){if(h){var v=d.db.version+1;v>d.version&&(d.version=v)}return!0}return!1}function F(d){return new l(function(g,h){var b=new FileReader;b.onerror=h,b.onloadend=function(w){var v=btoa(w.target.result||"");g({__local_forage_encoded_blob:!0,data:v,type:d.type})},b.readAsBinaryString(d)})}function R(d){var g=Y(atob(d.data));return f([g],{type:d.type})}function te(d){return d&&d.__local_forage_encoded_blob}function re(d){var g=this,h=g._initReady().then(function(){var b=P[g._dbInfo.name];if(b&&b.dbReady)return b.dbReady});return m(h,d,d),h}function oe(d){Z(d);for(var g=P[d.name],h=g.forages,b=0;b<h.length;b++){var w=h[b];w._dbInfo.db&&(w._dbInfo.db.close(),w._dbInfo.db=null)}return d.db=null,S(d).then(function(v){return d.db=v,M(d)?z(d):v}).then(function(v){d.db=g.db=v;for(var T=0;T<h.length;T++)h[T]._dbInfo.db=v}).catch(function(v){throw ne(d,v),v})}function Q(d,g,h,b){b===void 0&&(b=1);try{var w=d.db.transaction(d.storeName,g);h(null,w)}catch(v){if(b>0&&(!d.db||v.name==="InvalidStateError"||v.name==="NotFoundError"))return l.resolve().then(function(){if(!d.db||v.name==="NotFoundError"&&!d.db.objectStoreNames.contains(d.storeName)&&d.version<=d.db.version)return d.db&&(d.version=d.db.version+1),z(d)}).then(function(){return oe(d).then(function(){Q(d,g,h,b-1)})}).catch(h);h(v)}}function se(){return{forages:[],db:null,dbReady:null,deferredOperations:[]}}function St(d){var g=this,h={db:null};if(d)for(var b in d)h[b]=d[b];var w=P[h.name];w||(w=se(),P[h.name]=w),w.forages.push(g),g._initReady||(g._initReady=g.ready,g.ready=re);var v=[];function T(){return l.resolve()}for(var L=0;L<w.forages.length;L++){var U=w.forages[L];U!==g&&v.push(U._initReady().catch(T))}var $=w.forages.slice(0);return l.all(v).then(function(){return h.db=w.db,S(h)}).then(function(W){return h.db=W,M(h,g._defaultConfig.version)?z(h):W}).then(function(W){h.db=w.db=W,g._dbInfo=h;for(var X=0;X<$.length;X++){var ce=$[X];ce!==g&&(ce._dbInfo.db=h.db,ce._dbInfo.version=h.version)}})}function $e(d,g){var h=this;d=E(d);var b=new l(function(w,v){h.ready().then(function(){Q(h._dbInfo,ee,function(T,L){if(T)return v(T);try{var U=L.objectStore(h._dbInfo.storeName),$=U.get(d);$.onsuccess=function(){var W=$.result;W===void 0&&(W=null),te(W)&&(W=R(W)),w(W)},$.onerror=function(){v($.error)}}catch(W){v(W)}})}).catch(v)});return _(b,g),b}function ct(d,g){var h=this,b=new l(function(w,v){h.ready().then(function(){Q(h._dbInfo,ee,function(T,L){if(T)return v(T);try{var U=L.objectStore(h._dbInfo.storeName),$=U.openCursor(),W=1;$.onsuccess=function(){var X=$.result;if(X){var ce=X.value;te(ce)&&(ce=R(ce));var pe=d(ce,X.key,W++);pe!==void 0?w(pe):X.continue()}else w()},$.onerror=function(){v($.error)}}catch(X){v(X)}})}).catch(v)});return _(b,g),b}function hc(d,g,h){var b=this;d=E(d);var w=new l(function(v,T){var L;b.ready().then(function(){return L=b._dbInfo,j.call(g)==="[object Blob]"?q(L.db).then(function(U){return U?g:F(g)}):g}).then(function(U){Q(b._dbInfo,D,function($,W){if($)return T($);try{var X=W.objectStore(b._dbInfo.storeName);U===null&&(U=void 0);var ce=X.put(U,d);W.oncomplete=function(){U===void 0&&(U=null),v(U)},W.onabort=W.onerror=function(){var pe=ce.error?ce.error:ce.transaction.error;T(pe)}}catch(pe){T(pe)}})}).catch(T)});return _(w,h),w}function _c(d,g){var h=this;d=E(d);var b=new l(function(w,v){h.ready().then(function(){Q(h._dbInfo,D,function(T,L){if(T)return v(T);try{var U=L.objectStore(h._dbInfo.storeName),$=U.delete(d);L.oncomplete=function(){w()},L.onerror=function(){v($.error)},L.onabort=function(){var W=$.error?$.error:$.transaction.error;v(W)}}catch(W){v(W)}})}).catch(v)});return _(b,g),b}function gc(d){var g=this,h=new l(function(b,w){g.ready().then(function(){Q(g._dbInfo,D,function(v,T){if(v)return w(v);try{var L=T.objectStore(g._dbInfo.storeName),U=L.clear();T.oncomplete=function(){b()},T.onabort=T.onerror=function(){var $=U.error?U.error:U.transaction.error;w($)}}catch($){w($)}})}).catch(w)});return _(h,d),h}function pc(d){var g=this,h=new l(function(b,w){g.ready().then(function(){Q(g._dbInfo,ee,function(v,T){if(v)return w(v);try{var L=T.objectStore(g._dbInfo.storeName),U=L.count();U.onsuccess=function(){b(U.result)},U.onerror=function(){w(U.error)}}catch($){w($)}})}).catch(w)});return _(h,d),h}function yc(d,g){var h=this,b=new l(function(w,v){if(d<0){w(null);return}h.ready().then(function(){Q(h._dbInfo,ee,function(T,L){if(T)return v(T);try{var U=L.objectStore(h._dbInfo.storeName),$=!1,W=U.openKeyCursor();W.onsuccess=function(){var X=W.result;if(!X){w(null);return}d===0||$?w(X.key):($=!0,X.advance(d))},W.onerror=function(){v(W.error)}}catch(X){v(X)}})}).catch(v)});return _(b,g),b}function vc(d){var g=this,h=new l(function(b,w){g.ready().then(function(){Q(g._dbInfo,ee,function(v,T){if(v)return w(v);try{var L=T.objectStore(g._dbInfo.storeName),U=L.openKeyCursor(),$=[];U.onsuccess=function(){var W=U.result;if(!W){b($);return}$.push(W.key),W.continue()},U.onerror=function(){w(U.error)}}catch(W){w(W)}})}).catch(w)});return _(h,d),h}function bc(d,g){g=O.apply(this,arguments);var h=this.config();d=typeof d!="function"&&d||{},d.name||(d.name=d.name||h.name,d.storeName=d.storeName||h.storeName);var b=this,w;if(!d.name)w=l.reject("Invalid arguments");else{var v=d.name===h.name&&b._dbInfo.db,T=v?l.resolve(b._dbInfo.db):S(d).then(function(L){var U=P[d.name],$=U.forages;U.db=L;for(var W=0;W<$.length;W++)$[W]._dbInfo.db=L;return L});d.storeName?w=T.then(function(L){if(!!L.objectStoreNames.contains(d.storeName)){var U=L.version+1;Z(d);var $=P[d.name],W=$.forages;L.close();for(var X=0;X<W.length;X++){var ce=W[X];ce._dbInfo.db=null,ce._dbInfo.version=U}var pe=new l(function(ve,Ce){var Ee=u.open(d.name,U);Ee.onerror=function(ze){var zt=Ee.result;zt.close(),Ce(ze)},Ee.onupgradeneeded=function(){var ze=Ee.result;ze.deleteObjectStore(d.storeName)},Ee.onsuccess=function(){var ze=Ee.result;ze.close(),ve(ze)}});return pe.then(function(ve){$.db=ve;for(var Ce=0;Ce<W.length;Ce++){var Ee=W[Ce];Ee._dbInfo.db=ve,ae(Ee._dbInfo)}}).catch(function(ve){throw(ne(d,ve)||l.resolve()).catch(function(){}),ve})}}):w=T.then(function(L){Z(d);var U=P[d.name],$=U.forages;L.close();for(var W=0;W<$.length;W++){var X=$[W];X._dbInfo.db=null}var ce=new l(function(pe,ve){var Ce=u.deleteDatabase(d.name);Ce.onerror=function(){var Ee=Ce.result;Ee&&Ee.close(),ve(Ce.error)},Ce.onblocked=function(){console.warn('dropInstance blocked for database "'+d.name+'" until all open connections are closed')},Ce.onsuccess=function(){var Ee=Ce.result;Ee&&Ee.close(),pe(Ee)}});return ce.then(function(pe){U.db=pe;for(var ve=0;ve<$.length;ve++){var Ce=$[ve];ae(Ce._dbInfo)}}).catch(function(pe){throw(ne(d,pe)||l.resolve()).catch(function(){}),pe})})}return _(w,g),w}var mc={_driver:"asyncStorage",_initStorage:St,_support:c(),iterate:ct,getItem:$e,setItem:hc,removeItem:_c,clear:gc,length:pc,key:yc,keys:vc,dropInstance:bc};function wc(){return typeof openDatabase=="function"}var ut="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",Sc="~~local_forage_type~",mi=/^~~local_forage_type~([^~]+)~/,dn="__lfsc__:",nr=dn.length,rr="arbf",ir="blob",wi="si08",Si="ui08",xi="uic8",Ei="si16",Ai="si32",Ci="ur16",Oi="ui32",ki="fl32",Ri="fl64",Ii=nr+rr.length,Ti=Object.prototype.toString;function ji(d){var g=d.length*.75,h=d.length,b,w=0,v,T,L,U;d[d.length-1]==="="&&(g--,d[d.length-2]==="="&&g--);var $=new ArrayBuffer(g),W=new Uint8Array($);for(b=0;b<h;b+=4)v=ut.indexOf(d[b]),T=ut.indexOf(d[b+1]),L=ut.indexOf(d[b+2]),U=ut.indexOf(d[b+3]),W[w++]=v<<2|T>>4,W[w++]=(T&15)<<4|L>>2,W[w++]=(L&3)<<6|U&63;return $}function or(d){var g=new Uint8Array(d),h="",b;for(b=0;b<g.length;b+=3)h+=ut[g[b]>>2],h+=ut[(g[b]&3)<<4|g[b+1]>>4],h+=ut[(g[b+1]&15)<<2|g[b+2]>>6],h+=ut[g[b+2]&63];return g.length%3===2?h=h.substring(0,h.length-1)+"=":g.length%3===1&&(h=h.substring(0,h.length-2)+"=="),h}function xc(d,g){var h="";if(d&&(h=Ti.call(d)),d&&(h==="[object ArrayBuffer]"||d.buffer&&Ti.call(d.buffer)==="[object ArrayBuffer]")){var b,w=dn;d instanceof ArrayBuffer?(b=d,w+=rr):(b=d.buffer,h==="[object Int8Array]"?w+=wi:h==="[object Uint8Array]"?w+=Si:h==="[object Uint8ClampedArray]"?w+=xi:h==="[object Int16Array]"?w+=Ei:h==="[object Uint16Array]"?w+=Ci:h==="[object Int32Array]"?w+=Ai:h==="[object Uint32Array]"?w+=Oi:h==="[object Float32Array]"?w+=ki:h==="[object Float64Array]"?w+=Ri:g(new Error("Failed to get type for BinaryArray"))),g(w+or(b))}else if(h==="[object Blob]"){var v=new FileReader;v.onload=function(){var T=Sc+d.type+"~"+or(this.result);g(dn+ir+T)},v.readAsArrayBuffer(d)}else try{g(JSON.stringify(d))}catch(T){console.error("Couldn't convert value into a JSON string: ",d),g(null,T)}}function Ec(d){if(d.substring(0,nr)!==dn)return JSON.parse(d);var g=d.substring(Ii),h=d.substring(nr,Ii),b;if(h===ir&&mi.test(g)){var w=g.match(mi);b=w[1],g=g.substring(w[0].length)}var v=ji(g);switch(h){case rr:return v;case ir:return f([v],{type:b});case wi:return new Int8Array(v);case Si:return new Uint8Array(v);case xi:return new Uint8ClampedArray(v);case Ei:return new Int16Array(v);case Ci:return new Uint16Array(v);case Ai:return new Int32Array(v);case Oi:return new Uint32Array(v);case ki:return new Float32Array(v);case Ri:return new Float64Array(v);default:throw new Error("Unkown type: "+h)}}var ar={serialize:xc,deserialize:Ec,stringToBuffer:ji,bufferToString:or};function Di(d,g,h,b){d.executeSql("CREATE TABLE IF NOT EXISTS "+g.storeName+" (id INTEGER PRIMARY KEY, key unique, value)",[],h,b)}function Ac(d){var g=this,h={db:null};if(d)for(var b in d)h[b]=typeof d[b]!="string"?d[b].toString():d[b];var w=new l(function(v,T){try{h.db=openDatabase(h.name,String(h.version),h.description,h.size)}catch(L){return T(L)}h.db.transaction(function(L){Di(L,h,function(){g._dbInfo=h,v()},function(U,$){T($)})},T)});return h.serializer=ar,w}function ft(d,g,h,b,w,v){d.executeSql(h,b,w,function(T,L){L.code===L.SYNTAX_ERR?T.executeSql("SELECT name FROM sqlite_master WHERE type='table' AND name = ?",[g.storeName],function(U,$){$.rows.length?v(U,L):Di(U,g,function(){U.executeSql(h,b,w,v)},v)},v):v(T,L)},v)}function Cc(d,g){var h=this;d=E(d);var b=new l(function(w,v){h.ready().then(function(){var T=h._dbInfo;T.db.transaction(function(L){ft(L,T,"SELECT * FROM "+T.storeName+" WHERE key = ? LIMIT 1",[d],function(U,$){var W=$.rows.length?$.rows.item(0).value:null;W&&(W=T.serializer.deserialize(W)),w(W)},function(U,$){v($)})})}).catch(v)});return _(b,g),b}function Oc(d,g){var h=this,b=new l(function(w,v){h.ready().then(function(){var T=h._dbInfo;T.db.transaction(function(L){ft(L,T,"SELECT * FROM "+T.storeName,[],function(U,$){for(var W=$.rows,X=W.length,ce=0;ce<X;ce++){var pe=W.item(ce),ve=pe.value;if(ve&&(ve=T.serializer.deserialize(ve)),ve=d(ve,pe.key,ce+1),ve!==void 0){w(ve);return}}w()},function(U,$){v($)})})}).catch(v)});return _(b,g),b}function Pi(d,g,h,b){var w=this;d=E(d);var v=new l(function(T,L){w.ready().then(function(){g===void 0&&(g=null);var U=g,$=w._dbInfo;$.serializer.serialize(g,function(W,X){X?L(X):$.db.transaction(function(ce){ft(ce,$,"INSERT OR REPLACE INTO "+$.storeName+" (key, value) VALUES (?, ?)",[d,W],function(){T(U)},function(pe,ve){L(ve)})},function(ce){if(ce.code===ce.QUOTA_ERR){if(b>0){T(Pi.apply(w,[d,U,h,b-1]));return}L(ce)}})})}).catch(L)});return _(v,h),v}function kc(d,g,h){return Pi.apply(this,[d,g,h,1])}function Rc(d,g){var h=this;d=E(d);var b=new l(function(w,v){h.ready().then(function(){var T=h._dbInfo;T.db.transaction(function(L){ft(L,T,"DELETE FROM "+T.storeName+" WHERE key = ?",[d],function(){w()},function(U,$){v($)})})}).catch(v)});return _(b,g),b}function Ic(d){var g=this,h=new l(function(b,w){g.ready().then(function(){var v=g._dbInfo;v.db.transaction(function(T){ft(T,v,"DELETE FROM "+v.storeName,[],function(){b()},function(L,U){w(U)})})}).catch(w)});return _(h,d),h}function Tc(d){var g=this,h=new l(function(b,w){g.ready().then(function(){var v=g._dbInfo;v.db.transaction(function(T){ft(T,v,"SELECT COUNT(key) as c FROM "+v.storeName,[],function(L,U){var $=U.rows.item(0).c;b($)},function(L,U){w(U)})})}).catch(w)});return _(h,d),h}function jc(d,g){var h=this,b=new l(function(w,v){h.ready().then(function(){var T=h._dbInfo;T.db.transaction(function(L){ft(L,T,"SELECT key FROM "+T.storeName+" WHERE id = ? LIMIT 1",[d+1],function(U,$){var W=$.rows.length?$.rows.item(0).key:null;w(W)},function(U,$){v($)})})}).catch(v)});return _(b,g),b}function Dc(d){var g=this,h=new l(function(b,w){g.ready().then(function(){var v=g._dbInfo;v.db.transaction(function(T){ft(T,v,"SELECT key FROM "+v.storeName,[],function(L,U){for(var $=[],W=0;W<U.rows.length;W++)$.push(U.rows.item(W).key);b($)},function(L,U){w(U)})})}).catch(w)});return _(h,d),h}function Pc(d){return new l(function(g,h){d.transaction(function(b){b.executeSql("SELECT name FROM sqlite_master WHERE type='table' AND name <> '__WebKitDatabaseInfoTable__'",[],function(w,v){for(var T=[],L=0;L<v.rows.length;L++)T.push(v.rows.item(L).name);g({db:d,storeNames:T})},function(w,v){h(v)})},function(b){h(b)})})}function Mc(d,g){g=O.apply(this,arguments);var h=this.config();d=typeof d!="function"&&d||{},d.name||(d.name=d.name||h.name,d.storeName=d.storeName||h.storeName);var b=this,w;return d.name?w=new l(function(v){var T;d.name===h.name?T=b._dbInfo.db:T=openDatabase(d.name,"","",0),d.storeName?v({db:T,storeNames:[d.storeName]}):v(Pc(T))}).then(function(v){return new l(function(T,L){v.db.transaction(function(U){function $(pe){return new l(function(ve,Ce){U.executeSql("DROP TABLE IF EXISTS "+pe,[],function(){ve()},function(Ee,ze){Ce(ze)})})}for(var W=[],X=0,ce=v.storeNames.length;X<ce;X++)W.push($(v.storeNames[X]));l.all(W).then(function(){T()}).catch(function(pe){L(pe)})},function(U){L(U)})})}):w=l.reject("Invalid arguments"),_(w,g),w}var Nc={_driver:"webSQLStorage",_initStorage:Ac,_support:wc(),iterate:Oc,getItem:Cc,setItem:kc,removeItem:Rc,clear:Ic,length:Tc,key:jc,keys:Dc,dropInstance:Mc};function Lc(){try{return typeof localStorage<"u"&&"setItem"in localStorage&&!!localStorage.setItem}catch{return!1}}function Mi(d,g){var h=d.name+"/";return d.storeName!==g.storeName&&(h+=d.storeName+"/"),h}function Fc(){var d="_localforage_support_test";try{return localStorage.setItem(d,!0),localStorage.removeItem(d),!1}catch{return!0}}function Uc(){return!Fc()||localStorage.length>0}function $c(d){var g=this,h={};if(d)for(var b in d)h[b]=d[b];return h.keyPrefix=Mi(d,g._defaultConfig),Uc()?(g._dbInfo=h,h.serializer=ar,l.resolve()):l.reject()}function Bc(d){var g=this,h=g.ready().then(function(){for(var b=g._dbInfo.keyPrefix,w=localStorage.length-1;w>=0;w--){var v=localStorage.key(w);v.indexOf(b)===0&&localStorage.removeItem(v)}});return _(h,d),h}function zc(d,g){var h=this;d=E(d);var b=h.ready().then(function(){var w=h._dbInfo,v=localStorage.getItem(w.keyPrefix+d);return v&&(v=w.serializer.deserialize(v)),v});return _(b,g),b}function Vc(d,g){var h=this,b=h.ready().then(function(){for(var w=h._dbInfo,v=w.keyPrefix,T=v.length,L=localStorage.length,U=1,$=0;$<L;$++){var W=localStorage.key($);if(W.indexOf(v)===0){var X=localStorage.getItem(W);if(X&&(X=w.serializer.deserialize(X)),X=d(X,W.substring(T),U++),X!==void 0)return X}}});return _(b,g),b}function Wc(d,g){var h=this,b=h.ready().then(function(){var w=h._dbInfo,v;try{v=localStorage.key(d)}catch{v=null}return v&&(v=v.substring(w.keyPrefix.length)),v});return _(b,g),b}function Hc(d){var g=this,h=g.ready().then(function(){for(var b=g._dbInfo,w=localStorage.length,v=[],T=0;T<w;T++){var L=localStorage.key(T);L.indexOf(b.keyPrefix)===0&&v.push(L.substring(b.keyPrefix.length))}return v});return _(h,d),h}function Kc(d){var g=this,h=g.keys().then(function(b){return b.length});return _(h,d),h}function Jc(d,g){var h=this;d=E(d);var b=h.ready().then(function(){var w=h._dbInfo;localStorage.removeItem(w.keyPrefix+d)});return _(b,g),b}function Yc(d,g,h){var b=this;d=E(d);var w=b.ready().then(function(){g===void 0&&(g=null);var v=g;return new l(function(T,L){var U=b._dbInfo;U.serializer.serialize(g,function($,W){if(W)L(W);else try{localStorage.setItem(U.keyPrefix+d,$),T(v)}catch(X){(X.name==="QuotaExceededError"||X.name==="NS_ERROR_DOM_QUOTA_REACHED")&&L(X),L(X)}})})});return _(w,h),w}function qc(d,g){if(g=O.apply(this,arguments),d=typeof d!="function"&&d||{},!d.name){var h=this.config();d.name=d.name||h.name,d.storeName=d.storeName||h.storeName}var b=this,w;return d.name?w=new l(function(v){d.storeName?v(Mi(d,b._defaultConfig)):v(d.name+"/")}).then(function(v){for(var T=localStorage.length-1;T>=0;T--){var L=localStorage.key(T);L.indexOf(v)===0&&localStorage.removeItem(L)}}):w=l.reject("Invalid arguments"),_(w,g),w}var Gc={_driver:"localStorageWrapper",_initStorage:$c,_support:Lc(),iterate:Vc,getItem:zc,setItem:Yc,removeItem:Jc,clear:Bc,length:Kc,key:Wc,keys:Hc,dropInstance:qc},Qc=function(g,h){return g===h||typeof g=="number"&&typeof h=="number"&&isNaN(g)&&isNaN(h)},Xc=function(g,h){for(var b=g.length,w=0;w<b;){if(Qc(g[w],h))return!0;w++}return!1},Ni=Array.isArray||function(d){return Object.prototype.toString.call(d)==="[object Array]"},Bt={},Li={},xt={INDEXEDDB:mc,WEBSQL:Nc,LOCALSTORAGE:Gc},Zc=[xt.INDEXEDDB._driver,xt.WEBSQL._driver,xt.LOCALSTORAGE._driver],hn=["dropInstance"],sr=["clear","getItem","iterate","key","keys","length","removeItem","setItem"].concat(hn),eu={description:"",driver:Zc.slice(),name:"localforage",size:4980736,storeName:"keyvaluepairs",version:1};function tu(d,g){d[g]=function(){var h=arguments;return d.ready().then(function(){return d[g].apply(d,h)})}}function cr(){for(var d=1;d<arguments.length;d++){var g=arguments[d];if(g)for(var h in g)g.hasOwnProperty(h)&&(Ni(g[h])?arguments[0][h]=g[h].slice():arguments[0][h]=g[h])}return arguments[0]}var nu=function(){function d(g){a(this,d);for(var h in xt)if(xt.hasOwnProperty(h)){var b=xt[h],w=b._driver;this[h]=w,Bt[w]||this.defineDriver(b)}this._defaultConfig=cr({},eu),this._config=cr({},this._defaultConfig,g),this._driverSet=null,this._initDriver=null,this._ready=!1,this._dbInfo=null,this._wrapLibraryMethodsWithReady(),this.setDriver(this._config.driver).catch(function(){})}return d.prototype.config=function(h){if((typeof h>"u"?"undefined":o(h))==="object"){if(this._ready)return new Error("Can't call config() after localforage has been used.");for(var b in h){if(b==="storeName"&&(h[b]=h[b].replace(/\W/g,"_")),b==="version"&&typeof h[b]!="number")return new Error("Database version must be a number.");this._config[b]=h[b]}return"driver"in h&&h.driver?this.setDriver(this._config.driver):!0}else return typeof h=="string"?this._config[h]:this._config},d.prototype.defineDriver=function(h,b,w){var v=new l(function(T,L){try{var U=h._driver,$=new Error("Custom driver not compliant; see https://mozilla.github.io/localForage/#definedriver");if(!h._driver){L($);return}for(var W=sr.concat("_initStorage"),X=0,ce=W.length;X<ce;X++){var pe=W[X],ve=!Xc(hn,pe);if((ve||h[pe])&&typeof h[pe]!="function"){L($);return}}var Ce=function(){for(var zt=function(ou){return function(){var au=new Error("Method "+ou+" is not implemented by the current driver"),Fi=l.reject(au);return _(Fi,arguments[arguments.length-1]),Fi}},ur=0,iu=hn.length;ur<iu;ur++){var fr=hn[ur];h[fr]||(h[fr]=zt(fr))}};Ce();var Ee=function(zt){Bt[U]&&console.info("Redefining LocalForage driver: "+U),Bt[U]=h,Li[U]=zt,T()};"_support"in h?h._support&&typeof h._support=="function"?h._support().then(Ee,L):Ee(!!h._support):Ee(!0)}catch(ze){L(ze)}});return m(v,b,w),v},d.prototype.driver=function(){return this._driver||null},d.prototype.getDriver=function(h,b,w){var v=Bt[h]?l.resolve(Bt[h]):l.reject(new Error("Driver not found."));return m(v,b,w),v},d.prototype.getSerializer=function(h){var b=l.resolve(ar);return m(b,h),b},d.prototype.ready=function(h){var b=this,w=b._driverSet.then(function(){return b._ready===null&&(b._ready=b._initDriver()),b._ready});return m(w,h,h),w},d.prototype.setDriver=function(h,b,w){var v=this;Ni(h)||(h=[h]);var T=this._getSupportedDrivers(h);function L(){v._config.driver=v.driver()}function U(X){return v._extend(X),L(),v._ready=v._initStorage(v._config),v._ready}function $(X){return function(){var ce=0;function pe(){for(;ce<X.length;){var ve=X[ce];return ce++,v._dbInfo=null,v._ready=null,v.getDriver(ve).then(U).catch(pe)}L();var Ce=new Error("No available storage method found.");return v._driverSet=l.reject(Ce),v._driverSet}return pe()}}var W=this._driverSet!==null?this._driverSet.catch(function(){return l.resolve()}):l.resolve();return this._driverSet=W.then(function(){var X=T[0];return v._dbInfo=null,v._ready=null,v.getDriver(X).then(function(ce){v._driver=ce._driver,L(),v._wrapLibraryMethodsWithReady(),v._initDriver=$(T)})}).catch(function(){L();var X=new Error("No available storage method found.");return v._driverSet=l.reject(X),v._driverSet}),m(this._driverSet,b,w),this._driverSet},d.prototype.supports=function(h){return!!Li[h]},d.prototype._extend=function(h){cr(this,h)},d.prototype._getSupportedDrivers=function(h){for(var b=[],w=0,v=h.length;w<v;w++){var T=h[w];this.supports(T)&&b.push(T)}return b},d.prototype._wrapLibraryMethodsWithReady=function(){for(var h=0,b=sr.length;h<b;h++)tu(this,sr[h])},d.prototype.createInstance=function(h){return new d(h)},d}(),ru=new nu;r.exports=ru},{3:3}]},{},[4])(4)})})(Ln);class Oh{load(e){return Ln.exports.getItem(e)}save(e,n){Ln.exports.setItem(e,n)}remove(e){Ln.exports.removeItem(e)}}var It=null;typeof WebSocket<"u"?It=WebSocket:typeof MozWebSocket<"u"?It=MozWebSocket:typeof global<"u"?It=global.WebSocket||global.MozWebSocket:typeof window<"u"?It=window.WebSocket||window.MozWebSocket:typeof self<"u"&&(It=self.WebSocket||self.MozWebSocket);var wr=It;const Sr=Ke("WebsocketClient");class kh extends Gs{socket}class Rh extends kh{timerId;url;channels=[];constructor(e){super(),this.url=e}connect(e){this.timerId||(this.timerId=setInterval(()=>this.connect(e),5e3)),this.peerId=e,this.socket=new wr(this.url),this.socket.binaryType="arraybuffer",this.socket.addEventListener("open",()=>{Sr(`@ ${this.url}: open`),clearInterval(this.timerId),this.timerId=void 0,this.channels.forEach(n=>this.join(n))}),this.socket.addEventListener("close",()=>{Sr(`${this.url}: close`),this.timerId||this.connect(e)}),this.socket.addEventListener("message",n=>this.receiveMessage(n.data))}join(e){if(this.channels.includes(e)||this.channels.push(e),!this.socket)throw new Error("WTF, get a socket");this.socket.readyState===wr.OPEN?this.socket.send(Gt({type:"join",channelId:e,senderId:this.peerId})):this.socket.addEventListener("open",()=>{if(!this.socket)throw new Error("WTF, get a socket");this.socket.send(Gt({type:"join",channelId:e,senderId:this.peerId}))},{once:!0})}leave(e){if(this.channels=this.channels.filter(n=>n!==e),!this.socket)throw new Error("WTF, get a socket");this.socket.send(Gt({type:"leave",channelId:e,senderId:this.peerId}))}sendMessage(e,n,r,i){if(r.byteLength===0)throw new Error("tried to send a zero-length message");if(!this.peerId)throw new Error("Why don't we have a PeerID?");const o={senderId:this.peerId,targetId:e,channelId:n,type:"message",message:r,broadcast:i},a=Gt(o),s=a.buffer.slice(a.byteOffset,a.byteOffset+a.byteLength);if(!this.socket||this.socket.readyState!==wr.OPEN)throw new Error("Websocket Socket not ready!");this.socket.send(s)}announceConnection(e,n){if(!this.peerId)throw new Error("we should have a peer ID by now");this.emit("peer-candidate",{peerId:n,channelId:e})}receiveMessage(e){const n=nc(new Uint8Array(e)),{type:r,senderId:i,targetId:o,channelId:a,message:s,broadcast:u}=n;if(!this.socket)throw new Error("Missing socket at receiveMessage");if(e.byteLength===0)throw new Error("received a zero-length message");switch(r){case"peer":Sr(`peer: ${i}, ${a}`),this.announceConnection(a,i);break;default:this.emit("message",{channelId:a,senderId:i,targetId:o,message:new Uint8Array(s),broadcast:u})}}}Ke("WebsocketServer");var Ih={exports:{}},ue={};var ln=Symbol.for("react.element"),Th=Symbol.for("react.portal"),jh=Symbol.for("react.fragment"),Dh=Symbol.for("react.strict_mode"),Ph=Symbol.for("react.profiler"),Mh=Symbol.for("react.provider"),Nh=Symbol.for("react.context"),Lh=Symbol.for("react.forward_ref"),Fh=Symbol.for("react.suspense"),Uh=Symbol.for("react.memo"),$h=Symbol.for("react.lazy"),yo=Symbol.iterator;function Bh(t){return t===null||typeof t!="object"?null:(t=yo&&t[yo]||t["@@iterator"],typeof t=="function"?t:null)}var ac={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},sc=Object.assign,cc={};function $t(t,e,n){this.props=t,this.context=e,this.refs=cc,this.updater=n||ac}$t.prototype.isReactComponent={};$t.prototype.setState=function(t,e){if(typeof t!="object"&&typeof t!="function"&&t!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,t,e,"setState")};$t.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")};function uc(){}uc.prototype=$t.prototype;function pi(t,e,n){this.props=t,this.context=e,this.refs=cc,this.updater=n||ac}var yi=pi.prototype=new uc;yi.constructor=pi;sc(yi,$t.prototype);yi.isPureReactComponent=!0;var vo=Array.isArray,fc=Object.prototype.hasOwnProperty,vi={current:null},lc={key:!0,ref:!0,__self:!0,__source:!0};function dc(t,e,n){var r,i={},o=null,a=null;if(e!=null)for(r in e.ref!==void 0&&(a=e.ref),e.key!==void 0&&(o=""+e.key),e)fc.call(e,r)&&!lc.hasOwnProperty(r)&&(i[r]=e[r]);var s=arguments.length-2;if(s===1)i.children=n;else if(1<s){for(var u=Array(s),c=0;c<s;c++)u[c]=arguments[c+2];i.children=u}if(t&&t.defaultProps)for(r in s=t.defaultProps,s)i[r]===void 0&&(i[r]=s[r]);return{$$typeof:ln,type:t,key:o,ref:a,props:i,_owner:vi.current}}function zh(t,e){return{$$typeof:ln,type:t.type,key:e,ref:t.ref,props:t.props,_owner:t._owner}}function bi(t){return typeof t=="object"&&t!==null&&t.$$typeof===ln}function Vh(t){var e={"=":"=0",":":"=2"};return"$"+t.replace(/[=:]/g,function(n){return e[n]})}var bo=/\/+/g;function xr(t,e){return typeof t=="object"&&t!==null&&t.key!=null?Vh(""+t.key):e.toString(36)}function Fn(t,e,n,r,i){var o=typeof t;(o==="undefined"||o==="boolean")&&(t=null);var a=!1;if(t===null)a=!0;else switch(o){case"string":case"number":a=!0;break;case"object":switch(t.$$typeof){case ln:case Th:a=!0}}if(a)return a=t,i=i(a),t=r===""?"."+xr(a,0):r,vo(i)?(n="",t!=null&&(n=t.replace(bo,"$&/")+"/"),Fn(i,e,n,"",function(c){return c})):i!=null&&(bi(i)&&(i=zh(i,n+(!i.key||a&&a.key===i.key?"":(""+i.key).replace(bo,"$&/")+"/")+t)),e.push(i)),1;if(a=0,r=r===""?".":r+":",vo(t))for(var s=0;s<t.length;s++){o=t[s];var u=r+xr(o,s);a+=Fn(o,e,n,u,i)}else if(u=Bh(t),typeof u=="function")for(t=u.call(t),s=0;!(o=t.next()).done;)o=o.value,u=r+xr(o,s++),a+=Fn(o,e,n,u,i);else if(o==="object")throw e=String(t),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return a}function kn(t,e,n){if(t==null)return t;var r=[],i=0;return Fn(t,r,"","",function(o){return e.call(n,o,i++)}),r}function Wh(t){if(t._status===-1){var e=t._result;e=e(),e.then(function(n){(t._status===0||t._status===-1)&&(t._status=1,t._result=n)},function(n){(t._status===0||t._status===-1)&&(t._status=2,t._result=n)}),t._status===-1&&(t._status=0,t._result=e)}if(t._status===1)return t._result.default;throw t._result}var Fe={current:null},Un={transition:null},Hh={ReactCurrentDispatcher:Fe,ReactCurrentBatchConfig:Un,ReactCurrentOwner:vi};ue.Children={map:kn,forEach:function(t,e,n){kn(t,function(){e.apply(this,arguments)},n)},count:function(t){var e=0;return kn(t,function(){e++}),e},toArray:function(t){return kn(t,function(e){return e})||[]},only:function(t){if(!bi(t))throw Error("React.Children.only expected to receive a single React element child.");return t}};ue.Component=$t;ue.Fragment=jh;ue.Profiler=Ph;ue.PureComponent=pi;ue.StrictMode=Dh;ue.Suspense=Fh;ue.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=Hh;ue.cloneElement=function(t,e,n){if(t==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+t+".");var r=sc({},t.props),i=t.key,o=t.ref,a=t._owner;if(e!=null){if(e.ref!==void 0&&(o=e.ref,a=vi.current),e.key!==void 0&&(i=""+e.key),t.type&&t.type.defaultProps)var s=t.type.defaultProps;for(u in e)fc.call(e,u)&&!lc.hasOwnProperty(u)&&(r[u]=e[u]===void 0&&s!==void 0?s[u]:e[u])}var u=arguments.length-2;if(u===1)r.children=n;else if(1<u){s=Array(u);for(var c=0;c<u;c++)s[c]=arguments[c+2];r.children=s}return{$$typeof:ln,type:t.type,key:i,ref:o,props:r,_owner:a}};ue.createContext=function(t){return t={$$typeof:Nh,_currentValue:t,_currentValue2:t,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},t.Provider={$$typeof:Mh,_context:t},t.Consumer=t};ue.createElement=dc;ue.createFactory=function(t){var e=dc.bind(null,t);return e.type=t,e};ue.createRef=function(){return{current:null}};ue.forwardRef=function(t){return{$$typeof:Lh,render:t}};ue.isValidElement=bi;ue.lazy=function(t){return{$$typeof:$h,_payload:{_status:-1,_result:t},_init:Wh}};ue.memo=function(t,e){return{$$typeof:Uh,type:t,compare:e===void 0?null:e}};ue.startTransition=function(t){var e=Un.transition;Un.transition={};try{t()}finally{Un.transition=e}};ue.unstable_act=function(){throw Error("act(...) is not supported in production builds of React.")};ue.useCallback=function(t,e){return Fe.current.useCallback(t,e)};ue.useContext=function(t){return Fe.current.useContext(t)};ue.useDebugValue=function(){};ue.useDeferredValue=function(t){return Fe.current.useDeferredValue(t)};ue.useEffect=function(t,e){return Fe.current.useEffect(t,e)};ue.useId=function(){return Fe.current.useId()};ue.useImperativeHandle=function(t,e,n){return Fe.current.useImperativeHandle(t,e,n)};ue.useInsertionEffect=function(t,e){return Fe.current.useInsertionEffect(t,e)};ue.useLayoutEffect=function(t,e){return Fe.current.useLayoutEffect(t,e)};ue.useMemo=function(t,e){return Fe.current.useMemo(t,e)};ue.useReducer=function(t,e,n){return Fe.current.useReducer(t,e,n)};ue.useRef=function(t){return Fe.current.useRef(t)};ue.useState=function(t){return Fe.current.useState(t)};ue.useSyncExternalStore=function(t,e,n){return Fe.current.useSyncExternalStore(t,e,n)};ue.useTransition=function(){return Fe.current.useTransition()};ue.version="18.2.0";(function(t){t.exports=ue})(Ih);Ke("pushpin:content-types");function Kh(t){const e=new URL(t),n=e.protocol,r=e.pathname;return{scheme:n?n.substr(0,n.length-1):"",id:(r||"//").substr(2)}}function Jh(t){return Kh(t)}console.log("shared-worker starting up");Ke.enable("DocSynchronizer");self.Automerge=Tl;const Yh="wss://sync.inkandswitch.com",zr=new xh({storage:new Oh,network:[new Rh(Yh)],peerId:"shared-worker-"+Math.round(Math.random()*1e4),sharePolicy:async t=>t.includes("storage-server")});self.addEventListener("connect",t=>{console.log("client connected to shared-worker");var e=t.ports[0];e.postMessage("READY"),e.onmessage=function(n){const r=n.data;"serviceWorkerPort"in r?qh(r.serviceWorkerPort):"repoNetworkPort"in r&&Gh(r.repoNetworkPort)}});function qh(t){t.onmessage=e=>{const n=e.data,{binaryDataId:r}=n,{id:i}=Jh(r);if(console.log(`[${i}]: shared-worker request`),!zr)throw new Error("REPO NOT SETUP YET");zr.find(i).value().then(a=>{console.log(`[${i}]: shared-worker value`,a);const{mimeType:s,binary:u}=a;if(!s&&!u){t.postMessage({binaryDataId:r,mimeType:"text/javascript",binary:a.text.join("")});return}var c=new ArrayBuffer(u.byteLength);new Uint8Array(c).set(new Uint8Array(u)),t.postMessage({binaryDataId:r,mimeType:s,binary:c},[c])})}}async function Gh(t){zr.networkSubsystem.addNetworkAdapter(new Ch(t,{useWeakRef:!0}))}console.log("ran shared-worker to end")})();